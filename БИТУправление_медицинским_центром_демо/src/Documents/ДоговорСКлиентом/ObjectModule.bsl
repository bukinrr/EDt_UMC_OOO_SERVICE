
#Область ПрограммныйИнтерфейс

// Функция вычисляет и возвращает значение по формуле в рамках своего контекста.
//
// Параметры:
//  ФормулаРасчета	 - Строка	 - текст лагоритма расчета.
//  Результат		 - Произвольный	 - переменная, куда помещается итог расчета.
// 
// Возвращаемое значение:
//  Неопределено - возвращаемое значение не используется.
//
Функция ВыполнитьФормулуДляПечатиШаблона(ФормулаРасчета, Результат) Экспорт
	
	ОбъектПечати = ЭтотОбъект;
	Филиал = РаботаСДокументамиСервер.ФилиалДокумента(ЭтотОбъект);
	
	Выполнить(ФормулаРасчета);
	
КонецФункции

#КонецОбласти

#Область ОбработчикиСобытий

Процедура ОбработкаЗаполнения(ДанныеЗаполнения, СтандартнаяОбработка)
	
	Если ДанныеЗаполнения <> Неопределено Тогда
		Если ТипЗнч(ДанныеЗаполнения) = Тип("Структура") Тогда
			ДанныеЗаполнения.Свойство("Клиент", Клиент);
		ИначеЕсли ТипЗнч(ДанныеЗаполнения) = Тип("СправочникСсылка.Клиенты") Тогда
			Клиент = ДанныеЗаполнения;
		ИначеЕсли Документы.ТипВсеСсылки().СодержитТип(ТипЗнч(ДанныеЗаполнения))
			И ДанныеЗаполнения.Метаданные().Реквизиты.Найти("Клиент") <> Неопределено
		Тогда
			Клиент = ДанныеЗаполнения.Клиент;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
