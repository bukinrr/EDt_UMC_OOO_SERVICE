#Область ОбработчикиСобытий

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)	
	РаботаСФормамиСервер.ФормаДокументаПриОткрытииСервер(ЭтаФорма, Ложь);	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	
	ПечатьДокументовКлиент.УстановитьЗаголовокПечатнойФормы(ЭтаФорма);
	
	// Установка текущей строкой ту, в которой заказ, из которого сделан переход к описи
	Если ЗначениеЗаполнено(Параметры.Заказ) Тогда 
		СтрокиЗаказов = Объект.СписокЗаказов.НайтиСтроки(Новый Структура("ЗаказВЛабораторию", Параметры.Заказ));
		
		Если СтрокиЗаказов.Количество() > 0 Тогда 
			Элементы.СписокЗаказов.ТекущаяСтрока = Объект.СписокЗаказов.Индекс(СтрокиЗаказов[0]);
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиКомандФормы

&НаКлиенте
Процедура ОтправитьЗаказыПоОписи(Команда)
	
	Если РаботаСДиалогамиКлиент.ПроверитьМодифицированностьВФорме(ЭтотОбъект) Тогда
		
		Результат = ЛабораторияСервер.ОтправитьЗаказыПоОписиВоВнешнююЛабораторию(Объект.Ссылка);
		Если Не Результат = Ложь Тогда
			ПоказатьПредупреждение(,"Заказы отправлены успешно!", 30);
		Иначе
			ПоказатьПредупреждение(,"При отправке заказов произошла ошибка!", 30);
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

#Область ОбработчикиДинамическиСоздаваемыхКоманд

&НаКлиенте
Процедура Подключаемый_КнопкаФилиалПриНажатии(Команда)
	РаботаСДиалогамиКлиент.ДиалогКнопкаФилиалПриНажатии(ЭтаФорма);
КонецПроцедуры

#КонецОбласти

#КонецОбласти

#Область ОбработчикиСобытийЭлементовФормы

&НаКлиенте
Процедура СписокЗаказовВыбор(Элемент, ВыбраннаяСтрока, Поле, СтандартнаяОбработка)
	
	ТекущиеДанные = Элемент.ТекущиеДанные;
	Если ТекущиеДанные <> Неопределено Тогда
		
		Если Поле = Элементы.СписокЗаказовЗаказВЛабораториюКлиент Тогда
			ОткрытьЗначение(ДопСерверныеФункции.ПолучитьРеквизит(ТекущиеДанные.ЗаказВЛабораторию, "Клиент"));
		ИначеЕсли Поле = Элементы.СписокЗаказовЗаказВЛабораторию Тогда
			ОткрытьЗначение(ТекущиеДанные.ЗаказВЛабораторию);
		КонецЕсли;
		
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
