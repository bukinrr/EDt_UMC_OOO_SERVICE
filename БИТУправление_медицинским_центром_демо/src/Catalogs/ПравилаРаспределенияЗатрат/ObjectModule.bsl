
#Область ОбработчикиСобытий

Процедура ПередЗаписью(Отказ)
	
	Если Не Отказ Тогда 
		Если Не ОбменДанными.Загрузка Тогда
			Если Не ПометкаУдаления Тогда 
			
				Если Не ЗначениеЗаполнено(СпособРаспределения) Тогда
					Отказ = Истина;
					ОбщегоНазначения.СообщитьОбОшибке(НСтр("ru ='Не указан способ распределения затрат!'"),
					Отказ);
				КонецЕсли;

				Если СпособРаспределения = Перечисления.СпособРаспределенияЗатрат.ПоФиксированнойБазе Тогда 	
					Если Не ЗначениеЗаполнено(ПолучателиЗатрат) Тогда
						Отказ = Истина;
						ОбщегоНазначения.СообщитьОбОшибке(НСтр("ru ='Не заполнена табличная часть ""Получатели затрат""!'"),
						Отказ);
					КонецЕсли;
					
					Для Каждого стрПолучателиЗатрат Из ПолучателиЗатрат Цикл
						Если стрПолучателиЗатрат.Коэффициент = 0 Тогда
							Отказ = Истина;
							Сообщение = НСтр("ru ='В строке %1 табличной части ""%2"" указан нулевой коэффициент!'");
							ОбщегоНазначения.СообщитьОбОшибке(
								СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(Сообщение,
																						Строка(стрПолучателиЗатрат.НомерСтроки),
																						Метаданные().ТабличныеЧасти.ПолучателиЗатрат.Синоним),
								Отказ);
						КонецЕсли;
					КонецЦикла;
				КонецЕсли;
			
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти
