#Область ОбработчикиСобытийФормы

&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	УО = Список.УсловноеОформление.Элементы;
	Выб = Справочники.ВидыВремениГрафика.Выбрать();
	Пока Выб.Следующий() Цикл
		Если Выб.Ссылка <> Справочники.ВидыВремениГрафика.РабочееВремя Тогда
			
			Цвет = Выб.Цвет.Получить();
			Если Цвет <> Новый Цвет(0,0,0) Тогда
				ЭлементУО = УО.Добавить();
				ЭлементУО.Оформление.УстановитьЗначениеПараметра("ЦветФона",Цвет);
				
				// Условие форматирования
				ЭлементУсловия  = ЭлементУО.Отбор.Элементы.Добавить(Тип("ЭлементОтбораКомпоновкиДанных"));
				ЭлементУсловия.ЛевоеЗначение  = Новый ПолеКомпоновкиДанных("Ссылка");
				ЭлементУсловия.ВидСравнения	  = ВидСравненияКомпоновкиДанных.Равно;
				ЭлементУсловия.ПравоеЗначение = Выб.Ссылка;
				
				// Оформляемое поле
				ОформлПоле = ЭлементУО.Поля.Элементы.Добавить();
				ОформлПоле.Поле = Новый ПолеКомпоновкиДанных("Код");
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
	
КонецПроцедуры

#КонецОбласти