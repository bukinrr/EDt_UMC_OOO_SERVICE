#Область ОбработчикиСобытийФормы
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("РежимВыбора") Тогда
		Элементы.СписокТабличныхЧастей.РежимВыбора = Параметры.РежимВыбора;
	КонецЕсли;	
	
КонецПроцедуры

&НаКлиенте
Процедура ПриОткрытии(Отказ)
	ЗаполнитьСписокОбъектов();
КонецПроцедуры

#КонецОбласти

#Область ОбработчикиСобытийЭлементовШапкиФормы

&НаКлиенте
Процедура ОсновныеДействияФормыКнопкаОК(Кнопка)	
	
	возвр = Новый Структура;
	возвр.Вставить("Имя", Элементы.СписокТабличныхЧастей.ТекущиеДанные.Имя);
	возвр.Вставить("Синоним", Элементы.СписокТабличныхЧастей.ТекущиеДанные.Синоним);
	
	ОповеститьОВыборе(возвр);
	
КонецПроцедуры

&НаКлиенте
Процедура СписокДокументовВыбор(Элемент, ВыбраннаяСтрока, Колонка, СтандартнаяОбработка)
	
	возвр = Новый Структура;
	возвр.Вставить("Имя", Элементы.СписокТабличныхЧастей.ТекущиеДанные.Имя);
	возвр.Вставить("Синоним", Элементы.СписокТабличныхЧастей.ТекущиеДанные.Синоним);
	
	ОповеститьОВыборе(возвр);
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции
&НаСервере
Процедура ЗаполнитьСписокОбъектов()
	
	Если ЗначениеЗаполнено(СсылкаОбъекта) Тогда
		Если УжеВыбранные = Неопределено ИЛИ УжеВыбранные.Количество() = 0 Тогда
			Для Каждого ТабличнаяЧасть Из СсылкаОбъекта.Метаданные().ТабличныеЧасти Цикл
				Если УжеВыбранные.НайтиПоЗначению(ТабличнаяЧасть.Имя) = Неопределено Тогда
					
					НовСтр = СписокТабличныхЧастей.Добавить();
					НовСтр.Имя = ТабличнаяЧасть.Имя;
					НовСтр.Синоним = ТабличнаяЧасть.Синоним;
					
				КонецЕсли;
			КонецЦикла;
		Иначе
			Для Каждого ТабличнаяЧасть Из СсылкаОбъекта.Метаданные().ТабличныеЧасти Цикл
				НовСтр = СписокТабличныхЧастей.Добавить();
				НовСтр.Имя = ТабличнаяЧасть.Имя;
				НовСтр.Синоним = ТабличнаяЧасть.Синоним;
			КонецЦикла;
			
		КонецЕсли;
	КонецЕсли;	
	
КонецПроцедуры

#КонецОбласти 