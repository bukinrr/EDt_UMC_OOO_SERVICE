<ПравилаОбмена>
	<ВерсияФормата РежимСовместимости="РежимСовместимостиСБСП20">2.01</ВерсияФормата>
	<Ид>f1bcc6ab-18ca-4c66-9e20-8224eebc3429    </Ид>
	<Наименование>Шаблоны Word и Виды договоров</Наименование>
	<ДатаВремяСоздания>2023-12-27T12:45:26</ДатаВремяСоздания>
	<Источник ВерсияПлатформы="8.0" ВерсияКонфигурации="2.0.49.17" СинонимКонфигурации="БИТ.Управление медицинским центром">БИТУправлениеМедицинскимЦентром</Источник>
	<Приемник ВерсияПлатформы="8.0" ВерсияКонфигурации="2.0.49.17" СинонимКонфигурации="БИТ.Управление медицинским центром">БИТУправлениеМедицинскимЦентром</Приемник>
	<ПередВыгрузкойДанных>
ТипыПредставленийТипов = Новый Соответствие;

Попытка

Выб = Справочники.ШаблоныПечати.Выбрать();
Пока Выб.Следующий() Цикл

	Если Не Выб.ЭтоГруппа Тогда
		
		Для Каждого СтрокаТЧ Из Выб.Принадлежность Цикл
			ТипыПредставленийТипов.Вставить(СтрокаТЧ.ПредставлениеОбъекта, СтрокаТЧ.СсылкаОбъекта.Метаданные().ПолноеИмя());
		КонецЦикла;
	КонецЕсли;
КонецЦикла;

Исключение
КонецПопытки;
	
Параметры.ТипыПредставленийТипов = ЗначениеВСтрокуВнутр(ТипыПредставленийТипов);

СтрокаПередаваемогоПараметра = ТаблицаНастройкиПараметров.Найти("ТипыПредставленийТипов", "Имя");
Если СтрокаПередаваемогоПараметра = Неопределено Тогда
	Сообщить("СтрокаПередаваемогоПараметра = Неопределено");
Иначе
	СтрокаПередаваемогоПараметра.Значение = Параметры.ТипыПредставленийТипов;
КонецЕсли;

</ПередВыгрузкойДанных>
	<Параметры>
		<Параметр Имя="Ссылка                                            " Наименование="Ссылка на шаблон" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="СправочникСсылка.ШаблоныПечати" ПередаватьПараметрПриВыгрузке="true" ПравилоКонвертации="ШаблоныПечатиДляЭкспорта                          "/>
		<Параметр Имя="ТипыПредставленийТипов                            " Наименование="Типы представления типов (для конвертации принадлежности формы к документам)" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
	</Параметры>
	<Обработки/>
	<ПравилаКонвертацииОбъектов>
		<Группа>
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>50</Порядок>
			<Правило>
				<Код>ШаблоныПечатиДляЭкспорта</Код>
				<Наименование>Справочник: Шаблоны печати (для экспота-импорта)</Наименование>
				<Порядок>50</Порядок>
				<ПередВыгрузкой>Если Источник &lt;&gt; Параметры.Ссылка Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкой>
				<ПослеЗагрузки>Попытка
	
ТипыПредставленийТипов = ЗначениеИзСтрокиВнутр(Параметры.ТипыПредставленийТипов);

Для Каждого СтрокаПринадлежность Из Объект.Принадлежность Цикл
	ПолноеИмяМетаданных = ТипыПредставленийТипов.Получить(СтрокаПринадлежность.ПредставлениеОбъекта);
	
	Если ЗначениеЗаполнено(ПолноеИмяМетаданных) Тогда
		СтрокаПринадлежность.СсылкаОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(ПолноеИмяМетаданных).ПустаяСсылка();
	КонецЕсли;
КонецЦикла;

Исключение
	Сообщить(ОписаниеОшибки());	
КонецПопытки;</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>false</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>СправочникСсылка.ШаблоныПечати</Источник>
				<Приемник>СправочникСсылка.ШаблоныПечати</Приемник>
				<Свойства>
					<Свойство>
						<Код>3</Код>
						<Наименование>ИмяФайлаМакета --&gt; ИмяФайлаМакета</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ИмяФайлаМакета" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИмяФайлаМакета" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>КоличествоЭкземпляров --&gt; КоличествоЭкземпляров</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="КоличествоЭкземпляров" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="КоличествоЭкземпляров" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>5</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>ПечатьБезПредварительногоПросмотра --&gt; ПечатьБезПредварительногоПросмотра</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ПечатьБезПредварительногоПросмотра" Вид="Реквизит" Тип="Булево"/>
						<Приемник Имя="ПечатьБезПредварительногоПросмотра" Вид="Реквизит" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ШаблоныПечати"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ШаблоныПечати"/>
						<КодПравилаКонвертации>ШаблоныПечатиДляЭкспорта                          </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>ФайлМакета --&gt; ФайлМакета</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="ФайлМакета" Вид="Реквизит" Тип="ХранилищеЗначения"/>
						<Приемник Имя="ФайлМакета" Вид="Реквизит" Тип="ХранилищеЗначения"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>10</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Группа>
						<Код>11</Код>
						<Наименование>ПараметрыПечати --&gt; ПараметрыПечати</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="ПараметрыПечати" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="ПараметрыПечати" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>12</Код>
							<Наименование>Значение --&gt; Значение</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Значение" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="Значение" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>13</Код>
							<Наименование>ИмяПараметра --&gt; ИмяПараметра</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="ИмяПараметра" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="ИмяПараметра" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>17</Код>
							<Наименование>ВводитсяВручную --&gt; ВводитсяВручную</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="ВводитсяВручную" Вид="Реквизит" Тип="Булево"/>
							<Приемник Имя="ВводитсяВручную" Вид="Реквизит" Тип="Булево"/>
						</Свойство>
						<Свойство>
							<Код>18</Код>
							<Наименование>Описание --&gt; Описание</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Описание" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="Описание" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
					</Группа>
					<Группа>
						<Код>14</Код>
						<Наименование>Принадлежность --&gt; Принадлежность</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="Принадлежность" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Принадлежность" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>15</Код>
							<Наименование>ПредставлениеОбъекта --&gt; ПредставлениеОбъекта</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ПредставлениеОбъекта" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="ПредставлениеОбъекта" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>16</Код>
							<Наименование>СсылкаОбъекта --&gt; СсылкаОбъекта</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="СсылкаОбъекта" Вид="Реквизит"/>
							<Приемник Имя="СсылкаОбъекта" Вид="Реквизит"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ШаблоныПечати</Код>
				<Наименование>Справочник: Шаблоны печати</Наименование>
				<Порядок>50</Порядок>
				<ПослеЗагрузки>Попытка
	
ТипыПредставленийТипов = ЗначениеИзСтрокиВнутр(Параметры.ТипыПредставленийТипов);

Для Каждого СтрокаПринадлежность Из Объект.Принадлежность Цикл
	ПолноеИмяМетаданных = ТипыПредставленийТипов.Получить(СтрокаПринадлежность.ПредставлениеОбъекта);
	
	Если ЗначениеЗаполнено(ПолноеИмяМетаданных) Тогда
		СтрокаПринадлежность.СсылкаОбъекта = ОбщегоНазначения.МенеджерОбъектаПоПолномуИмени(ПолноеИмяМетаданных).ПустаяСсылка();
	КонецЕсли;
КонецЦикла;

Исключение
	Сообщить(ОписаниеОшибки());	
КонецПопытки;</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>СправочникСсылка.ШаблоныПечати</Источник>
				<Приемник>СправочникСсылка.ШаблоныПечати</Приемник>
				<Свойства>
					<Свойство>
						<Код>3</Код>
						<Наименование>ИмяФайлаМакета --&gt; ИмяФайлаМакета</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ИмяФайлаМакета" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИмяФайлаМакета" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>КоличествоЭкземпляров --&gt; КоличествоЭкземпляров</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="КоличествоЭкземпляров" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="КоличествоЭкземпляров" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ПечатьБезПредварительногоПросмотра --&gt; ПечатьБезПредварительногоПросмотра</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПечатьБезПредварительногоПросмотра" Вид="Реквизит" Тип="Булево"/>
						<Приемник Имя="ПечатьБезПредварительногоПросмотра" Вид="Реквизит" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>ФайлМакета --&gt; ФайлМакета</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ФайлМакета" Вид="Реквизит" Тип="ХранилищеЗначения"/>
						<Приемник Имя="ФайлМакета" Вид="Реквизит" Тип="ХранилищеЗначения"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>7</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ШаблоныПечати"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ШаблоныПечати"/>
						<КодПравилаКонвертации>ШаблоныПечати                                     </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>10</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Группа>
						<Код>11</Код>
						<Наименование>ПараметрыПечати --&gt; ПараметрыПечати</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="ПараметрыПечати" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="ПараметрыПечати" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>12</Код>
							<Наименование>Значение --&gt; Значение</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Значение" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="Значение" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>13</Код>
							<Наименование>ИмяПараметра --&gt; ИмяПараметра</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="ИмяПараметра" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="ИмяПараметра" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>17</Код>
							<Наименование>ВводитсяВручную --&gt; ВводитсяВручную</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="ВводитсяВручную" Вид="Реквизит" Тип="Булево"/>
							<Приемник Имя="ВводитсяВручную" Вид="Реквизит" Тип="Булево"/>
						</Свойство>
						<Свойство>
							<Код>18</Код>
							<Наименование>Описание --&gt; Описание</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Описание" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="Описание" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
					</Группа>
					<Группа>
						<Код>14</Код>
						<Наименование>Принадлежность --&gt; Принадлежность</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="Принадлежность" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Принадлежность" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>15</Код>
							<Наименование>ПредставлениеОбъекта --&gt; ПредставлениеОбъекта</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ПредставлениеОбъекта" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="ПредставлениеОбъекта" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>16</Код>
							<Наименование>СсылкаОбъекта --&gt; СсылкаОбъекта</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="СсылкаОбъекта" Вид="Реквизит"/>
							<Приемник Имя="СсылкаОбъекта" Вид="Реквизит"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ВидыДоговоров</Код>
				<Наименование>Справочник: Виды договоров</Наименование>
				<Порядок>100</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>СправочникСсылка.ВидыДоговоров</Источник>
				<Приемник>СправочникСсылка.ВидыДоговоров</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>2</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ШаблонПечати --&gt; ШаблонПечати</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ШаблонПечати" Вид="Реквизит" Тип="СправочникСсылка.ШаблоныПечати"/>
						<Приемник Имя="ШаблонПечати" Вид="Реквизит" Тип="СправочникСсылка.ШаблоныПечати"/>
						<КодПравилаКонвертации>ШаблоныПечати                                     </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ВидыДоговоров"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ВидыДоговоров"/>
						<КодПравилаКонвертации>ВидыДоговоров                                     </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
	</ПравилаКонвертацииОбъектов>
	<ПравилаВыгрузкиДанных>
		<Группа Отключить="false">
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>50</Порядок>
			<Правило Отключить="false">
				<Код>ШаблоныПечати</Код>
				<Наименование>ШаблоныПечати (Экспорт)</Наименование>
				<Порядок>50</Порядок>
				<КодПравилаКонвертации>ШаблоныПечатиДляЭкспорта                          </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.ШаблоныПечати</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>ВидыДоговоров</Код>
				<Наименование>ВидыДоговоров</Наименование>
				<Порядок>100</Порядок>
				<КодПравилаКонвертации>ВидыДоговоров                                     </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.ВидыДоговоров</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>ШаблоныПечатиПолнаяВыгрузка</Код>
				<Наименование>ШаблоныПечати (Полная выгрузки)</Наименование>
				<Порядок>150</Порядок>
				<КодПравилаКонвертации>ШаблоныПечати                                     </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.ШаблоныПечати</ОбъектВыборки>
			</Правило>
		</Группа>
	</ПравилаВыгрузкиДанных>
	<ПравилаОчисткиДанных/>
	<Алгоритмы/>
	<Запросы/>
</ПравилаОбмена>