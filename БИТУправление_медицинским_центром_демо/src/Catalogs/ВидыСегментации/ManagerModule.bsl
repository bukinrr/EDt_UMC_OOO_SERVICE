#Область ПрограммныйИнтерфейс

// Экспортировать вид сегментации в двоичные данные.
//
// Параметры:
//  ВидСегментации	 - СправочникСсылка.ВидыСегментации	 - вид сегментации.
// 
// Возвращаемое значение:
//  ДвоичныеДанные - данные выгрузки.
//
Функция Экспортировать(ВидСегментации) Экспорт
	
	ПутьКФайлуПравил = ПолучитьИмяВременногоФайла("xml");
	ДвоичныеДанныеПравилОбмена = Справочники.ВидыСегментации.ПолучитьМакет("ПравилаОбмена");
	ДвоичныеДанныеПравилОбмена.Записать(ПутьКФайлуПравил);
	
	ПутьКФайлуВыгрузки = ПолучитьИмяВременногоФайла("xml");
	
	УниверсальныйОбмен 							= Обработки.УниверсальныйОбменДаннымиXML.Создать();
	УниверсальныйОбмен.ИмяФайлаПравилОбмена 	= ПутьКФайлуПравил;
	УниверсальныйОбмен.ИмяФайлаОбмена 			= ПутьКФайлуВыгрузки;
	УниверсальныйОбмен.РежимОтладкиАлгоритмов 	= Истина;
	УниверсальныйОбмен.РежимОбмена 				= "Выгрузка";
	
	УниверсальныйОбмен.ЗагрузитьПравилаОбмена();	
	СтрокаПараметра = УниверсальныйОбмен.ТаблицаНастройкиПараметров.Найти("Ссылка", "Имя");
	Если СтрокаПараметра <> Неопределено Тогда
		СтрокаПараметра.Значение = ВидСегментации;
		СТрокаПараметра.ПередаватьПараметрПриВыгрузке = Ложь; 
	КонецЕсли;
	УниверсальныйОбмен.ВыполнитьВыгрузку();
	
	ДанныеВыгрузки = Новый ДвоичныеДанные(ПутьКФайлуВыгрузки);			
	
	Возврат ДанныеВыгрузки;
КонецФункции

// Импортировать вид сегментации из двоичных данных экспорта.
//
// Параметры:
//  Данные	 - ДвоичныеДанные	 - данные файла для загрузки.
//
Процедура Импортировать(Данные) Экспорт
	ПутьКФайлуВыгрузки 							= ПолучитьИмяВременногоФайла("xml");
	УниверсальныйОбмен 							= Обработки.УниверсальныйОбменДаннымиXML.Создать();
	УниверсальныйОбмен.ИмяФайлаОбмена 			= ПутьКФайлуВыгрузки;
	УниверсальныйОбмен.РежимОтладкиАлгоритмов 	= Истина;
	УниверсальныйОбмен.РежимОбмена 				= "Загрузка";
	
	Данные.Записать(ПутьКФайлуВыгрузки);
	УниверсальныйОбмен.ВыполнитьЗагрузку();
КонецПроцедуры

#КонецОбласти