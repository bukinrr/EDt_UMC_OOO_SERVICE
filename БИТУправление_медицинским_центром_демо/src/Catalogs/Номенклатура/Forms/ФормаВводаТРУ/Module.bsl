
&НаСервере
Процедура ПриСозданииНаСервере(Отказ, СтандартнаяОбработка)
	
	Если Параметры.Свойство("КодТРУ") Тогда
		
		МассивПолей = ПолучитьМассивПолей();
		
		ТекущийСимвол = 1;
		               	
		Для Каждого Поле Из МассивПолей Цикл
			ЭтотОбъект[Поле] = Сред(Параметры.КодТРУ, ТекущийСимвол, СтрДлина(Элементы[Поле].Маска));
			Если СтрЧислоВхождений(ЭтотОбъект[Поле], "0") = СтрДлина(Элементы[Поле].Маска) Тогда
				ЭтотОбъект[Поле] = Неопределено;
			КонецЕсли;
		КонецЦикла;
				
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура Отмена(Команда)
	
	ЭтотОбъект.Закрыть();

КонецПроцедуры

&НаКлиенте
Процедура Сохранить(Команда)
	
	Если КодТРУ = "" Тогда
		ЭтотОбъект.Закрыть(КодТРУ);
		Возврат;
	КонецЕсли;
	
	Отказ = Ложь;
	
	МассивПолей = ПолучитьМассивПолей();
	
	Для Каждого Поле Из МассивПолей Цикл
		Если ЭтотОбъект[Поле] = "" Тогда
			ДобавленоСимволов = 0;
			Пока ДобавленоСимволов <> СтрДлина(Элементы[Поле].Маска) Цикл
				ЭтотОбъект[Поле] = ЭтотОбъект[Поле] + "0";
				ДобавленоСимволов = ДобавленоСимволов + 1;
			КонецЦикла;
		КонецЕсли;
	КонецЦикла;
	
	Если Не Отказ Тогда
		ЭтотОбъект.Закрыть(КодТРУ + КодПроизводителя + КодМодели + КодСтраныПроизводителя);		
	КонецЕсли;
	
КонецПроцедуры

&НаКлиенте
Процедура КодТРУПриИзменении(Элемент)
	
	ПолеПриИзменении("КодТРУ");
	
КонецПроцедуры

&НаКлиенте
Процедура КодПроизводителяПриИзменении(Элемент)
	
	ПолеПриИзменении("КодПроизводителя");
	
КонецПроцедуры

&НаКлиенте
Процедура КодМоделиПриИзменении(Элемент)
	
	ПолеПриИзменении("КодМодели");
	
КонецПроцедуры

&НаКлиенте
Процедура КодСтраныПроизводителяПриИзменении(Элемент)
	
	ПолеПриИзменении("КодСтраныПроизводителя");

КонецПроцедуры

&НаКлиенте
Процедура ПолеПриИзменении(Поле)
	
	ЭтотОбъект[Поле] = СтрЗаменить(ЭтотОбъект[Поле], " ", "0"); 
	
КонецПроцедуры

&НаКлиентеНаСервереБезКонтекста
Функция ПолучитьМассивПолей()
	
	МассивПолей = Новый Массив;
	
	МассивПолей.Добавить("КодТРУ");
	МассивПолей.Добавить("КодПроизводителя");
	МассивПолей.Добавить("КодМодели");
	МассивПолей.Добавить("КодСтраныПроизводителя");
	
	Возврат МассивПолей;
	
КонецФункции

