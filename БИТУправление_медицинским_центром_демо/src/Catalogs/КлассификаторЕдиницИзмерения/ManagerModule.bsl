#Область ПрограммныйИнтерфейс

// Получить/создать единицу по коду ОКИН.
//
// Параметры:
//  Код	 - Строка	 - код.
// 
// Возвращаемое значение:
//  СправочникСсылка.КлассификаторЕдиницИзмерения - единица измерения.
//
Функция ПолучитьЕдиницуИзмерения(Код) Экспорт
	ЭлементСправочника = Справочники.КлассификаторЕдиницИзмерения.НайтиПоКоду(Код);
	Если Не ЗначениеЗаполнено(ЭлементСправочника) Тогда
		Макет = Справочники.КлассификаторЕдиницИзмерения.ПолучитьМакет("КлассификаторЕдиницИзмерения");
		КодТекст = Формат(Код,"ЧЦ=3; ЧВН=");
		Для Сч = 1 По Макет.ВысотаТаблицы Цикл
			ТекстЯчейки = Макет.Область(Сч, 2).Текст;	
			Если СокрЛП(ТекстЯчейки) = КодТекст Тогда
				ЭлементСправочника = Справочники.КлассификаторЕдиницИзмерения.СоздатьЭлемент();
				ЭлементСправочника.Код = КодТекст;
				ЭлементСправочника.Наименование = СокрЛП(СтрРазделить(Макет.Область(Сч, 4).Текст,Символы.ПС, Ложь)[0]);
				ЭлементСправочника.НаименованиеПолное = СокрЛП(СтрРазделить(Макет.Область(Сч, 3).Текст,Символы.ПС, Ложь)[0]);
				ЭлементСправочника.Записать();
				Прервать;
			КонецЕсли; 
		КонецЦикла; 
	КонецЕсли;
	
	Возврат ЭлементСправочника.Ссылка;		
КонецФункции
 
#КонецОбласти