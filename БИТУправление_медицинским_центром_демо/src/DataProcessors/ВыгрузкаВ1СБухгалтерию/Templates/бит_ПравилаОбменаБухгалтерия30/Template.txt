<ПравилаОбмена>
	<ВерсияФормата РежимСовместимости="">2.01</ВерсияФормата>
	<Ид>7858904a-ac3a-452a-a527-648345ef4abc    </Ид>
	<Наименование>БИТ_УМЦ --&gt; БП 3.0</Наименование>
	<ДатаВремяСоздания>2023-12-19T17:44:50</ДатаВремяСоздания>
	<Источник ВерсияПлатформы="8.0" ВерсияКонфигурации="2.0.49.17" СинонимКонфигурации="БИТ.Управление медицинским центром">БИТУправлениеМедицинскимЦентром</Источник>
	<Приемник ВерсияПлатформы="8.0" ВерсияКонфигурации="3.0.67.32" СинонимКонфигурации="Бухгалтерия предприятия, редакция 3.0">БухгалтерияПредприятия</Приемник>
	<ПослеЗагрузкиПравилОбмена>Выборка = РегистрыСведений.НастройкаОбмена.Выбрать();

Пока Выборка.Следующий() Цикл
	
	ПолеСопоставления = Выборка.ПолеСопоставления;
	Если ПолеСопоставления = "ВнешнийКод" Тогда
		ПолеСопоставления = "Внешний код";
	КонецЕсли;
	
	Если (СокрЛП(Выборка.НазваниеОбъекта) = "Контрагенты") Тогда
		
		Параметры.Контрагенты = СокрЛП(ПолеСопоставления);
		
	ИначеЕсли (СокрЛП(Выборка.НазваниеОбъекта) = "КонтрагентыГруппы") Тогда
		
		Параметры.КонтрагентыГруппы = СокрЛП(ПолеСопоставления);
		
	ИначеЕсли (СокрЛП(Выборка.НазваниеОбъекта) = "Номенклатура") Тогда
		
		Параметры.Номенклатура = СокрЛП(ПолеСопоставления);
		
	ИначеЕсли (СокрЛП(Выборка.НазваниеОбъекта) = "НоменклатураГруппы") Тогда
		
		Параметры.НоменклатураГруппы = СокрЛП(ПолеСопоставления);
		
	ИначеЕсли (СокрЛП(Выборка.НазваниеОбъекта) = "СтатьиДвиженияДенежныхСредств") Тогда
		
		Параметры.СтатьиДвиженияДенежныхСредств = СокрЛП(ПолеСопоставления);
		
	ИначеЕсли (СокрЛП(Выборка.НазваниеОбъекта) = "Склады") Тогда
		
		Параметры.Склады = СокрЛП(ПолеСопоставления);
		
	ИначеЕсли (СокрЛП(Выборка.НазваниеОбъекта) = "Кассы") Тогда
		
		Параметры.Кассы = СокрЛП(ПолеСопоставления);
	
	КонецЕсли;
	
КонецЦикла;</ПослеЗагрузкиПравилОбмена>
	<ПередВыгрузкойДанных>Параметры.ДокиПоБезналу = "";

// Виды номенклатуры: подготовка кеша
Если Метаданные.РегистрыСведений.Найти("ВидыНоменклатурыВоВнешнейИС") &lt;&gt; Неопределено Тогда
	УстановитьПривилегированныйРежим(Истина);
	НоменклатураВид = Новый Соответствие;
	
	Запрос = Новый Запрос;
	Запрос.Текст = "ВЫБРАТЬ
	               |	ВидыНоменклатуры.ВидНоменклатуры КАК ВидНоменклатуры,
	               |	ВидыНоменклатуры.Порядок КАК Порядок,
	               |	ВидыНоменклатуры.Отбор КАК Отбор
	               |ИЗ
	               |	РегистрСведений.ВидыНоменклатурыВоВнешнейИС КАК ВидыНоменклатуры
	               |
	               |УПОРЯДОЧИТЬ ПО
	               |	Порядок";   
	Выборка = Запрос.Выполнить().Выбрать();  
	Пока Выборка.Следующий() Цикл
		
		Если Не ЗначениеЗаполнено(Выборка.ВидНоменклатуры) Тогда Продолжить КонецЕсли;
		
		СхемаКомпоновкиДанных = РегистрыСведений.ВидыНоменклатурыВоВнешнейИС.ПолучитьМакет("МакетОтбора");
		
		Настройки = Выборка.Отбор.Получить();
		
		КомпоновщикНастроек = Новый КомпоновщикНастроекКомпоновкиДанных;
		КомпоновщикНастроек.ЗагрузитьНастройки(Настройки);
		ИсточникНастроек = Новый ИсточникДоступныхНастроекКомпоновкиДанных(СхемаКомпоновкиДанных);
		КомпоновщикНастроек.Инициализировать(ИсточникНастроек);
		
		КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
		
		МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, Настройки,,,Тип("ГенераторМакетаКомпоновкиДанныхДляКоллекцииЗначений"));
		
		ПроцессорКомпоновкиДанных = Новый ПроцессорКомпоновкиДанных;
		ПроцессорКомпоновкиДанных.Инициализировать(МакетКомпоновки);
		
		ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВКоллекциюЗначений;
		ТЗ = Новый ТаблицаЗначений;
		ПроцессорВывода.УстановитьОбъект(ТЗ);
		ПроцессорВывода.Вывести(ПроцессорКомпоновкиДанных);
		
		Для Каждого Строка Из ТЗ Цикл
			
			Если НоменклатураВид.Получить(Строка.Номенклатура) = Неопределено Тогда
				НоменклатураВид.Вставить(Строка.Номенклатура, Выборка.ВидНоменклатуры);
			КонецЕсли;
			
		КонецЦикла;
	КонецЦикла;
	УстановитьПривилегированныйРежим(Ложь);
	Параметры.ВидыНоменклатуры = Новый ХранилищеЗначения(НоменклатураВид);
КонецЕсли;</ПередВыгрузкойДанных>
	<ПослеВыгрузкиДанных>Если Не ПустаяСтрока(Параметры.ДокиПоБезналу) Тогда	
	ТабШапки = ЗначениеИзСтрокиВнутр(Параметры.ДокиПоБезналу);	
	ТабШапки.Свернуть("Дата, ЭквайринговыйТерминал, Клиент, Организация", "СуммаДокумента");
	ТабШапки.Колонки.Добавить("ВидОперации", Новый ОписаниеТипов("Строка"));
	Для Каждого СтрШапка Из ТабШапки Цикл
																																	  
		Если СтрШапка.СуммаДокумента &lt; 0 Тогда
			СтрШапка.СуммаДокумента = -СтрШапка.СуммаДокумента;
			СтрШапка.ВидОперации = "ВозвратПокупателю";
		Иначе
			СтрШапка.ВидОперации = "ОплатаПокупателя";
		КонецЕсли;
		
		Если СтрШапка.СуммаДокумента &lt;&gt; 0 Тогда
			ВыгрузитьПоПравилу(СтрШапка, , , , "РозничнаяВыручкаБезналичныеСводно");
		КонецЕсли;
		
	КонецЦикла;
КонецЕсли;</ПослеВыгрузкиДанных>
	<ПередЗагрузкойДанных>// Приоритет проведения документов при отложенном проведении после загрузки.
ПриоритетыПроведенияДокументов = Новый Соответствие;
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ПриходныйКассовыйОрдер"), 	 	 1);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.РасходныйКассовыйОрдер"), 		 2);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ОплатаПлатежнойКартой"), 		 3);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ВедомостьНаВыплатуЗарплаты"),	 4);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ПоступлениеТоваровУслуг"), 		 5);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.АвансовыйОтчет"), 				 6);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ОприходованиеТоваров"), 		 7);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ИнвентаризацияТоваровНаСкладе"), 8);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ПеремещениеТоваров"), 		 	 9);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.СписаниеТоваров"), 				 10);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ТребованиеНакладная"), 			 11);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ВозвратТоваровПоставщику"), 	 12);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.РеализацияТоваровУслуг"),		 13);
ПриоритетыПроведенияДокументов.Вставить(Тип("ДокументСсылка.ВозвратТоваровОтПокупателя"), 	 14);

// Таблица загруженных документов для отложенного проведения после загрузки.
ЗагруженныеДокументы = Новый ТаблицаЗначений;
ЗагруженныеДокументы.Колонки.Добавить("ДатаДокумента", Новый ОписаниеТипов("Дата"));
ЗагруженныеДокументы.Колонки.Добавить("Приоритет",	   Новый ОписаниеТипов("Число",,, Новый КвалификаторыЧисла(2,0)));
ЗагруженныеДокументы.Колонки.Добавить("Ссылка");

Параметры.Вставить("ЗагруженныеДокументы",			 ЗагруженныеДокументы);
Параметры.Вставить("ПриоритетыПроведенияДокументов", ПриоритетыПроведенияДокументов);</ПередЗагрузкойДанных>
	<ПослеЗагрузкиДанных>// Отложенное проведение документов.
Если Параметры._ПроводитьДокументы = Истина Тогда
	Параметры.ЗагруженныеДокументы.Сортировать("Приоритет, ДатаДокумента");
	Для каждого ЗагруженныйДокумент из Параметры.ЗагруженныеДокументы Цикл
		ДокументОбъект = ЗагруженныйДокумент.Ссылка.ПолучитьОбъект();
		Попытка
			// Неоперативно, чтобы дата не затерлась;
			ДокументОбъект.Записать(РежимЗаписиДокумента.Проведение, РежимПроведенияДокумента.Неоперативный);			
		Исключение
			//ОписаниеОшибки = ПодробноеПредставлениеОшибки(ИнформацияОбОшибке());
			ОписаниеОшибки = "Не удалось провести документ: " + ДокументОбъект.Ссылка;
			ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки);
			ЗаписьЖурналаРегистрации("БИТ_ЗагрузкаДанных", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки);
		КонецПопытки;
	КонецЦикла;
КонецЕсли;</ПослеЗагрузкиДанных>
	<ПослеЗагрузкиОбъекта>Попытка
	МетаданныеЗагруженногоОбъекта = Объект.Метаданные();
	
	Если Метаданные.Документы.Содержит(МетаданныеЗагруженногоОбъекта) Тогда
		
		//// Дефолтная организация, если в документе пустая после загрузки
		//Если МетаданныеЗагруженногоОбъекта.Реквизиты.Найти("Организация") &lt;&gt; Неопределено
		//	И Не ЗначениезЗаполнено(Объект.Организация)
		//Тогда
		//	ИмяНастройки = "битОрганизация";
		//	ЗначениеНастройки = "";
		//	Выполнить(Алгоритмы.ПолучитьНастройку);
		//	Объект.Организация = ЗначениеНастройки;
		//КонецЕсли;
		
		// Проведение документов, либо отмена проведения - есди документы обладают проводимостью.
		Если МетаданныеЗагруженногоОбъекта.Проведение = Метаданные.СвойстваОбъектов.Проведение.Разрешить Тогда
			Если Параметры._ПроводитьДокументы = Истина Тогда
				// Заполнение таблицы отложенного проведения документов.
				ПриоритетПроведения = Параметры.ПриоритетыПроведенияДокументов.Получить(ТипЗнч(Объект.Ссылка));
				Если ПриоритетПроведения &lt;&gt; Неопределено И НЕ Объект.ПометкаУдаления Тогда
					Попытка
						Объект.Записать();
						НоваяСтрока = Параметры.ЗагруженныеДокументы.Добавить();
						НоваяСтрока.Ссылка		  = Объект.Ссылка;
						НоваяСтрока.ДатаДокумента = Объект.Дата;
						НоваяСтрока.Приоритет	  = ПриоритетПроведения;
					Исключение
					КонецПопытки;
				КонецЕсли;
			Иначе
				// Отмена проведения ранее загруженных документов, если в параметрах указано не проводить документы при загрузке. 
				Если Объект.Проведен Тогда 
					Попытка
						Объект.Записать(РежимЗаписиДокумента.ОтменаПроведения);			
					Исключение
						ОписаниеОшибки = "Не удалось отменить проведение документа: " + Объект.Ссылка;
						ОбщегоНазначенияКлиентСервер.СообщитьПользователю(ОписаниеОшибки);
						ЗаписьЖурналаРегистрации("БИТ_ЗагрузкаДанных", УровеньЖурналаРегистрации.Ошибка,,, ОписаниеОшибки);
					КонецПопытки;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;	
	
Исключение
КонецПопытки;</ПослеЗагрузкиОбъекта>
	<Параметры>
		<Параметр Имя="_ПроводитьДокументы                               " Наименование="Проводить документы" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Булево" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="ВидыНоменклатуры                                  " Наименование="Виды номенклатуры" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="false" ТипЗначения="ХранилищеЗначения" ПередаватьПараметрПриВыгрузке="false"/>
		<Параметр Имя="ДетализироватьКлиентов                            " Наименование="Детализировать клиентов" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Булево" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="Доки                                              " Наименование="Доки" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="false" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="false"/>
		<Параметр Имя="ДокиПоБезналу                                     " Наименование="ДокиПоБезналу" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="false" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="false"/>
		<Параметр Имя="Кассы                                             " Наименование="Кассы" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="Контрагенты                                       " Наименование="Контрагенты" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="КонтрагентыГруппы                                 " Наименование="КонтрагентыГруппы" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="Номенклатура                                      " Наименование="Номенклатура" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="НоменклатураГруппы                                " Наименование="НоменклатураГруппы" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="Организация                                       " Наименование="Организация" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="СправочникСсылка.Организации" ПередаватьПараметрПриВыгрузке="false" ПравилоКонвертации="Организации                                       "/>
		<Параметр Имя="Склады                                            " Наименование="Склады" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
		<Параметр Имя="СтатьиДвиженияДенежныхСредств                     " Наименование="СтатьиДвиженияДенежныхСредств" ИспользуетсяПриЗагрузке="true" УстанавливатьВДиалоге="true" ТипЗначения="Строка" ПередаватьПараметрПриВыгрузке="true"/>
	</Параметры>
	<Обработки/>
	<ПравилаКонвертацииОбъектов>
		<Группа>
			<Код>Документы</Код>
			<Наименование>Документы</Наименование>
			<Порядок>50</Порядок>
			<Правило>
				<Код>РеализацияТоваровУслуг</Код>
				<Наименование>ДокументСсылка.ОказаниеУслуг --&gt; ДокументСсылка.РеализацияТоваровИУслуг</Наименование>
				<Порядок>50</Порядок>
				<ПередВыгрузкой>// Документ не выгружается, если ничего не продали по нему
Отказ = Истина;
Если Источник.Проведен 
	  И	(Источник.ВидОперации = Перечисления.ВидыОперацийОказанияУслуг.ПродажаКлиенту Или Источник.ВидОперации.Пустая())
Тогда
	Если ЗначениеЗаполнено(Источник.Документ) Тогда
		Для Каждого Строка из Источник.Работы Цикл
			Если Строка.Сумма &gt; 0 Тогда
				Если (ЗначениеЗаполнено(Источник.Документ) И Строка.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
					Отказ = Ложь;
					Прервать;
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
		Если Отказ Тогда
			Для Каждого Строка из Источник.Материалы Цикл
				Если Строка.Сумма &gt; 0 Тогда
					Если (ЗначениеЗаполнено(Источник.Документ) И Строка.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
						Отказ = Ложь;
						Прервать;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		Если Отказ Тогда
			Для Каждого Строка из Источник.Товары Цикл
				Если Строка.Сумма &gt; 0 Тогда
					Если (ЗначениеЗаполнено(Источник.Документ) И Строка.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
						Отказ = Ложь;
						Прервать;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		Если Отказ Тогда
			Для Каждого Строка из Источник.Сертификаты Цикл
				Если Строка.Сумма &gt; 0 И Строка.Сертификат.ВидСертификата.ТипСертификата = Перечисления.ТипыСертификатов.НаУслуги Тогда
					Если (ЗначениеЗаполнено(Источник.Документ) И Строка.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
						Отказ = Ложь;
						Прервать;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
		Если Отказ Тогда
			Для Каждого Строка из Источник.ПополнениеСертификатов Цикл
				Если Строка.Сумма &gt; 0 И Строка.Сертификат.ВидСертификата.ТипСертификата = Перечисления.ТипыСертификатов.НаУслуги Тогда
					Если (ЗначениеЗаполнено(Источник.Документ) И Строка.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
						Отказ = Ложь;
						Прервать;
					КонецЕсли;
				КонецЕсли;
			КонецЦикла;
		КонецЕсли;
	Иначе
		Отказ = Ложь;
	КонецЕсли;
КонецЕсли;</ПередВыгрузкой>
				<ПослеВыгрузки>ТЗПродажи = Новый ТаблицаЗначений(); 
ТЗПродажи.Колонки.Добавить("Номенклатура"); 
ТЗПродажи.Колонки.Добавить("Количество"); 
ТЗПродажи.Колонки.Добавить("Коэффициент"); 
ТЗПродажи.Колонки.Добавить("Цена"); 
ТЗПродажи.Колонки.Добавить("Сумма"); 
// Реквизиты, которые пойдут в шапку
ТЗПродажи.Колонки.Добавить("Дата"); 
ТЗПродажи.Колонки.Добавить("Ответственный"); 
ТЗПродажи.Колонки.Добавить("Склад", Новый ОписаниеТипов("СправочникСсылка.Склады"));
ТЗПродажи.Колонки.Добавить("Клиент");
ТЗПродажи.Колонки.Добавить("Организация");

// Формирование таблицы проданной номенклатуры
мсТЧ = Новый Массив;
мсТЧ.Добавить(Новый Структура("Имя,ТЧ","Работы"		,Источник.Работы));
мсТЧ.Добавить(Новый Структура("Имя,ТЧ","Материалы"  ,Источник.Материалы));
мсТЧ.Добавить(Новый Структура("Имя,ТЧ","Товары"		,Источник.Товары));

Для Каждого элТЧ из мсТЧ Цикл
	
	Для Каждого СтрокаИсточник Из элТЧ.ТЧ Цикл 
		Если СтрокаИсточник.Сумма &gt; 0 Тогда
			
			Если (Не СтрокаИсточник.НеОплачиваетсяПолисом И ЗначениеЗаполнено(Источник.Документ)) Тогда
				Продолжить;
			КонецЕсли;
			
			СтрПродажи = ТЗПродажи.Добавить();
			ЗаполнитьЗначенияСвойств(СтрПродажи, СтрокаИсточник);
			
			Если элТЧ.Имя &lt;&gt; "Работы" Тогда
				СтрПродажи.Количество  = СтрокаИсточник.Количество * СтрокаИсточник.Коэффициент;
				Если СтрокаИсточник.Коэффициент &lt;&gt; 0 И СтрокаИсточник.Количество&lt;&gt;0 Тогда
					СтрПродажи.Цена = СтрПродажи.Сумма / (СтрокаИсточник.Коэффициент * СтрокаИсточник.Количество);
				КонецЕсли;
			КонецЕсли;
			
			СтрПродажи.Коэффициент = 1;
			
			СтрПродажи.Дата = КонецДня(Источник.Дата);     
			СтрПродажи.Организация = Источник.Филиал.Организация;
			
			ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
			Если ДетализироватьКлиентов Тогда
				СтрПродажи.Клиент = Источник.Клиент;
			КонецЕсли;
			
			Если СтрПродажи.Склад.Пустая() Тогда
				Если элТЧ.Имя = "Товары" Тогда
					СтрПродажи.Склад = Источник.Склад;
				ИначеЕсли элТЧ.Имя = "Материалы" Тогда
					СтрПродажи.Склад = Источник.СкладМатериалов;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
КонецЦикла;

// Продажа и пополнение СЕРТИФИКАТОВ НА УСЛУГИ (абонементов)
мсТЧ = Новый Массив;
мсТЧ.Добавить(Новый Структура("Имя,ТЧ","Сертификаты"		   , Источник.Сертификаты));
мсТЧ.Добавить(Новый Структура("Имя,ТЧ","ПополнениеСертификатов", Источник.ПополнениеСертификатов));

Для Каждого элТЧ из мсТЧ Цикл
	Для Каждого СтрокаИсточник Из элТЧ.ТЧ Цикл 
		
		Если СтрокаИсточник.Сумма &gt; 0 И СтрокаИсточник.Сертификат.ВидСертификата.ТипСертификата = Перечисления.ТипыСертификатов.НаУслуги Тогда
			Если (ЗначениеЗаполнено(Источник.Документ) И СтрокаИсточник.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
				СтрПродажи = ТЗПродажи.Добавить();
				СтрПродажи.Номенклатура = СтрокаИсточник.Сертификат.ВидСертификата.Номенклатура;
				СтрПродажи.Количество	= 1;
				СтрПродажи.Коэффициент	= 1;
				СтрПродажи.Цена			= СтрокаИсточник.Сумма;
				СтрПродажи.Сумма		= СтрокаИсточник.Сумма;
				СтрПродажи.Дата = КонецДня(Источник.Дата);   
				СтрПродажи.Организация = Источник.Филиал.Организация;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
КонецЦикла;

Если ПустаяСтрока(Параметры.Доки) Тогда
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТЗПродажи);
Иначе
	ТабДоки = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	Для Каждого СтрокаИсточник Из ТЗПродажи Цикл
		ЗаполнитьЗначенияСвойств(ТабДоки.Добавить(),СтрокаИсточник);
	КонецЦикла;
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТабДоки);
КонецЕсли;

Отказ = Истина;</ПослеВыгрузки>
				<ПоследовательностьПолейПоиска>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;

Если ДетализироватьКлиентов Тогда
 
	СтрокаИменСвойствПоиска = "Дата, Склад, Организация, Контрагент";
 
Иначе
 
	СтрокаИменСвойствПоиска = "Дата, Склад, Организация";
 
КонецЕсли;</ПоследовательностьПолейПоиска>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.РеализацияТоваровУслуг</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>5</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>7</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РеализацияТоваровУслугСводно</Код>
				<Наименование>ДокументСсылка.ОказаниеУслуг --&gt; ДокументСсылка.РеализацияТоваровИУслуг</Наименование>
				<Порядок>100</Порядок>
				<ПослеЗагрузки>ЗначениеНастройки = "";

Объект.ВидОперации = Перечисления.ВидыОперацийРеализацияТоваров.ПродажаКомиссия;
Объект.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.КурсВзаиморасчетов = 1;
Объект.КратностьВзаиморасчетов = 1;
Объект.СпособЗачетаАвансов = Перечисления.СпособыЗачетаАвансов.Автоматически;

ИмяНастройки = "битСуммаВключаетНДС";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СуммаВключаетНДС = ЗначениеНастройки;

ИмяНастройки = "битУчитыватьНДС";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.ДокументБезНДС = Не ЗначениеНастройки;

// Свертка табличных частей
ИмяТЧ = "Товары";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);
ИмяТЧ = "Услуги";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);
ИмяТЧ = "АгентскиеУслуги";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);

// Контрагент
ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	ИмяНастройки = "битКонтрагентКлиент";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.Контрагент = ЗначениеНастройки;
КонецЕсли;
Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);

// Табличные части
мсТЧ = Новый Массив;
мсТЧ.Добавить("Товары"); мсТЧ.Добавить("Услуги"); мсТЧ.Добавить("АгентскиеУслуги");
Для Каждого ИмяТЧ Из мсТЧ Цикл
	Для Каждого Строка из Объект[ИмяТЧ] Цикл
		// НДС
		Строка.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(Строка.Номенклатура.ВидСтавкиНДС, Объект.Дата);
		ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(Строка, Объект.СуммаВключаетНДС);//, Объект);
		
		// Прочее
		Если Строка.Количество &lt;&gt; 0 Тогда
			Строка.Цена = Строка.Сумма / Строка.Количество;
		КонецЕсли;
	КонецЦикла;
КонецЦикла;

Для Каждого Строка из Объект.Услуги Цикл
	Строка.Содержание = РаботаСНоменклатуройКлиентСерверБП.СодержаниеУслуги(?(Строка.Номенклатура.НаименованиеПолное = "", Строка.Номенклатура.Наименование, Строка.Номенклатура.НаименованиеПолное), Строка.Номенклатура.ПериодичностьУслуги, Объект.Дата);
КонецЦикла;

Выполнить(Алгоритмы.АгентскиеУслуги_РТУ_ДополнитьТабЧасть); // Агентские услуги

// Финальные действия
СуммаДокумента = Объект.Товары.Итог("Сумма") + Объект.Услуги.Итог("Сумма") + Объект.АгентскиеУслуги.Итог("Сумма");

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;

Если ДетализироватьКлиентов Тогда
 
	СтрокаИменСвойствПоиска = "Дата, Склад, Комментарий, Контрагент";
 
Иначе
 
	СтрокаИменСвойствПоиска = "Дата, Склад, Комментарий";
 
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.РеализацияТоваровУслуг</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>3</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство Отключить="true">
						<Код>4</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>5</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>20</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Организация</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>19</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>13</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>стрВидДокумента = ". Реализация.";
Выполнить(Алгоритмы.ФормированиеКомментарияСводногоДокумента);</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>7</Код>
						<Наименование>--&gt; Товары</Наименование>
						<Порядок>500</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>8</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>12</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
					<Группа>
						<Код>14</Код>
						<Наименование>--&gt; Услуги</Наименование>
						<Порядок>550</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Услуги" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>15</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>16</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>17</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>18</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
					<Группа>
						<Код>21</Код>
						<Наименование>--&gt; АгентскиеУслуги</Наименование>
						<Порядок>550</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="АгентскиеУслуги" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>22</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>23</Код>
							<Наименование>--&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>24</Код>
							<Наименование>--&gt; Цена</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>26</Код>
							<Наименование>--&gt; Сумма</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>27</Код>
							<Наименование>--&gt; Контрагент</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ТребованиеНакладная</Код>
				<Наименование>ДокументСсылка.ОказаниеУслуг --&gt; ДокументСсылка.ТребованиеНакладная</Наименование>
				<Порядок>150</Порядок>
				<ПередВыгрузкой>// Документ не выгруажется, если нет материалов, списанных без продажи клиенту
Отказ = Истина;
Если Источник.Проведен Тогда
	Для Каждого Строка из Источник.Материалы Цикл
		Если Строка.Сумма = 0 Тогда 
			Если (ЗначениеЗаполнено(Источник.Документ) И Строка.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
				Отказ = Ложь;
				Прервать;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
КонецЕсли;</ПередВыгрузкой>
				<ПослеВыгрузки>
ТЗСписание = Новый ТаблицаЗначений(); 
ТЗСписание.Колонки.Добавить("Номенклатура"); 
ТЗСписание.Колонки.Добавить("Количество"); 
ТЗСписание.Колонки.Добавить("Коэффициент"); 
// Реквизиты, которые пойдут в шапку
ТЗСписание.Колонки.Добавить("Дата"); 
ТЗСписание.Колонки.Добавить("Ответственный"); 
ТЗСписание.Колонки.Добавить("Склад");
ТЗСписание.Колонки.Добавить("Организация"); 

Для Каждого СтрокаИсточник Из Источник.Материалы Цикл 
	Если СтрокаИсточник.Сумма = 0 Тогда
		Если (ЗначениеЗаполнено(Источник.Документ) И СтрокаИсточник.НеОплачиваетсяПолисом) ИЛИ НЕ ЗначениеЗаполнено(Источник.Документ) Тогда
			СтрСписание = ТЗСписание.Добавить();
			ЗаполнитьЗначенияСвойств(СтрСписание, СтрокаИсточник);
			СтрСписание.Количество  = СтрокаИсточник.Количество * СтрокаИсточник.Коэффициент;
			СтрСписание.Коэффициент = 1;
			
			СтрСписание.Дата = КонецДня(Источник.Дата);    
			СтрСписание.Организация = Источник.Филиал.Организация;	
			Если СтрСписание.Склад.Пустая() Тогда
				СтрСписание.Склад = Источник.СкладМатериалов;
			КонецЕсли;
		КонецЕсли;
	КонецЕсли;
КонецЦикла;

Если ПустаяСтрока(Параметры.Доки) Тогда
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТЗСписание);
Иначе
	ТабДоки = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	Для Каждого СтрокаИсточник Из ТЗСписание Цикл
		ЗаполнитьЗначенияСвойств(ТабДоки.Добавить(),СтрокаИсточник);
	КонецЦикла;
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТабДоки);
КонецЕсли;

Отказ = Истина;</ПослеВыгрузки>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.ТребованиеНакладная</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>СкладМатериалов --&gt; Склад</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="СкладМатериалов" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Группа>
						<Код>4</Код>
						<Наименование>Материалы --&gt; Материалы</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Материалы" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Материалы" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>5</Код>
							<Наименование>ЕдиницаИзмерения --&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.ЕдиницыИзмерения"/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.ЕдиницаИзмерения.ЕдиницаПоКлассификатору;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>8</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ТребованиеНакладнаяСводно</Код>
				<Наименование>ДокументСсылка.ОказаниеУслуг --&gt; ДокументСсылка.ТребованиеНакладная</Наименование>
				<Порядок>200</Порядок>
				<ПослеЗагрузки>ЗначениеНастройки = "";
ИмяНастройки = "битСчетУчетаСписанияМатериалов";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СчетЗатрат = ЗначениеНастройки;

// Свертка табличных частей
ИмяТЧ = "Материалы";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);

// Подстановка статьи затрат в шапку
Если ЗначениеЗаполнено(Объект.СчетЗатрат) Тогда
	// БУ
	ВидыСубконто = Объект.СчетЗатрат.ВидыСубконто;
	Для сч = 0 по ВидыСубконто.Количество()-1 Цикл
		Если ВидыСубконто[сч].ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
			ИмяНастройки = "битСтатьяЗатратСписанияМатериаловНаРаботы";
			Выполнить(Алгоритмы.ПолучитьНастройку);
			Объект["Субконто"+Строка(сч+1)] = ЗначениеНастройки;
			//СтруктураНастроек.Свойство("битСтатьяЗатратСписанияМатериаловНаРаботы",Объект["Субконто"+Строка(сч+1)]);
			Прервать;
		КонецЕсли;
	КонецЦикла;
КонецЕсли;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.ТребованиеНакладная</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>9</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Организация</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>8</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>стрВидДокумента = ". Списание материалов на работы.";
Выполнить(Алгоритмы.ФормированиеКомментарияСводногоДокумента);</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>4</Код>
						<Наименование>--&gt; Материалы</Наименование>
						<Порядок>300</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Материалы" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>5</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РозничнаяВыручкаНаличные</Код>
				<Наименование>Розничная наличная выручка</Наименование>
				<Порядок>250</Порядок>
				<ПередВыгрузкой>Отказ = Не  (Источник.Проведен И (Источник.ПолученоНаличными - ?(Источник.СдачуВДепозит, 0, Источник.Сдача))&gt;0);</ПередВыгрузкой>
				<ПослеВыгрузки>ТЗОплата = Новый ТаблицаЗначений(); 
// Реквизиты, которые пойдут в шапку
ТЗОплата.Колонки.Добавить("Сумма"); 
ТЗОплата.Колонки.Добавить("Дата"); 
ТЗОплата.Колонки.Добавить("Ответственный"); 
ТЗОплата.Колонки.Добавить("СтатьяДвиженияДенежныхСредств");
ТЗОплата.Колонки.Добавить("Клиент");   
ТЗОплата.Колонки.Добавить("Организация");

СтрОплата = ТЗОплата.Добавить();
СтрОплата.Дата = КонецДня(Источник.Дата);
СтрОплата.Организация = Источник.Филиал.Организация;
СтрОплата.СтатьяДвиженияДенежныхСредств = Источник.СтатьяДвиженияДенежныхСредств; 

ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если ДетализироватьКлиентов Тогда
	СтрОплата.Клиент = Источник.Клиент;
КонецЕсли;
			
Если НЕ Источник.СдачуВДепозит Тогда
	СтрОплата.Сумма = Источник.ПолученоНаличными - Источник.Сдача;
Иначе
	СтрОплата.Сумма = Источник.ПолученоНаличными;
Конецесли;

Если Источник.ВидОперации = Перечисления.ВидыОперацийОказанияУслуг.ВозвратКлиенту Тогда
	СтрОплата.Сумма = -СтрОплата.Сумма;
КонецЕсли;

Если ПустаяСтрока(Параметры.Доки) Тогда
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТЗОплата);
Иначе
	ТабДоки = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	Для Каждого СтрокаИсточник Из ТЗОплата Цикл
		ЗаполнитьЗначенияСвойств(ТабДоки.Добавить(),СтрокаИсточник);
	КонецЦикла;
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТабДоки);
КонецЕсли;

Отказ = Истина;</ПослеВыгрузки>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.ПриходныйКассовыйОрдер</Приемник>
				<Свойства>
					<Свойство Отключить="true" Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство Отключить="true">
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>4</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>5</Код>
						<Наименование>СтатьяДвиженияДенежныхСредств --&gt; СтатьяДвиженияДенежныхСредств</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<Приемник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<КодПравилаКонвертации>СтатьиДвиженияДенежныхСредств                     </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РозничнаяВыручкаНаличныеСводно</Код>
				<Наименование> --&gt; ДокументСсылка.ПриходныйКассовыйОрдер</Наименование>
				<Порядок>300</Порядок>
				<ПослеЗагрузки>Объект.СчетКасса = ПланыСчетов.Хозрасчетный.КассаОрганизации;
Объект.ВалютаДокумента         = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.ВидОперации = Перечисления.ВидыОперацийПКО.ОплатаПокупателя;
ЗначениеНастройки = "";

мПрименениеУСН = УчетнаяПолитика.ПрименяетсяУСН(Объект.Организация, Объект.Дата);

// НДС и контрагент клиента, если надо.
// Контрагент.
ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	ИмяНастройки = "битКонтрагентКлиент";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.Контрагент = ЗначениеНастройки;
КонецЕсли;
Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);

Если мПрименениеУСН Тогда
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
Иначе
	ИмяНастройки = "битОсновнаяСтавкаНДС";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(ЗначениеНастройки, Объект.Дата);
КонецЕсли;

Если Объект.РасшифровкаПлатежа.Количество()=0 Тогда
	СтрокаПлатеж = Объект.РасшифровкаПлатежа.Добавить()
КонецЕсли;

Объект.СуммаДокумента = Объект.РасшифровкаПлатежа[0].СуммаПлатежа;

Для Каждого СтрокаПлатеж Из Объект.РасшифровкаПлатежа Цикл
	СтрокаПлатеж.СпособПогашенияЗадолженности = Перечисления.СпособыПогашенияЗадолженности.Автоматически;
	СтрокаПлатеж.ДоговорКонтрагента      = Объект.ДоговорКонтрагента;
	СтрокаПлатеж.КурсВзаиморасчетов      = 1;
	СтрокаПлатеж.КратностьВзаиморасчетов = 1;
	СтрокаПлатеж.СуммаВзаиморасчетов     = Объект.СуммаДокумента;
	СтрокаПлатеж.СуммаПлатежа            = Объект.СуммаДокумента;
	СтрокаПлатеж.СтавкаНДС               = Объект.СтавкаНДС;

	ЗначениеСтавкиНДС     = УчетНДСВызовСервераПовтИсп.ПолучитьСтавкуНДС(СтрокаПлатеж.СтавкаНДС);
	СтрокаПлатеж.СуммаНДС = СтрокаПлатеж.СуммаПлатежа * ЗначениеСтавкиНДС / (100 + ЗначениеСтавкиНДС);
КонецЦикла;
	
Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;

Если ДетализироватьКлиентов Тогда
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий, Организация, Контрагент";
 
Иначе
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий, Организация";
 
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.ПриходныйКассовыйОрдер</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>8</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Организация</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>7</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>стрВидДокумента = ". Розничная выручка.";
Выполнить(Алгоритмы.ФормированиеКомментарияСводногоДокумента);</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>4</Код>
						<Наименование>--&gt; РасшифровкаПлатежа</Наименование>
						<Порядок>250</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>5</Код>
							<Наименование>--&gt; СтатьяДвиженияДенежныхСредств</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						</Свойство>
						<Свойство>
							<Код>6</Код>
							<Наименование>--&gt; СуммаПлатежа</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СуммаПлатежа" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РозничнаяВыручкаНаличныеСводноРасход</Код>
				<Наименование> --&gt; ДокументСсылка.ПриходныйКассовыйОрдер</Наименование>
				<Порядок>350</Порядок>
				<ПослеЗагрузки>Объект.СчетКасса = ПланыСчетов.Хозрасчетный.КассаОрганизации;

Объект.ВалютаДокумента         = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.ВидОперации = Перечисления.ВидыОперацийРКО.ВозвратПокупателю;
ЗначениеНастройки = "";

мПрименениеУСН = УчетнаяПолитика.ПрименяетсяУСН(Объект.Организация, Объект.Дата);

// НДС и контрагент клиента, если надо.
// Контрагент.
ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	ИмяНастройки = "битКонтрагентКлиент";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.Контрагент = ЗначениеНастройки;
КонецЕсли;
Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);

Если мПрименениеУСН Тогда
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
Иначе
	ИмяНастройки = "битОсновнаяСтавкаНДС";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(ЗначениеНастройки, Объект.Дата);
КонецЕсли;

Если Объект.РасшифровкаПлатежа.Количество()=0 Тогда
	СтрокаПлатеж = Объект.РасшифровкаПлатежа.Добавить()
КонецЕсли;

Объект.СуммаДокумента = Объект.РасшифровкаПлатежа[0].СуммаПлатежа;

Для Каждого СтрокаПлатеж Из Объект.РасшифровкаПлатежа Цикл
	СтрокаПлатеж.СпособПогашенияЗадолженности = Перечисления.СпособыПогашенияЗадолженности.Автоматически;
	СтрокаПлатеж.ДоговорКонтрагента      = Объект.ДоговорКонтрагента;
	СтрокаПлатеж.КурсВзаиморасчетов      = 1;
	СтрокаПлатеж.КратностьВзаиморасчетов = 1;
	СтрокаПлатеж.СуммаВзаиморасчетов     = Объект.СуммаДокумента;
	СтрокаПлатеж.СуммаПлатежа            = Объект.СуммаДокумента;
	СтрокаПлатеж.СтавкаНДС               = Объект.СтавкаНДС;
КонецЦикла;

ЗначениеСтавкиНДС     = УчетНДСВызовСервераПовтИсп.ПолучитьСтавкуНДС(СтрокаПлатеж.СтавкаНДС);
СтрокаПлатеж.СуммаНДС = СтрокаПлатеж.СуммаПлатежа * ЗначениеСтавкиНДС / (100 + ЗначениеСтавкиНДС);

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;

Если ДетализироватьКлиентов Тогда
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий, Контрагент";
 
Иначе
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий";
 
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.РасходныйКассовыйОрдер</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>17</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Организация</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>16</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>4</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>стрВидДокумента = ". Розничная выручка.";
Выполнить(Алгоритмы.ФормированиеКомментарияСводногоДокумента);</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>13</Код>
						<Наименование>--&gt; РасшифровкаПлатежа</Наименование>
						<Порядок>250</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="РасшифровкаПлатежа" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>14</Код>
							<Наименование>--&gt; СуммаПлатежа</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СуммаПлатежа" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>15</Код>
							<Наименование>--&gt; СтатьяДвиженияДенежныхСредств</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РозничнаяВыручкаБезналичные</Код>
				<Наименование>Документ: Оказание услуг</Наименование>
				<Порядок>400</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен 
		Или (Источник.Оплата.Найти(Перечисления.ВидыОплаты.Безналичные, "ВидОплаты") = Неопределено);</ПередВыгрузкой>
				<ПослеВыгрузки>ТЗОплата = Новый ТаблицаЗначений();

// Реквизиты, которые пойдут в шапку
ТЗОплата.Колонки.Добавить("СуммаДокумента"); 
ТЗОплата.Колонки.Добавить("Дата");
ТЗОплата.Колонки.Добавить("ЭквайринговыйТерминал"); 
ТЗОплата.Колонки.Добавить("Клиент");  
ТЗОплата.Колонки.Добавить("Организация");     

ОплатыБезнал = Источник.Оплата.Выгрузить(Новый Структура("ВидОплаты", Перечисления.ВидыОплаты.Безналичные));
ОплатыБезнал.Свернуть("ЭквайринговыйТерминал", "Сумма");

Для Каждого СтрокаБезнал Из ОплатыБезнал Цикл
	Если ЗначениеЗаполнено(СтрокаБезнал.ЭквайринговыйТерминал) Тогда
		СтрОплата = ТЗОплата.Добавить();
		СтрОплата.Дата = КонецДня(Источник.Дата); 
		СтрОплата.СуммаДокумента = СтрокаБезнал.Сумма;   
		СтрОплата.Организация = Источник.Филиал.Организация;
		Если Источник.ВидОперации = Перечисления.ВидыОперацийОказанияУслуг.ВозвратКлиенту Тогда
			СтрОплата.СуммаДокумента = -СтрОплата.СуммаДокумента;
		КонецЕсли;
		СтрОплата.ЭквайринговыйТерминал = СтрокаБезнал.ЭквайринговыйТерминал;
		ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
		Если ДетализироватьКлиентов Тогда
			СтрОплата.Клиент = Источник.Клиент;
		КонецЕсли; 	
	КонецЕсли;		
КонецЦикла;

Если ПустаяСтрока(Параметры.ДокиПоБезналу) Тогда
	Параметры.ДокиПоБезналу = ЗначениеВСтрокуВнутр(ТЗОплата);
Иначе
	ТабДоки = ЗначениеИзСтрокиВнутр (Параметры.ДокиПоБезналу);
	Для Каждого СтрокаИсточник Из ТЗОплата Цикл
		ЗаполнитьЗначенияСвойств(ТабДоки.Добавить(),СтрокаИсточник);
	КонецЦикла;
	Параметры.ДокиПоБезналу = ЗначениеВСтрокуВнутр(ТабДоки);       
КонецЕсли;    

Отказ = Истина;</ПослеВыгрузки>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.ОплатаПлатежнойКартой</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>3</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РозничнаяВыручкаБезналичныеСводно</Код>
				<Наименование>Документ: Оказание услуг</Наименование>
				<Порядок>450</Порядок>
				<ПослеЗагрузки>Объект.СчетКасса = ПланыСчетов.Хозрасчетный.КассаОрганизации;
Объект.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();

ЗначениеНастройки = "";

ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	ИмяНастройки = "битКонтрагентКлиент";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.Контрагент = ЗначениеНастройки;
КонецЕсли;

мПрименениеУСН = УчетнаяПолитика.ПрименяетсяУСН(Объект.Организация, Объект.Дата);

СтруктураРеквизитов = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(Объект.ВидОплаты, "Контрагент, ДоговорКонтрагента, СчетУчетаРасчетов");
Объект.СчетКасса = СтруктураРеквизитов.СчетУчетаРасчетов;
Объект.Эквайер = СтруктураРеквизитов.Контрагент;
Объект.ДоговорЭквайринга = СтруктураРеквизитов.ДоговорКонтрагента;

Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);

Если мПрименениеУСН Тогда
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
Иначе
	ИмяНастройки = "битОсновнаяСтавкаНДС";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(ЗначениеНастройки, Объект.Дата);
КонецЕсли;

Если Объект.РасшифровкаПлатежа.Количество() = 0 Тогда
	СтрокаПлатеж = Объект.РасшифровкаПлатежа.Добавить();
Иначе
	СтрокаПлатеж = Объект.РасшифровкаПлатежа[0];
КонецЕсли;
СтрокаПлатеж.СпособПогашенияЗадолженности = Перечисления.СпособыПогашенияЗадолженности.Автоматически;
СтрокаПлатеж.ДоговорКонтрагента      = Объект.ДоговорКонтрагента;
СтрокаПлатеж.СуммаПлатежа            = Объект.СуммаДокумента;
СтрокаПлатеж.КурсВзаиморасчетов      = 1;
СтрокаПлатеж.КратностьВзаиморасчетов = 1;
СтрокаПлатеж.СуммаВзаиморасчетов     = Объект.СуммаДокумента;

СтрокаПлатеж.СтавкаНДС = ?(мПрименениеУСН И УчетнаяПолитика.ПрименяетсяОсобыйПорядокНалогообложения(Объект.Организация, Объект.Дата),
						   Перечисления.СтавкиНДС.БезНДС,
						   Перечисления.СтавкиНДС.СтавкаНДС(Перечисления.ВидыСтавокНДС.Общая, Объект.Дата)
							);

ЗначениеСтавкиНДС     = УчетНДСВызовСервераПовтИсп.ПолучитьСтавкуНДС(СтрокаПлатеж.СтавкаНДС);
СтрокаПлатеж.СуммаНДС = СтрокаПлатеж.СуммаПлатежа * ЗначениеСтавкиНДС / (100 + ЗначениеСтавкиНДС);

СтруктураСчетов = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаРасчетовСКонтрагентом(Объект.Организация, Объект.Контрагент, Объект.ДоговорКонтрагента);
СтрокаПлатеж.СчетУчетаРасчетовСКонтрагентом = СтруктураСчетов.СчетРасчетовПокупателя;
СтрокаПлатеж.СчетУчетаРасчетовПоАвансам = СтруктураСчетов.СчетАвансовПокупателя;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;

Если ДетализироватьКлиентов Тогда
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий, ВидОплаты, Организация, Контрагент";
 
Иначе
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий, ВидОплаты, Организация";
 
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОплатаПлатежнойКартой</Источник>
				<Приемник>ДокументСсылка.ОплатаПлатежнойКартой</Приемник>
				<Свойства>
					<Свойство>
						<Код>2</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<НеЗамещать>true</НеЗамещать>
						<Код>7</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Организация</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>4</Код>
						<Наименование>ЭквайринговыйТерминал --&gt; ВидОплаты</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ЭквайринговыйТерминал" Вид="Реквизит" Тип="СправочникСсылка.ЭквайринговыеТерминалы"/>
						<Приемник Имя="ВидОплаты" Вид="Реквизит" Тип="СправочникСсылка.ВидыОплатОрганизаций"/>
						<КодПравилаКонвертации>ЭквайринговыеТерминалыВидыОплатОрганизаций        </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>--&gt; ВидОперации</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийОплатаПлатежнойКартой"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>стрВидДокумента = ". Безналичная выручка.";
Выполнить(Алгоритмы.ФормированиеКомментарияСводногоДокумента);</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ВозвратТоваровОтПокупателя</Код>
				<Наименование>ДокументСсылка.ОказаниеУслуг --&gt; ДокументСсылка.РеализацияТоваровИУслуг</Наименование>
				<Порядок>500</Порядок>
				<ПередВыгрузкой>// Документ не выгружается, если ничего не продали по нему
Отказ = Истина;
Если Источник.Проведен 
		И Источник.ВидОперации = Перечисления.ВидыОперацийОказанияУслуг.ВозвратКлиенту 
Тогда
	БезПолиса = Не ЗначениеЗаполнено(Источник.Документ);
	Если Отказ Тогда
		Для Каждого Строка из Источник.Материалы Цикл
			Если Строка.Сумма &gt; 0 Тогда
				Если БезПолиса Или Строка.НеОплачиваетсяПолисом Тогда
					Отказ = Ложь;
					Прервать;
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
	Если Отказ Тогда
		Для Каждого Строка из Источник.Товары Цикл
			Если Строка.Сумма &gt; 0 Тогда
				Если БезПолиса Или Строка.НеОплачиваетсяПолисом Тогда
					Отказ = Ложь;
					Прервать;
				КонецЕсли;
			КонецЕсли;
		КонецЦикла;
	КонецЕсли;
КонецЕсли;</ПередВыгрузкой>
				<ПослеВыгрузки>ТЗПродажи = Новый ТаблицаЗначений(); 
ТЗПродажи.Колонки.Добавить("Номенклатура"); 
ТЗПродажи.Колонки.Добавить("Количество"); 
ТЗПродажи.Колонки.Добавить("Коэффициент"); 
ТЗПродажи.Колонки.Добавить("Цена"); 
ТЗПродажи.Колонки.Добавить("Сумма"); 
// Реквизиты, которые пойдут в шапку
ТЗПродажи.Колонки.Добавить("Дата"); 
ТЗПродажи.Колонки.Добавить("Ответственный"); 
ТЗПродажи.Колонки.Добавить("Склад", Новый ОписаниеТипов("СправочникСсылка.Склады")); 
ТЗПродажи.Колонки.Добавить("Клиент");
ТЗПродажи.Колонки.Добавить("Организация");

// Формирование таблицы проданной номенклатуры
мсТЧ = Новый Массив;
мсТЧ.Добавить(Новый Структура("Имя,ТЧ","Материалы"  ,Источник.Материалы));
мсТЧ.Добавить(Новый Структура("Имя,ТЧ","Товары"		,Источник.Товары));

БезПолиса = Не ЗначениеЗаполнено(Источник.Документ);

Для Каждого элТЧ из мсТЧ Цикл
	
	Для Каждого СтрокаИсточник Из элТЧ.ТЧ Цикл 
		Если СтрокаИсточник.Сумма &gt; 0 
			И (БезПолиса Или СтрокаИсточник.НеОплачиваетсяПолисом)
		Тогда
			
			СтрПродажи = ТЗПродажи.Добавить();
			ЗаполнитьЗначенияСвойств(СтрПродажи, СтрокаИсточник);

			СтрПродажи.Количество  = СтрокаИсточник.Количество * СтрокаИсточник.Коэффициент;
			Если СтрокаИсточник.Коэффициент &lt;&gt; 0 И СтрокаИсточник.Количество&lt;&gt;0 Тогда
				СтрПродажи.Цена = СтрПродажи.Сумма / (СтрокаИсточник.Коэффициент * СтрокаИсточник.Количество);
			КонецЕсли;
			
			СтрПродажи.Коэффициент = 1;
			
			СтрПродажи.Дата = КонецДня(Источник.Дата); 
			СтрПродажи.Организация = Источник.Филиал.Организация;
			
			ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
			Если ДетализироватьКлиентов Тогда
				СтрПродажи.Клиент = Источник.Клиент;
			КонецЕсли;
			
			Если СтрПродажи.Склад.Пустая() Тогда
				Если элТЧ.Имя = "Товары" Тогда
					СтрПродажи.Склад = Источник.Склад;
				ИначеЕсли элТЧ.Имя = "Материалы" Тогда
					СтрПродажи.Склад = Источник.СкладМатериалов;
				КонецЕсли;
			КонецЕсли;
		КонецЕсли;
	КонецЦикла;
КонецЦикла;        

// Добавление продаж абонементов
Для Каждого СтрокаИсточник Из Источник.Сертификаты Цикл 
	Если СтрокаИсточник.Сумма &gt; 0 
		И (БезПолиса Или СтрокаИсточник.НеОплачиваетсяПолисом)
	Тогда
		СтрПродажи = ТЗПродажи.Добавить();
		СтрПродажи.Номенклатура = СтрокаИсточник.Сертификат.ВидСертификата.Номенклатура;
		СтрПродажи.Количество	= 1;
		СтрПродажи.Коэффициент	= 1;
		СтрПродажи.Цена			= СтрокаИсточник.Сумма;
		СтрПродажи.Сумма		= СтрокаИсточник.Сумма;
		СтрПродажи.Дата = КонецДня(Источник.Дата);  
		СтрПродажи.Организация = Источник.Филиал.Организация;
	КонецЕсли;
КонецЦикла;

Если ПустаяСтрока(Параметры.Доки) Тогда
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТЗПродажи);
Иначе
	ТабДоки = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	Для Каждого СтрокаИсточник Из ТЗПродажи Цикл
		ЗаполнитьЗначенияСвойств(ТабДоки.Добавить(),СтрокаИсточник);
	КонецЦикла;
	Параметры.Доки = ЗначениеВСтрокуВнутр(ТабДоки);
КонецЕсли; 


Отказ = Истина;</ПослеВыгрузки>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.ВозвратТоваровОтПокупателя</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>10</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>11</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ВозвратТоваровОтПокупателяСводно</Код>
				<Наименование>ДокументСсылка.ОказаниеУслуг --&gt; ДокументСсылка.РеализацияТоваровИУслуг</Наименование>
				<Порядок>550</Порядок>
				<ПослеЗагрузки>ЗначениеНастройки = "";

Объект.ВидОперации = Перечисления.ВидыОперацийВозвратТоваровОтПокупателя.Товары;
Объект.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.КурсВзаиморасчетов = 1;
Объект.КратностьВзаиморасчетов = 1;

ИмяНастройки = "битСуммаВключаетНДС";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СуммаВключаетНДС = ЗначениеНастройки;

// Свертка табличных частей
ИмяТЧ = "Товары";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);

// Контрагент
ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	ИмяНастройки = "битКонтрагентКлиент";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.Контрагент = ЗначениеНастройки;
КонецЕсли;
Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);

// Табличные части
Для Каждого Строка из Объект.Товары Цикл
	
	// НДС
	Строка.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(Строка.Номенклатура.ВидСтавкиНДС, Объект.Дата);
	ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(Строка, Объект.СуммаВключаетНДС);
	
	Если Строка.Количество &lt;&gt; 0 Тогда
		Строка.Цена = Строка.Сумма / Строка.Количество;
	КонецЕсли;
	
КонецЦикла;

СуммаДокумента = Объект.Товары.Итог("Сумма");

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;

Если ДетализироватьКлиентов Тогда
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий, Склад, Организация, Контрагент";
 
Иначе
 
	СтрокаИменСвойствПоиска = "Дата, Комментарий, Склад, Организация";
 
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ОказаниеУслуг</Источник>
				<Приемник>ДокументСсылка.ВозвратТоваровОтПокупателя</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>17</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>9</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>16</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>стрВидДокумента = ". Возвраты.";
Выполнить(Алгоритмы.ФормированиеКомментарияСводногоДокумента);</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>11</Код>
						<Наименование>--&gt; Товары</Наименование>
						<Порядок>300</Порядок>
						<ПолучитьИзВходящихДанных>true</ПолучитьИзВходящихДанных>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>12</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>13</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>14</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>15</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ИнвентаризацияТоваровНаСкладе</Код>
				<Наименование>ДокументСсылка.ИнвентаризацияТоваров --&gt; ДокументСсылка.ИнвентаризацияТоваровНаСкладе</Наименование>
				<Порядок>600</Порядок>
				<ПередВыгрузкой>Отказ = Источник.ПометкаУдаления;</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.ИнвентаризацияТоваров</Источник>
				<Приемник>ДокументСсылка.ИнвентаризацияТоваровНаСкладе</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>5</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>13</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Инвентаризация №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>6</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>11</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>КоличествоУчет --&gt; КоличествоУчет</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="КоличествоУчет" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="КоличествоУчет" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.КоличествоУчет * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>7</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>8</Код>
							<Наименование>СуммаУчет --&gt; СуммаУчет</Наименование>
							<Порядок>350</Порядок>
							<Источник Имя="СуммаУчет" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="СуммаУчет" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Если ОбъектКоллекции.Количество = 0 Тогда

	Значение = ОбъектКоллекции.СуммаУчет;

Иначе

	Значение = ОбъектКоллекции.КоличествоУчет * ОбъектКоллекции.Сумма / ОбъектКоллекции.Количество;

КонецЕсли;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>12</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>400</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Если ОбъектКоллекции.Количество = 0 Тогда

	Значение = ОбъектКоллекции.Цена;		

Иначе

	Значение = ОбъектКоллекции.Сумма / ОбъектКоллекции.Количество;
	Если ОбъектКоллекции.Коэффициент &lt;&gt; 0 Тогда
		Значение = Значение / ОбъектКоллекции.Коэффициент;
	КонецЕсли;

КонецЕсли;</ПередВыгрузкой>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ОприходованиеТоваров</Код>
				<Наименование>ДокументСсылка.ОприходованиеТоваров --&gt; ДокументСсылка.ОприходованиеТоваров</Наименование>
				<Порядок>650</Порядок>
				<ПослеЗагрузки>ЗначениеНастройки = "";
ИмяНастройки = "битСтатьяДоходовДокументовОприходованияТоваров";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СтатьяПрочихДоходовРасходов = ЗначениеНастройки;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ОприходованиеТоваров</Источник>
				<Приемник>ДокументСсылка.ОприходованиеТоваров</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>5</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>15</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Оприходование товаров №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>8</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>13</Код>
							<Наименование>ЕдиницаИзмерения --&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.ЕдиницыИзмерения"/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.ЕдиницаИзмерения.ЕдиницаПоКлассификатору;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>14</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>12</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Если ОбъектКоллекции.Количество = 0 Тогда

	Значение = ОбъектКоллекции.Цена;		

Иначе

	Значение = ОбъектКоллекции.Сумма / ОбъектКоллекции.Количество;
	
	Если ОбъектКоллекции.Коэффициент &lt;&gt; 0 Тогда
		Значение = Значение / ОбъектКоллекции.Коэффициент;
	КонецЕсли;

КонецЕсли;</ПередВыгрузкой>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СписаниеТоваров</Код>
				<Наименование>ДокументСсылка.СписаниеТоваров --&gt; ДокументСсылка.СписаниеТоваров</Наименование>
				<Порядок>700</Порядок>
				<ПередВыгрузкой>Отказ = Не (Источник.Проведен И Не Источник.ПометкаУдаления) И Не Источник.ОтнесеноНаЗатраты;</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.СписаниеТоваров</Источник>
				<Приемник>ДокументСсылка.СписаниеТоваров</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>5</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>12</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Списание товаров №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>7</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>8</Код>
							<Наименование>ЕдиницаИзмерения --&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.ЕдиницыИзмерения"/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.ЕдиницаИзмерения.ЕдиницаПоКлассификатору;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СписаниеТоваровОтнесенныхНаЗатраты</Код>
				<Наименование>Документ: Списание товаров</Наименование>
				<Порядок>750</Порядок>
				<ПередВыгрузкой>Отказ = Не (Источник.Проведен И Не Источник.ПометкаУдаления) И Источник.ОтнесеноНаЗатраты;</ПередВыгрузкой>
				<ПослеЗагрузки>ЗначениеНастройки = "";
ИмяНастройки = "битСчетУчетаСписанияМатериалов";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СчетЗатрат = ЗначениеНастройки;

// Свертка табличных частей
ИмяТЧ = "Материалы";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);

// Подстановка статьи затрат в шапку
Если ЗначениеЗаполнено(Объект.СчетЗатрат) Тогда
	// БУ
	ВидыСубконто = Объект.СчетЗатрат.ВидыСубконто;
	Для сч = 0 по ВидыСубконто.Количество()-1 Цикл
		Если ВидыСубконто[сч].ВидСубконто = ПланыВидовХарактеристик.ВидыСубконтоХозрасчетные.СтатьиЗатрат Тогда
			ИмяНастройки = "битСтатьяЗатратСписанияМатериаловНаРаботы";
			Выполнить(Алгоритмы.ПолучитьНастройку);
			Объект["Субконто"+Строка(сч+1)] = ЗначениеНастройки;
			//СтруктураНастроек.Свойство("битСтатьяЗатратСписанияМатериаловНаРаботы",Объект["Субконто"+Строка(сч+1)]);
			Прервать;
		КонецЕсли;
	КонецЦикла;
КонецЕсли;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.СписаниеТоваров</Источник>
				<Приемник>ДокументСсылка.ТребованиеНакладная</Приемник>
				<Свойства>
					<Свойство>
						<Код>2</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>4</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство Отключить="true">
						<Код>5</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>7</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Списание товаров №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>8</Код>
						<Наименование>Товары --&gt; Материалы</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Материалы" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>9</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ПеремещениеТоваров</Код>
				<Наименование>ДокументСсылка.ПеремещениеМатериалов --&gt; ДокументСсылка.ПеремещениеТоваров</Наименование>
				<Порядок>800</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен;</ПередВыгрузкой>
				<ПослеЗагрузки>//Для Каждого Строка из Объект.Товары Цикл
//	СчетаУчета = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаУчетаНоменклатуры(Объект.Организация, Строка.Номенклатура, Объект.СкладОтправитель);
//	Строка.СчетУчета = СчетаУчета.СчетУчета;
//	СчетаУчета = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаУчетаНоменклатуры(Объект.Организация, Строка.Номенклатура, Объект.СкладПолучатель);
//	Строка.НовыйСчетУчета = СчетаУчета.СчетУчета;
//КонецЦикла;
Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ПеремещениеМатериалов</Источник>
				<Приемник>ДокументСсылка.ПеремещениеТоваров</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>5</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>СкладОтправитель --&gt; СкладОтправитель</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="СкладОтправитель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="СкладОтправитель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>СкладПолучатель --&gt; СкладПолучатель</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="СкладПолучатель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="СкладПолучатель" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Перемещение товаров №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>8</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>12</Код>
							<Наименование>ЕдиницаИзмерения --&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.ЕдиницыИзмерения"/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.ЕдиницаИзмерения.ЕдиницаПоКлассификатору;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ПоступлениеТоваровУслуг</Код>
				<Наименование>ДокументСсылка.ПоступлениеТоваровУслуг --&gt; ДокументСсылка.ПоступлениеТоваровУслуг</Наименование>
				<Порядок>850</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен;</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.ВидОперации = Перечисления.ВидыОперацийПоступлениеТоваровУслуг.ПокупкаКомиссия;
Объект.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.КурсВзаиморасчетов = 1;
Объект.КратностьВзаиморасчетов = 1;
Объект.СпособЗачетаАвансов = Перечисления.СпособыЗачетаАвансов.Автоматически;

ИмяНастройки = "битСуммаВключаетНДС";
ЗначениеНастройки = "";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СуммаВключаетНДС = ЗначениеНастройки;

// Договор контрагента
Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);

// НДС
// Определяем, ведется ли предъявление НДС или применением УСД Доходы.
ПрименениеУСНДоходы = УчетнаяПолитика.ПрименяетсяУСНДоходы(Объект.Организация, Объект.Дата);
СтавкаБезНДС = ПрименениеУСНДоходы;

Для Каждого Строка из Объект.Товары Цикл
	// НДС
	Если СтавкаБезНДС Тогда
		Строка.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
	Иначе
		Строка.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(Строка.Номенклатура.ВидСтавкиНДС, Объект.Дата);
	КонецЕсли;
	ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(Строка, Объект.СуммаВключаетНДС);
КонецЦикла;      
Для Каждого Строка из Объект.Услуги Цикл
	// НДС
	Если СтавкаБезНДС Тогда
		Строка.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
	Иначе
		Строка.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(Строка.Номенклатура.ВидСтавкиНДС, Объект.Дата);
	КонецЕсли;
	ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(Строка, Объект.СуммаВключаетНДС);
КонецЦикла;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ПоступлениеТоваровУслуг</Источник>
				<Приемник>ДокументСсылка.ПоступлениеТоваровУслуг</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>25</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Контрагент --&gt; Контрагент</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>23</Код>
						<Наименование>ДатаВходящегоДокумента --&gt; ДатаВходящегоДокумента</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
						<Приемник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>24</Код>
						<Наименование>НомерВходящегоДокумента --&gt; НомерВходящегоДокумента</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Поступление №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>9</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>14</Код>
							<Наименование>ЕдиницаИзмерения --&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.ЕдиницыИзмерения"/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.ЕдиницаИзмерения.ЕдиницаПоКлассификатору;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>13</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>12</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>11</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>15</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Если ОбъектКоллекции.Количество = 0 Тогда

	Значение = ОбъектКоллекции.Цена;		

Иначе

	Значение = ОбъектКоллекции.Сумма / ОбъектКоллекции.Количество;
	Если ОбъектКоллекции.Коэффициент &lt;&gt; 0 Тогда
		Значение = Значение / ОбъектКоллекции.Коэффициент;
	КонецЕсли;

КонецЕсли;</ПередВыгрузкой>
						</Свойство>
					</Группа>
					<Группа>
						<Код>17</Код>
						<Наименование>Услуги --&gt; Услуги</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="Услуги" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Услуги" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>18</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>19</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>20</Код>
							<Наименование>Содержание --&gt; Содержание</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Содержание" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="Содержание" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>21</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>22</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ВозвратТоваровПоставщику</Код>
				<Наименование>Документ: Возврат товаров поставщику</Наименование>
				<Порядок>900</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен;</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.ВидОперации = Перечисления.ВидыОперацийВозвратТоваровПоставщику.ПокупкаКомиссия;
Объект.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.КурсВзаиморасчетов = 1;
Объект.КратностьВзаиморасчетов = 1;

ИмяНастройки = "битСуммаВключаетНДС";
ЗначениеНастройки = "";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СуммаВключаетНДС = ЗначениеНастройки;

// Договор контрагента
Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);

// НДС
// Определяем, ведется ли по договору с поставщиком предъявление НДС или применением УСД Доходы.
ПрименениеУСНДоходы = УчетнаяПолитика.ПрименяетсяУСНДоходы(Объект.Организация, Объект.Дата);
СтавкаБезНДС = ПрименениеУСНДоходы;

Для Каждого Строка из Объект.Товары Цикл
	// НДС
	Если СтавкаБезНДС Тогда
		Строка.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
	Иначе
		Строка.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(Строка.Номенклатура.ВидСтавкиНДС, Объект.Дата);
	КонецЕсли;
	ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(Строка, Объект.СуммаВключаетНДС);
КонецЦикла;      

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ВозвратТоваровПоставщику</Источник>
				<Приемник>ДокументСсылка.ВозвратТоваровПоставщику</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Контрагент --&gt; Контрагент</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Возврат поставщику №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>10</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>11</Код>
							<Наименование>ЕдиницаИзмерения --&gt; ЕдиницаИзмерения</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.ЕдиницыИзмерения"/>
							<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.ЕдиницаИзмерения.ЕдиницаПоКлассификатору;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>12</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>13</Код>
							<Наименование>Коэффициент --&gt; Коэффициент</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Коэффициент" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>14</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>15</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>16</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Если ОбъектКоллекции.Количество = 0 Тогда

	Значение = ОбъектКоллекции.Цена;		

Иначе

	Значение = ОбъектКоллекции.Сумма / ОбъектКоллекции.Количество;
	Если ОбъектКоллекции.Коэффициент &lt;&gt; 0 Тогда
		Значение = Значение / ОбъектКоллекции.Коэффициент;
	КонецЕсли;

КонецЕсли;</ПередВыгрузкой>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>АвансовыйОтчет</Код>
				<Наименование>Документ: Авансовый отчет</Наименование>
				<Порядок>950</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен;</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.ВидОперации = Перечисления.ВидыОперацийАвансовыйОтчет.ПокупкаОплатаПрочее;

Объект.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.КурсДокумента = 1;
Объект.КратностьДокумента = 1;

ИмяНастройки = "битСуммаВключаетНДС";
ЗначениеНастройки = "";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СуммаВключаетНДС = ЗначениеНастройки;

ПлательщикНДС        = УчетнаяПолитика.ПлательщикНДС(Объект.Организация,        Объект.Дата);
ПрименяетсяУСН       = УчетнаяПолитика.ПрименяетсяУСН(Объект.Организация,       Объект.Дата);
ПрименяетсяУСНДоходы = УчетнаяПолитика.ПрименяетсяУСНДоходы(Объект.Организация, Объект.Дата);
ПлательщикНДФЛ       = УчетнаяПолитика.ПлательщикНДФЛ(Объект.Организация,       Объект.Дата);

ПодразделениеПоУмолчанию = БухгалтерскийУчетПереопределяемый.ПолучитьЗначениеПоУмолчанию("ОсновноеПодразделениеОрганизации");
Если БухгалтерскийУчетПереопределяемый.ПодразделениеПринадлежитОрганизации(ПодразделениеПоУмолчанию, Объект.Организация) Тогда
	Объект.ПодразделениеОрганизации = ПодразделениеПоУмолчанию;
КонецЕсли;

Для каждого СтрокаТаблицы Из Объект.Прочее Цикл
	СтрокаТаблицы.ПодразделениеЗатрат = БухгалтерскийУчет.ПолучитьПодразделениеПоСчету(
		СтрокаТаблицы.ПодразделениеЗатрат, СтрокаТаблицы.СчетЗатрат, Объект.Организация, Объект.ПодразделениеОрганизации);
КонецЦикла;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();

Для Каждого СтрокаТаблицыТЧ Из Объект.ОплатаПоставщикам Цикл
	ДанныеСтрокиТабличнойЧасти = Новый Структура(
	"Контрагент, ДоговорКонтрагента, КурсВзаиморасчетов, КратностьВзаиморасчетов, Сделка,
	|СпособПогашенияЗадолженности, СчетУчетаРасчетовСКонтрагентом, СчетУчетаРасчетовПоАвансам,
	|Сумма, СуммаВзаиморасчетов, Организация, Дата, ВалютаДокумента, КурсДокумента, КратностьДокумента,
	|ДоговорКонтрагентаВалютаВзаиморасчетов");
	ЗаполнитьЗначенияСвойств(ДанныеСтрокиТабличнойЧасти, Объект);
	ЗаполнитьЗначенияСвойств(ДанныеСтрокиТабличнойЧасти, СтрокаТаблицыТЧ);
	
	СтрокаТаблицы = ДанныеСтрокиТабличнойЧасти;
	
	МассивДоговоров = Новый Массив;
	// Список видов договоров - Метаданные.Документы.АвансовыйОтчет.ТабличныеЧасти.ОплатаПоставщикам.Реквизиты.ДоговорКонтрагента.ПараметрыВыбора[0].Значение
	МассивВидовДоговоров = Метаданные.Документы.АвансовыйОтчет.ТабличныеЧасти.ОплатаПоставщикам.Реквизиты.ДоговорКонтрагента.ПараметрыВыбора[0].Значение;
	Для каждого ЗначениеОтбора Из МассивВидовДоговоров Цикл
		МассивДоговоров.Добавить(ЗначениеОтбора);
	КонецЦикла;
	
	РаботаСДоговорамиКонтрагентовБП.УстановитьДоговорКонтрагента(СтрокаТаблицы.ДоговорКонтрагента,
		СтрокаТаблицы.Контрагент, СтрокаТаблицы.Организация, МассивДоговоров);
	
	Если ЗначениеЗаполнено(СтрокаТаблицы.ДоговорКонтрагента) Тогда
		РеквизитыДоговораКонтрагента = ОбщегоНазначения.ЗначенияРеквизитовОбъекта(
			СтрокаТаблицы.ДоговорКонтрагента, "Владелец, ВалютаВзаиморасчетов, РасчетыВУсловныхЕдиницах");
		Если ЗначениеЗаполнено(СтрокаТаблицы.ДоговорКонтрагента) И НЕ ЗначениеЗаполнено(СтрокаТаблицы.Контрагент) Тогда
			СтрокаТаблицы.Контрагент = РеквизитыДоговораКонтрагента.Владелец;
		КонецЕсли;
		
		Если ЗначениеЗаполнено(СтрокаТаблицы.ДоговорКонтрагента) Тогда
			СтруктураКурсаВзаиморасчетов = РаботаСКурсамиВалют.ПолучитьКурсВалюты(РеквизитыДоговораКонтрагента.ВалютаВзаиморасчетов, СтрокаТаблицы.Дата);
			СтрокаТаблицы.КурсВзаиморасчетов      = СтруктураКурсаВзаиморасчетов.Курс;
			СтрокаТаблицы.КратностьВзаиморасчетов = СтруктураКурсаВзаиморасчетов.Кратность;
		Иначе
			СтрокаТаблицы.КурсВзаиморасчетов      = 1;
			СтрокаТаблицы.КратностьВзаиморасчетов = 1;
		КонецЕсли;
		
		ВалютаВзаиморасчетов = РеквизитыДоговораКонтрагента.ВалютаВзаиморасчетов;
		
		СтрокаТаблицы.СуммаВзаиморасчетов = СтрокаТаблицы.Сумма;
		// При необходимости см. РаботаСКурсамиВалютКлиентСервер.ПересчитатьПоКурсу()
		//СтрокаТаблицы.СуммаВзаиморасчетов = РаботаСКурсамиВалютКлиентСервер.ПересчитатьИзВалютыВВалюту(
		//	СтрокаТаблицы.Сумма, СтрокаТаблицы.ВалютаДокумента, ВалютаВзаиморасчетов,
		//	СтрокаТаблицы.КурсДокумента, СтрокаТаблицы.КурсВзаиморасчетов,
		//	СтрокаТаблицы.КратностьДокумента, СтрокаТаблицы.КратностьВзаиморасчетов);
		
		//СчетаУчета = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаРасчетовСКонтрагентом(
		//	СтрокаТаблицы.Организация, СтрокаТаблицы.Контрагент, СтрокаТаблицы.ДоговорКонтрагента);
		//
		//СтрокаТаблицы.СпособПогашенияЗадолженности = Перечисления.СпособыПогашенияЗадолженности.Автоматически;
		//СтрокаТаблицы.СчетУчетаРасчетовПоАвансам   = СчетаУчета.СчетАвансов;
		
		ВидДоговора = ОбщегоНазначения.ЗначениеРеквизитаОбъекта(СтрокаТаблицы.ДоговорКонтрагента, "ВидДоговора");
		//Если ВидДоговора = Перечисления.ВидыДоговоровКонтрагентов.СКомитентом
		//	ИЛИ ВидДоговора = Перечисления.ВидыДоговоровКонтрагентов.СКомитентомНаЗакупку Тогда
		//	СтрокаТаблицы.СчетУчетаРасчетовСКонтрагентом = СчетаУчета.СчетРасчетовСКомитентом;
		//Иначе
		//	СтрокаТаблицы.СчетУчетаРасчетовСКонтрагентом = СчетаУчета.СчетРасчетов;
		//КонецЕсли;
		
		СтрокаТаблицы.Сделка = Неопределено;
	КонецЕсли;
	
	ЗаполнитьЗначенияСвойств(СтрокаТаблицыТЧ, ДанныеСтрокиТабличнойЧасти);
КонецЦикла;

Объект.НДСВключенВСтоимость = НЕ ПлательщикНДС;

//Документы.АвансовыйОтчет.ЗаполнитьСчетаУчетаВТабличнойЧасти(Объект, "Товары");

Для каждого СтрокаТабличнойЧасти Из Объект.Товары Цикл

	ДанныеОбъекта = Новый Структура(
		"Дата, Организация, Склад, ТипЦен, СуммаВключаетНДС,
		|ВалютаДокумента, КурсДокумента, КратностьДокумента");
	ЗаполнитьЗначенияСвойств(ДанныеОбъекта, Объект);
	
	СведенияОНоменклатуре = БухгалтерскийУчетПереопределяемый.ПолучитьСведенияОНоменклатуре(
		СтрокаТабличнойЧасти.Номенклатура, ДанныеОбъекта);
	Если СведенияОНоменклатуре = Неопределено Тогда
		Продолжить;
	КонецЕсли;
	
	СтрокаТабличнойЧасти.СтавкаНДС           = СведенияОНоменклатуре.СтавкаНДС;
	СтрокаТабличнойЧасти.НомерГТД            = СведенияОНоменклатуре.НомерГТД;
	СтрокаТабличнойЧасти.СтранаПроисхождения = СведенияОНоменклатуре.СтранаПроисхождения;
	
	ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(СтрокаТабличнойЧасти, ДанныеОбъекта.СуммаВключаетНДС);
	
	//Документы.АвансовыйОтчет.ЗаполнитьСчетаУчетаВСтрокеТабличнойЧасти(Объект, СтрокаТабличнойЧасти, "Товары", СведенияОНоменклатуре);
	
КонецЦикла;

// Заполнение НДС и прочего в т.ч. "ПРОЧЕЕ"
Для каждого СтрокаТабличнойЧасти Из Объект.Прочее Цикл
	
	ДанныеОбъекта = Новый Структура(
		"Дата, Организация, Склад, СуммаВключаетНДС");
	ЗаполнитьЗначенияСвойств(ДанныеОбъекта, Объект);
	
	СведенияОНоменклатуре = БухгалтерскийУчетПереопределяемый.ПолучитьСведенияОНоменклатуре(
		СтрокаТабличнойЧасти.Номенклатура, ДанныеОбъекта);
		
	Если СведенияОНоменклатуре &lt;&gt; Неопределено Тогда
			
		СтрокаТабличнойЧасти.Содержание = СведенияОНоменклатуре.НаименованиеПолное;
		СтрокаТабличнойЧасти.СтавкаНДС  = СведенияОНоменклатуре.СтавкаНДС;
			
		//Документы.АвансовыйОтчет.ЗаполнитьСчетаУчетаВСтрокеТабличнойЧасти(Объект, СтрокаТабличнойЧасти, "Прочее", СведенияОНоменклатуре);
			
	КонецЕсли;
	
	ПоляОбъекта = Новый Структура("Субконто1, Субконто2, Субконто3", "Субконто1", "Субконто2", "Субконто3");
	ПоляОбъекта.Вставить("Подразделение", "ПодразделениеЗатрат");
	ПоляОбъекта.Вставить("Организация"  , Объект.Организация);

	ЭтоТаблица = Истина;
	Если ПоляОбъекта.Свойство("Подразделение") Тогда
		ДанныеСчета = БухгалтерскийУчетВызовСервераПовтИсп.ПолучитьСвойстваСчета(СтрокаТабличнойЧасти.СчетЗатрат);
		Если ДанныеСчета.УчетПоПодразделениям Тогда
			ПодразделениеПоУмолчанию = Неопределено;
			ПоляОбъекта.Свойство("ПодразделениеПоУмолчанию", ПодразделениеПоУмолчанию);
			НовоеПодразделение = ОбщегоНазначенияБПВызовСервераПовтИсп.ПолучитьПодразделениеПриИзмененииСчета(
				СтрокаТабличнойЧасти[ПоляОбъекта.Подразделение],
				ПоляОбъекта.Организация,
				ПодразделениеПоУмолчанию);
			
			Если НовоеПодразделение &lt;&gt; СтрокаТабличнойЧасти[ПоляОбъекта.Подразделение] Тогда
				СтрокаТабличнойЧасти[ПоляОбъекта.Подразделение] = НовоеПодразделение;
			КонецЕсли;
		Иначе
			СтрокаТабличнойЧасти[ПоляОбъекта.Подразделение] = Неопределено;
		КонецЕсли;
	КонецЕсли;
	
КонецЦикла;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.АвансовыйОтчет</Источник>
				<Приемник>ДокументСсылка.АвансовыйОтчет</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>36</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>КоличествоДокументов --&gt; КоличествоДокументов</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="КоличествоДокументов" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КоличествоДокументов" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>КоличествоЛистов --&gt; КоличествоЛистов</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="КоличествоЛистов" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КоличествоЛистов" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>НазначениеАванса --&gt; НазначениеАванса</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="НазначениеАванса" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НазначениеАванса" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>Склад --&gt; Склад</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Склад" Вид="Реквизит" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>35</Код>
						<Наименование>Сотрудник --&gt; ФизЛицо</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Сотрудник" Вид="Реквизит" Тип="СправочникСсылка.Сотрудники"/>
						<Приемник Имя="ФизЛицо" Вид="Реквизит" Тип="СправочникСсылка.ФизическиеЛица"/>
						<КодПравилаКонвертации>ФизическиеЛица                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Авансовый отчет №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Группа Отключить="true">
						<Код>12</Код>
						<Наименование>ВыданныеАвансы --&gt; ВыданныеАвансы</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="ВыданныеАвансы" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="ВыданныеАвансы" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>13</Код>
							<Наименование>ДокументАванса --&gt; ДокументАванса</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ДокументАванса" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="ДокументАванса" Вид="Реквизит"/>
						</Свойство>
					</Группа>
					<Группа>
						<Код>14</Код>
						<Наименование>ОплатаПоставщикам --&gt; ОплатаПоставщикам</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="ОплатаПоставщикам" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="ОплатаПоставщикам" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>15</Код>
							<Наименование>ВидДокВходящий --&gt; ВидДокВходящий</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ВидДокВходящий" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="ВидДокВходящий" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>16</Код>
							<Наименование>ДатаВходящегоДокумента --&gt; ДатаВходящегоДокумента</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
							<Приемник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
						</Свойство>
						<Свойство>
							<Код>17</Код>
							<Наименование>Контрагент --&gt; Контрагент</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>18</Код>
							<Наименование>НомерВходящегоДокумента --&gt; НомерВходящегоДокумента</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>19</Код>
							<Наименование>Содержание --&gt; Содержание</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Содержание" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="Содержание" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>20</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
					<Группа>
						<Код>21</Код>
						<Наименование>Прочее --&gt; Прочее</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="Прочее" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Прочее" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>22</Код>
							<Наименование>ВидДокВходящий --&gt; ВидДокВходящий</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="ВидДокВходящий" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="ВидДокВходящий" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>23</Код>
							<Наименование>ДатаВходящегоДокумента --&gt; ДатаВходящегоДокумента</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
							<Приемник Имя="ДатаВходящегоДокумента" Вид="Реквизит" Тип="Дата"/>
						</Свойство>
						<Свойство>
							<Код>24</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>25</Код>
							<Наименование>НомерВходящегоДокумента --&gt; НомерВходящегоДокумента</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="НомерВходящегоДокумента" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>26</Код>
							<Наименование>Поставщик --&gt; Поставщик</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Поставщик" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<Приемник Имя="Поставщик" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>27</Код>
							<Наименование>Содержание --&gt; Содержание</Наименование>
							<Порядок>300</Порядок>
							<Источник Имя="Содержание" Вид="Реквизит" Тип="Строка"/>
							<Приемник Имя="Содержание" Вид="Реквизит" Тип="Строка"/>
						</Свойство>
						<Свойство>
							<Код>28</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>350</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
					<Группа>
						<Код>29</Код>
						<Наименование>Товары --&gt; Товары</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Товары" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>30</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Значение = ОбъектКоллекции.Количество * ОбъектКоллекции.Коэффициент;</ПередВыгрузкой>
						</Свойство>
						<Свойство>
							<Код>31</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>32</Код>
							<Наименование>Поставщик --&gt; Поставщик</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Поставщик" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<Приемник Имя="Поставщик" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
							<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>33</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>34</Код>
							<Наименование>Цена --&gt; Цена</Наименование>
							<Порядок>250</Порядок>
							<Источник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Цена" Вид="Реквизит" Тип="Число"/>
							<ПередВыгрузкой>Если ОбъектКоллекции.Количество = 0 Тогда

	Значение = ОбъектКоллекции.Цена;		

Иначе

	Значение = ОбъектКоллекции.Сумма / ОбъектКоллекции.Количество;
	Если ОбъектКоллекции.Коэффициент &lt;&gt; 0 Тогда
		Значение = Значение / ОбъектКоллекции.Коэффициент;
	КонецЕсли;

КонецЕсли;</ПередВыгрузкой>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ПриходныйКассовыйОрдер</Код>
				<Наименование>ДокументСсылка.ПриходныйКассовыйОрдер --&gt; ДокументСсылка.ПриходныйКассовыйОрдер</Наименование>
				<Порядок>1000</Порядок>
				<ПередВыгрузкой>Отказ = НЕ Источник.Проведен;</ПередВыгрузкой>
				<ПослеЗагрузки>
Объект.СчетКасса = ПланыСчетов.Хозрасчетный.КассаОрганизации;
Объект.ВалютаДокумента         = Константы.ВалютаРегламентированногоУчета.Получить();

мПрименениеУСН = УчетнаяПолитика.ПрименяетсяУСН(Объект.Организация, Объект.Дата);

ЗначениеНастройки = "";
ИмяНастройки = "битОсновнаяСтавкаНДС";
Выполнить(Алгоритмы.ПолучитьНастройку);
ОсновнаяСтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(ЗначениеНастройки, Объект.Дата);
// НДС и контрагент клиента, если надо.
Если Объект.ВидОперации = Перечисления.ВидыОперацийПКО.ОплатаПокупателя Тогда
	Если Не ЗначениеЗаполнено(Объект.Контрагент) Тогда
		ИмяНастройки = "битКонтрагентКлиент";
		Выполнить(Алгоритмы.ПолучитьНастройку);
		Объект.Контрагент = ЗначениеНастройки;
		Если мПрименениеУСН Тогда
			Объект.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
		Иначе
			Объект.СтавкаНДС = ОсновнаяСтавкаНДС;
		КонецЕсли;
	Иначе
		Объект.СтавкаНДС = ОсновнаяСтавкаНДС;
	КонецЕсли;
ИначеЕсли Объект.ВидОперации = Перечисления.ВидыОперацийПКО.ВозвратОтПоставщика Тогда
	Объект.СтавкаНДС = ОсновнаяСтавкаНДС;
Иначе
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
КонецЕсли;

Если ТипЗнч(Объект.Контрагент) = Тип("СправочникСсылка.Контрагенты") И 
	 Не ЗначениеЗаполнено(Объект.ДоговорКонтрагента) и 
	 ЗначениеЗаполнено(Объект.Контрагент)
Тогда
	Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);
КонецЕсли;

// Подстановка счета учета прочего прихода
Если Объект.ВидОперации = Перечисления.ВидыОперацийПКО.ПрочийПриход И
	 Не ЗначениеЗаполнено(Объект.СчетУчетаРасчетовСКонтрагентом) 
Тогда
	ИмяНастройки = "битСчетУчетаПрочегоПриходаПКО";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.СчетУчетаРасчетовСКонтрагентом = ЗначениеНастройки;
Конецесли;

Если Объект.РасшифровкаПлатежа.Количество()=0 Тогда
	СтрокаПлатеж = Объект.РасшифровкаПлатежа.Добавить()
Иначе
	СтрокаПлатеж = Объект.РасшифровкаПлатежа[0];
КонецЕсли;

СтрокаПлатеж.СпособПогашенияЗадолженности = Перечисления.СпособыПогашенияЗадолженности.Автоматически;
СтрокаПлатеж.ДоговорКонтрагента      = Объект.ДоговорКонтрагента;
СтрокаПлатеж.СуммаПлатежа            = Объект.СуммаДокумента;
СтрокаПлатеж.КурсВзаиморасчетов      = 1;
СтрокаПлатеж.КратностьВзаиморасчетов = 1;
СтрокаПлатеж.СуммаВзаиморасчетов     = Объект.СуммаДокумента;
СтрокаПлатеж.СтавкаНДС               = Объект.СтавкаНДС;
СтрокаПлатеж.СтатьяДвиженияДенежныхСредств = Объект.СтатьяДвиженияДенежныхСредств;

ЗначениеСтавкиНДС     = УчетНДСВызовСервераПовтИсп.ПолучитьСтавкуНДС(СтрокаПлатеж.СтавкаНДС);
СтрокаПлатеж.СуммаНДС = СтрокаПлатеж.СуммаПлатежа * ЗначениеСтавкиНДС / (100 + ЗначениеСтавкиНДС);

//СчетаУчета = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаРасчетовСКонтрагентом(Объект.Организация, Объект.Контрагент, СтрокаПлатеж.ДоговорКонтрагента);

//Если Объект.ВидОперации = Перечисления.ВидыОперацийПКО.ВозвратОтПоставщика тогда
//	СтрокаПлатеж.СчетУчетаРасчетовСКонтрагентом    = СчетаУчета.СчетРасчетов;
//	СтрокаПлатеж.СчетУчетаРасчетовПоАвансам        = СчетаУчета.СчетАвансов;
//Иначе
//	СтрокаПлатеж.СчетУчетаРасчетовСКонтрагентом    = СчетаУчета.СчетРасчетовПокупателя;
//	СтрокаПлатеж.СчетУчетаРасчетовПоАвансам        = СчетаУчета.СчетАвансовПокупателя;
//КонецЕсли;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ПриходныйКассовыйОрдер</Источник>
				<Приемник>ДокументСсылка.ПриходныйКассовыйОрдер</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>ВидОперации --&gt; ВидОперации</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийПКО"/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийПКО"/>
						<КодПравилаКонвертации>ВидыОперацийПКО                                   </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>3</Код>
						<Наименование>ДокументОснование --&gt; ДокументОснование</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ДокументОснование" Вид="Реквизит"/>
						<Приемник Имя="ДокументОснование" Вид="Реквизит"/>
						<ПередВыгрузкой>Если ТипЗНЧ(Источник.ДокументОснование) = Тип("ДокументСсылка.ОказаниеУслуг") Тогда
	
	Отказ = Истина;
	
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " ПКО №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Свойство Отключить="true" Поиск="true">
						<Код>5</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>НомерЧекаККМ --&gt; НомерЧекаККМ</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="НомерЧекаККМ" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="НомерЧекаККМ" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>Основание --&gt; Основание</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>Приложение --&gt; Приложение</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="Приложение" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Приложение" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>ПринятоОт --&gt; ПринятоОт</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="ПринятоОт" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ПринятоОт" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>12</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>ВидОперации --&gt; ВидОперации</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийПКО"/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийПКО"/>
						<КодПравилаКонвертации>ВидыОперацийПКО                                   </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>15</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>800</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит"/>
						<Приемник Имя="Контрагент" Вид="Реквизит"/>
						<ПриВыгрузке>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	Если ТипЗнч(Значение) &lt;&gt; Тип("СправочникСсылка.Контрагенты") Тогда
		Значение = Справочники.Контрагенты.ПустаяССылка();
	КонецЕсли;
КонецЕсли;</ПриВыгрузке>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>СтатьяДвиженияДенежныхСредств --&gt; СтатьяДвиженияДенежныхСредств</Наименование>
						<Порядок>850</Порядок>
						<Источник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<Приемник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<КодПравилаКонвертации>СтатьиДвиженияДенежныхСредств                     </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РасходныйКассовыйОрдер</Код>
				<Наименование>ДокументСсылка.ПриходныйКассовыйОрдер --&gt; ДокументСсылка.ПриходныйКассовыйОрдер</Наименование>
				<Порядок>1050</Порядок>
				<ПередВыгрузкой>Отказ = НЕ Источник.Проведен;
Если Источник.ВидОперации = Перечисления.ВидыОперацийРКО.ПеремещениеВКассу Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкой>
				<ПослеЗагрузки>
Объект.СчетКасса = ПланыСчетов.Хозрасчетный.КассаОрганизации;
Объект.ВалютаДокумента         = Константы.ВалютаРегламентированногоУчета.Получить();

мПрименениеУСН = УчетнаяПолитика.ПрименяетсяУСН(Объект.Организация, Объект.Дата);

// НДС контрагент, , если надо.
мЕстьКонтрагент = (Объект.ВидОперации = Перечисления.ВидыОперацийРКО.ОплатаПоставщику ИЛИ
				   Объект.ВидОперации = Перечисления.ВидыОперацийРКО.ВозвратПокупателю);
				   
ЗначениеНастройки = "";
ИмяНастройки = "битОсновнаяСтавкаНДС";
Выполнить(Алгоритмы.ПолучитьНастройку);
ОсновнаяСтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(ЗначениеНастройки, Объект.Дата);				   
Если мЕстьКонтрагент Тогда
	Если Не ЗначениеЗаполнено(Объект.Контрагент) Тогда
		ИмяНастройки = "битКонтрагентКлиент";
		Выполнить(Алгоритмы.ПолучитьНастройку);
		Объект.Контрагент = ЗначениеНастройки;
		Если мПрименениеУСН Тогда
			Объект.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
		Иначе
			Объект.СтавкаНДС = ОсновнаяСтавкаНДС;
		КонецЕсли;
	Иначе
		Объект.СтавкаНДС = ОсновнаяСтавкаНДС;
	КонецЕсли;
Иначе
	Объект.СтавкаНДС = Перечисления.СтавкиНДС.БезНДС;
КонецЕсли;

Если мЕстьКонтрагент И 
	 Не ЗначениеЗаполнено(Объект.ДоговорКонтрагента) И
	 ЗначениеЗаполнено(Объект.Контрагент)
Тогда
	Объект.ДоговорКонтрагента = РаботаСДоговорамиКонтрагентовБП.ДоговорКонтрагентаИзОбъекта(Объект);
КонецЕсли;

// Подстановка счета учета прочего расхода
Если Объект.ВидОперации = Перечисления.ВидыОперацийРКО.ПрочийРасход И
	 Не ЗначениеЗаполнено(Объект.СчетУчетаРасчетовСКонтрагентом) 
Тогда
	ИмяНастройки = "битСчетУчетаПрочегоРасходаРКО";
	Выполнить(Алгоритмы.ПолучитьНастройку);
	Объект.СчетУчетаРасчетовСКонтрагентом = ЗначениеНастройки;
Конецесли;

// Подстановка счета учета инкассации
Если Объект.ВидОперации = Перечисления.ВидыОперацийРКО.Инкассация И
	 Не ЗначениеЗаполнено(Объект.СчетУчетаРасчетовСКонтрагентом) 
Тогда
	Объект.СчетУчетаРасчетовСКонтрагентом=ПланыСчетов.Хозрасчетный.ПереводыВПути_;
Конецесли;

Если Объект.РасшифровкаПлатежа.Количество()=0 Тогда
	СтрокаПлатеж = Объект.РасшифровкаПлатежа.Добавить();
Иначе
	СтрокаПлатеж = Объект.РасшифровкаПлатежа[0];
КонецЕсли;

СтрокаПлатеж.СпособПогашенияЗадолженности = Перечисления.СпособыПогашенияЗадолженности.Автоматически;
СтрокаПлатеж.ДоговорКонтрагента      = Объект.ДоговорКонтрагента;
СтрокаПлатеж.СуммаПлатежа            = Объект.СуммаДокумента;
СтрокаПлатеж.КурсВзаиморасчетов      = 1;
СтрокаПлатеж.КратностьВзаиморасчетов = 1;
СтрокаПлатеж.СуммаВзаиморасчетов     = Объект.СуммаДокумента;
СтрокаПлатеж.СтавкаНДС               = Объект.СтавкаНДС;
СтрокаПлатеж.СтатьяДвиженияДенежныхСредств = Объект.СтатьяДвиженияДенежныхСредств;

ЗначениеСтавкиНДС     = УчетНДСВызовСервераПовтИсп.ПолучитьСтавкуНДС(СтрокаПлатеж.СтавкаНДС);
СтрокаПлатеж.СуммаНДС = СтрокаПлатеж.СуммаПлатежа * ЗначениеСтавкиНДС / (100 + ЗначениеСтавкиНДС);

//Если мЕстьКонтрагент Тогда
//	
//	СчетаУчета = БухгалтерскийУчетПереопределяемый.ПолучитьСчетаРасчетовСКонтрагентом(Объект.Организация, Объект.Контрагент, СтрокаПлатеж.ДоговорКонтрагента);
//	
//	//	
//	Если Объект.ВидОперации = Перечисления.ВидыОперацийРКО.ВозвратПокупателю тогда
//		
//		СтрокаПлатеж.СчетУчетаРасчетовСКонтрагентом    = СчетаУчета.СчетРасчетовПокупателя;
//		СтрокаПлатеж.СчетУчетаРасчетовПоАвансам        = СчетаУчета.СчетАвансовПокупателя;
//		
//	Иначе
//		
//		СтрокаПлатеж.СчетУчетаРасчетовСКонтрагентом	   = СчетаУчета.СчетРасчетов;
//		СтрокаПлатеж.СчетУчетаРасчетовПоАвансам        = СчетаУчета.СчетАвансов;
//		
//	КонецЕсли;
//	
//КонецЕсли;

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.РасходныйКассовыйОрдер</Источник>
				<Приемник>ДокументСсылка.РасходныйКассовыйОрдер</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>ВидОперации --&gt; ВидОперации</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийРКО"/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийРКО"/>
						<КодПравилаКонвертации>ВидыОперацийРКО                                   </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Выдать --&gt; Выдать</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Выдать" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Выдать" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>18</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ДокументОснование --&gt; ДокументОснование</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ДокументОснование" Вид="Реквизит"/>
						<Приемник Имя="ДокументОснование" Вид="Реквизит"/>
						<ПередВыгрузкой>Если ТипЗНЧ(Источник.ДокументОснование) = Тип("ДокументСсылка.ОказаниеУслуг") Тогда
	
	Отказ = Истина;
	
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " РКО №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'") + " " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>Контрагент --&gt; Контрагент</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Контрагент" Вид="Реквизит"/>
						<Приемник Имя="Контрагент" Вид="Реквизит"/>
						<ПриВыгрузке>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	Если ТипЗнч(Значение) &lt;&gt; Тип("СправочникСсылка.Контрагенты") Тогда
		Значение = Справочники.Контрагенты.ПустаяСсылка();
	КонецЕсли;
КонецЕсли;</ПриВыгрузке>
					</Свойство>
					<Свойство Отключить="true" Поиск="true">
						<Код>7</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>8</Код>
						<Наименование>НомерЧекаККМ --&gt; НомерЧекаККМ</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="НомерЧекаККМ" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="НомерЧекаККМ" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Основание --&gt; Основание</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Основание" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>ПоДокументу --&gt; ПоДокументу</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="ПоДокументу" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ПоДокументу" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>12</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>650</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>Приложение --&gt; Приложение</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="Приложение" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Приложение" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>14</Код>
						<Наименование>Проведен --&gt; Проведен</Наименование>
						<Порядок>750</Порядок>
						<Источник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="Проведен" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>СтатьяДвиженияДенежныхСредств --&gt; СтатьяДвиженияДенежныхСредств</Наименование>
						<Порядок>800</Порядок>
						<Источник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<Приемник Имя="СтатьяДвиженияДенежныхСредств" Вид="Реквизит" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<КодПравилаКонвертации>СтатьиДвиженияДенежныхСредств                     </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>850</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство>
						<Код>17</Код>
						<Наименование>ВидОперации --&gt; ВидОперации</Наименование>
						<Порядок>900</Порядок>
						<Источник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийРКО"/>
						<Приемник Имя="ВидОперации" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыОперацийРКО"/>
						<КодПравилаКонвертации>ВидыОперацийРКО                                   </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ЗарплатаКВыплатеОрганизаций</Код>
				<Наименование>Документ: Начисление зарплаты</Наименование>
				<Порядок>1100</Порядок>
				<ПередВыгрузкой>Отказ = НЕ Источник.Проведен;</ПередВыгрузкой>
				<ПослеЗагрузки>// Заполняем месяц начисления
Объект.ПериодРегистрации = НачалоМесяца(Объект.ПериодРегистрации);

Объект.СуммаДокумента = Объект.Зарплата.Итог("Сумма");</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.НачислениеЗарплаты</Источник>
				<Приемник>ДокументСсылка.ВедомостьНаВыплатуЗарплаты</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>16</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>КраткийСоставДокумента --&gt; КраткийСоставДокумента</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="КраткийСоставДокумента" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="КраткийСоставДокумента" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Отключить="true">
						<Код>3</Код>
						<Наименование>Номер --&gt; Номер</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Номер" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Номер" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>14</Код>
						<Наименование>НачалоПериода --&gt; ПериодРегистрации</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="НачалоПериода" Вид="Реквизит" Тип="Дата"/>
						<Приемник Имя="ПериодРегистрации" Вид="Реквизит" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>15</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + " Начисление зарплаты №"+СокрЛП(Источник.Номер) + " от " + Формат(Источник.Дата,"ДФ='dd.MM.yy'");</ПередВыгрузкой>
					</Свойство>
					<Группа>
						<Код>6</Код>
						<Наименование>Начисления --&gt; Зарплата</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Начисления" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Зарплата" Вид="ТабличнаяЧасть"/>
						<Свойство Отключить="true">
							<Код>7</Код>
							<Наименование>--&gt; ВыплаченностьЗарплаты</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="ВыплаченностьЗарплаты" Вид="Реквизит" Тип="ПеречислениеСсылка.ВыплаченностьЗарплаты"/>
						</Свойство>
						<Свойство Отключить="true">
							<Код>8</Код>
							<Наименование>--&gt; КомпенсацияЗаЗадержкуЗарплаты</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="" Вид=""/>
							<Приемник Имя="КомпенсацияЗаЗадержкуЗарплаты" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>10</Код>
							<Наименование>Результат --&gt; Сумма</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Результат" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>9</Код>
							<Наименование>Сотрудник --&gt; ФизическоеЛицо</Наименование>
							<Порядок>200</Порядок>
							<Источник Имя="Сотрудник" Вид="Реквизит" Тип="СправочникСсылка.Сотрудники"/>
							<Приемник Имя="ФизическоеЛицо" Вид="Реквизит" Тип="СправочникСсылка.ФизическиеЛица"/>
							<КодПравилаКонвертации>ФизическиеЛица                                    </КодПравилаКонвертации>
						</Свойство>
					</Группа>
					<Группа Отключить="true">
						<Код>11</Код>
						<Наименование>Удержания --&gt; Зарплата</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="Удержания" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Зарплата" Вид="ТабличнаяЧасть"/>
						<ПередОбработкойВыгрузки>НеОчищать = Истина;</ПередОбработкойВыгрузки>
						<Свойство>
							<Код>12</Код>
							<Наименование>Сотрудник --&gt; ФизическоеЛицо</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Сотрудник" Вид="Реквизит" Тип="СправочникСсылка.Сотрудники"/>
							<Приемник Имя="ФизическоеЛицо" Вид="Реквизит" Тип="СправочникСсылка.ФизическиеЛица"/>
							<КодПравилаКонвертации>ФизическиеЛица                                    </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>13</Код>
							<Наименование>Результат --&gt; Сумма</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Результат" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<ПриВыгрузке>Значение = 0 - Значение;</ПриВыгрузке>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>РеестрОказанныхУслуг</Код>
				<Наименование>Документ: Реестр оказанных услуг по соглашениям</Наименование>
				<Порядок>1150</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен;</ПередВыгрузкой>
				<ПослеЗагрузки>Объект.Организация = Объект.ДоговорКонтрагента.Организация;

Объект.ВидОперации = Перечисления.ВидыОперацийРеализацияТоваров.ПродажаКомиссия;
Объект.ВалютаДокумента = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.КурсВзаиморасчетов = 1;
Объект.КратностьВзаиморасчетов = 1;
Объект.СпособЗачетаАвансов = Перечисления.СпособыЗачетаАвансов.Автоматически;
ИмяНастройки = "битСуммаВключаетНДС";
ЗначениеНастройки = "";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.СуммаВключаетНДС = ЗначениеНастройки;

// Свертка табличных частей
ИмяТЧ = "Товары";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);
ИмяТЧ = "Услуги";
Выполнить(Алгоритмы.СверткаТаблицыПоКоличествуИСумме);


// Табличные части
Для Каждого Строка из Объект.Товары Цикл
	
	// НДС
	Строка.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(Строка.Номенклатура.ВидСтавкиНДС, Объект.Дата);
	ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(Строка, Объект.СуммаВключаетНДС);//, Объект);
	
	Если Строка.Количество &lt;&gt; 0 Тогда
		Строка.Цена = Строка.Сумма / Строка.Количество;
	КонецЕсли;
	
КонецЦикла;

Для Каждого Строка из Объект.Услуги Цикл
	
	// НДС
	Строка.СтавкаНДС = Перечисления.СтавкиНДС.СтавкаНДС(Строка.Номенклатура.ВидСтавкиНДС, Объект.Дата);
	ОбработкаТабличныхЧастейКлиентСервер.РассчитатьСуммуНДСТабЧасти(Строка, Объект.СуммаВключаетНДС);
	
	Если Строка.Количество &lt;&gt; 0 Тогда
		Строка.Цена = Строка.Сумма / Строка.Количество;
	КонецЕсли;
	
КонецЦикла;

СуммаДокумента = Объект.Товары.Итог("Сумма") + Объект.Услуги.Итог("Сумма");

Объект.ДополнительныеСвойства.Вставить("ЗаполнитьСчетаУчетаПередЗаписью", Истина);
Объект.Записать();</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>ДокументСсылка.РеестрОказанныхУслугПоСоглашениям</Источник>
				<Приемник>ДокументСсылка.РеализацияТоваровУслуг</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>8</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Филиал.Организация;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + ". Реестр оказанных услуг.";</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>Контрагент --&gt; Контрагент</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство Отключить="true">
						<Код>7</Код>
						<Наименование>Ответственный --&gt; Ответственный</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<Приемник Имя="Ответственный" Вид="Реквизит" Тип="СправочникСсылка.Пользователи"/>
						<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>Соглашение --&gt; ДоговорКонтрагента</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="Соглашение" Вид="Реквизит" Тип="СправочникСсылка.СоглашенияСтрахования"/>
						<Приемник Имя="ДоговорКонтрагента" Вид="Реквизит" Тип="СправочникСсылка.ДоговорыКонтрагентов"/>
						<КодПравилаКонвертации>ДоговорыКонтрагентов                              </КодПравилаКонвертации>
					</Свойство>
					<Группа>
						<Код>1</Код>
						<Наименование>Услуги --&gt; Услуги</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Услуги" Вид="ТабличнаяЧасть"/>
						<Приемник Имя="Услуги" Вид="ТабличнаяЧасть"/>
						<Свойство>
							<Код>2</Код>
							<Наименование>Количество --&gt; Количество</Наименование>
							<Порядок>50</Порядок>
							<Источник Имя="Количество" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Количество" Вид="Реквизит" Тип="Число"/>
						</Свойство>
						<Свойство>
							<Код>3</Код>
							<Наименование>Номенклатура --&gt; Номенклатура</Наименование>
							<Порядок>100</Порядок>
							<Источник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<Приемник Имя="Номенклатура" Вид="Реквизит" Тип="СправочникСсылка.Номенклатура"/>
							<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
						</Свойство>
						<Свойство>
							<Код>4</Код>
							<Наименование>Сумма --&gt; Сумма</Наименование>
							<Порядок>150</Порядок>
							<Источник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
							<Приемник Имя="Сумма" Вид="Реквизит" Тип="Число"/>
						</Свойство>
					</Группа>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ОплатаПлатежнойКартой</Код>
				<Наименование>Документ: Оплата платежной картой</Наименование>
				<Порядок>1200</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен</ПередВыгрузкой>
				<ПослеВыгрузки>ТЗОплата = Новый ТаблицаЗначений();

// Реквизиты, которые пойдут в шапку
ТЗОплата.Колонки.Добавить("СуммаДокумента");
ТЗОплата.Колонки.Добавить("Дата");
ТЗОплата.Колонки.Добавить("ЭквайринговыйТерминал");
ТЗОплата.Колонки.Добавить("Клиент");
ТЗОплата.Колонки.Добавить("Организация");

СтрОплата = ТЗОплата.Добавить();
Если ЗначениеЗаполнено(Источник.ЭквайринговыйТерминал) Тогда
	СтрОплата.Дата = КонецДня(Источник.Дата); 
	СтрОплата.СуммаДокумента = Источник.СуммаДокумента;
	СтрОплата.ЭквайринговыйТерминал = Источник.ЭквайринговыйТерминал;
	ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
	Если ДетализироватьКлиентов Тогда
		СтрОплата.Клиент = Источник.Клиент;
	КонецЕсли;
	СтрОплата.Организация = Источник.Филиал.Организация;
КонецЕсли;		

Если ПустаяСтрока(Параметры.ДокиПоБезналу) Тогда
	Параметры.ДокиПоБезналу = ЗначениеВСтрокуВнутр(ТЗОплата);
Иначе
	ТабДоки = ЗначениеИзСтрокиВнутр (Параметры.ДокиПоБезналу);
	Для Каждого СтрокаИсточник Из ТЗОплата Цикл
		ЗаполнитьЗначенияСвойств(ТабДоки.Добавить(),СтрокаИсточник);
	КонецЦикла;
	Параметры.ДокиПоБезналу = ЗначениеВСтрокуВнутр(ТабДоки);
КонецЕсли;

Отказ = Истина;</ПослеВыгрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ОплатаПлатежнойКартой</Источник>
				<Приемник>ДокументСсылка.ОплатаПлатежнойКартой</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + ". " + Строка(Источник) + ". " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>4</Код>
						<Наименование>ЭквайринговыйТерминал --&gt; ВидОплаты</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ЭквайринговыйТерминал" Вид="Реквизит" Тип="СправочникСсылка.ЭквайринговыеТерминалы"/>
						<Приемник Имя="ВидОплаты" Вид="Реквизит" Тип="СправочникСсылка.ВидыОплатОрганизаций"/>
						<КодПравилаКонвертации>ЭквайринговыеТерминалыВидыОплатОрганизаций        </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>5</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
						<ПриВыгрузке>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	Значение = Справочники.Клиенты.ПустаяСсылка();
КонецЕсли;</ПриВыгрузке>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ВозвратПоПлатежнойКарте</Код>
				<Наименование>Документ: Возврат по платежной карте</Наименование>
				<Порядок>1250</Порядок>
				<ПередВыгрузкой>Отказ = Не Источник.Проведен</ПередВыгрузкой>
				<ПослеВыгрузки>ТЗОплата = Новый ТаблицаЗначений();

// Реквизиты, которые пойдут в шапку
ТЗОплата.Колонки.Добавить("СуммаДокумента"); 
ТЗОплата.Колонки.Добавить("Дата");
ТЗОплата.Колонки.Добавить("ЭквайринговыйТерминал"); 
ТЗОплата.Колонки.Добавить("Клиент"); 
ТЗОплата.Колонки.Добавить("Организация");

СтрОплата = ТЗОплата.Добавить();
Если ЗначениеЗаполнено(Источник.ЭквайринговыйТерминал) Тогда
	СтрОплата.Дата = КонецДня(Источник.Дата); 
	СтрОплата.СуммаДокумента = -Источник.СуммаДокумента;
	СтрОплата.ЭквайринговыйТерминал = Источник.ЭквайринговыйТерминал;
	ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
	Если ДетализироватьКлиентов Тогда
		СтрОплата.Клиент = Источник.Клиент;
	КонецЕсли;
	СтрОплата.Организация = Источник.Филиал.Организация;
КонецЕсли;		

Если ПустаяСтрока(Параметры.ДокиПоБезналу) Тогда
	Параметры.ДокиПоБезналу = ЗначениеВСтрокуВнутр(ТЗОплата);
Иначе
	ТабДоки = ЗначениеИзСтрокиВнутр (Параметры.ДокиПоБезналу);
	Для Каждого СтрокаИсточник Из ТЗОплата Цикл
		ЗаполнитьЗначенияСвойств(ТабДоки.Добавить(),СтрокаИсточник);
	КонецЦикла;
	Параметры.ДокиПоБезналу = ЗначениеВСтрокуВнутр(ТабДоки);
КонецЕсли;

Отказ = Истина;</ПослеВыгрузки>
				<НеЗапоминатьВыгруженные>true</НеЗапоминатьВыгруженные>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>ДокументСсылка.ВозвратПоПлатежнойКарте</Источник>
				<Приемник>ДокументСсылка.ОплатаПлатежнойКартой</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Дата --&gt; Дата</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Дата" Вид="Свойство" Тип="Дата"/>
						<Приемник Имя="Дата" Вид="Свойство" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>--&gt; Комментарий</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Значение = "Загружен из " + Метаданные.Синоним + ". " + Строка(Источник) + ". " + Источник.Комментарий;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>СуммаДокумента --&gt; СуммаДокумента</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
						<Приемник Имя="СуммаДокумента" Вид="Реквизит" Тип="Число"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>10</Код>
						<Наименование>ЭквайринговыйТерминал --&gt; ВидОплаты</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="ЭквайринговыйТерминал" Вид="Реквизит" Тип="СправочникСсылка.ЭквайринговыеТерминалы"/>
						<Приемник Имя="ВидОплаты" Вид="Реквизит" Тип="СправочникСсылка.ВидыОплатОрганизаций"/>
						<КодПравилаКонвертации>ЭквайринговыеТерминалыВидыОплатОрганизаций        </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>11</Код>
						<Наименование>Клиент --&gt; Контрагент</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="Клиент" Вид="Реквизит" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит"/>
						<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
						<ПриВыгрузке>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Если Не ДетализироватьКлиентов Тогда
	Значение = Справочники.Клиенты.ПустаяСсылка();
КонецЕсли;</ПриВыгрузке>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>100</Порядок>
			<Правило>
				<Код>Пользователи</Код>
				<Наименование>СправочникСсылка.Пользователи --&gt; СправочникСсылка.Пользователи</Наименование>
				<Порядок>50</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.Пользователи</Источник>
				<Приемник>СправочникСсылка.Пользователи</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Склады</Код>
				<Наименование>СправочникСсылка.Склады --&gt; СправочникСсылка.Склады</Наименование>
				<Порядок>100</Порядок>
				<ПослеЗагрузки>ТипСклада = Перечисления.ТипыСкладов.ОптовыйСклад;</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>Если НомерВариантаПоиска = 1  Тогда
	
	Соответствие = СокрЛП(Параметры.Склады);
		
	Если ЗначениеЗаполнено(Соответствие) И (Соответствие &lt;&gt; "Не сопоставлять") Тогда
	
		Запрос = Новый Запрос;

		Если Соответствие = "Внешний код" Тогда
		
			Соответствие = "Код";
						
		КонецЕсли;
		
		Запрос.УстановитьПараметр("ПолеПоиска", СвойстваПоиска.Получить(Соответствие));
	
		Запрос.Текст = "
		| ВЫБРАТЬ
		| 	Склады.Ссылка
		| ИЗ
		| 	Справочник.Склады КАК Склады
		| ГДЕ
		|	Склады." + Соответствие + " = &amp;ПолеПоиска";
		
		Выборка = Запрос.Выполнить().Выбрать();
			
		Если Выборка.Следующий() Тогда
				
			СсылкаНаОбъект = Выборка.Ссылка;
			ПрекратитьПоиск = Истина;
			ОбъектНайден = Истина;
				
		Иначе 
				
			СсылкаНаОбъект = Неопределено;
				
		КонецЕсли;
	
	Иначе
		
		ПрекратитьПоиск = Истина;

	КонецЕсли;
 	
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>СправочникСсылка.Склады</Источник>
				<Приемник>СправочникСсылка.Склады</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Если НЕ ПустаяСтрока(Источник.ВнешнийКод) Тогда
	 
	Если (Параметры.Склады = "Внешний код") 
	Тогда
		 
		 Значение = СокрЛП(Источник.ВнешнийКод);
		 
	Иначе
		
		Значение = СокрЛП(Источник.Код);
		
	КонецЕсли;
	    
Иначе
	
	Значение = СокрЛП(Источник.Код);
	
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Склады"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Склады"/>
						<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>4</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Номенклатура</Код>
				<Наименование>СправочникСсылка.Номенклатура --&gt; СправочникСсылка.Номенклатура</Наименование>
				<Порядок>150</Порядок>
				<ПередВыгрузкой>Если Не Источник.ЭтоГруппа
	И Источник.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Набор
Тогда
	Отказ = Истина;
КонецЕсли;</ПередВыгрузкой>
				<ПослеЗагрузки>ИмяНастройки = "битГруппаНовойНоменклатуры";
ЗначениеНастройки = "";
Выполнить(Алгоритмы.ПолучитьНастройку);

Если Не ЗначениеЗаполнено(Объект.Родитель) Тогда
	Объект.Родитель = ЗначениеНастройки;	
КонецЕсли;

Если Не Объект.ЭтоГруппа Тогда
	
	Попытка
		Если Не ЗначениеЗаполнено(Объект.ВидСтавкиНДС) Тогда
			ИмяНастройки = "битОсновнаяСтавкаНДС";
			Выполнить(Алгоритмы.ПолучитьНастройку);
			Объект.ВидСтавкиНДС = ЗначениеНастройки;
		КонецЕсли;
	Исключение КонецПопытки;
	
	Если Объект.ЭтоНовый() Тогда
		ИмяНастройки = "битНоменклатурнаяГруппаНовойНоменклатуры";
		Выполнить(Алгоритмы.ПолучитьНастройку);
		Объект.НоменклатурнаяГруппа = ЗначениеНастройки;
		//СтруктураНастроек.Свойство("битНоменклатурнаяГруппаНовойНоменклатуры",Объект.НоменклатурнаяГруппа);
	КонецЕсли;
	
КонецЕсли;</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>Если НомерВариантаПоиска = 1  Тогда
	
	Если СвойстваПоиска.Получить("ЭтоГруппа") Тогда
	
		Соответствие = СокрЛП(Параметры.НоменклатураГруппы);
		
	Иначе
		
		Соответствие = СокрЛП(Параметры.Номенклатура);
		
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Соответствие) И (Соответствие &lt;&gt; "Не сопоставлять") Тогда
	
		Запрос = Новый Запрос;

		Если Соответствие = "Внешний код" Тогда
		
			Соответствие = "Код";
			
		КонецЕсли;
		
		Запрос.УстановитьПараметр("ПолеПоиска", СвойстваПоиска.Получить(Соответствие));
	
		Запрос.Текст = "
		| ВЫБРАТЬ
		| 	Номенклатура.Ссылка
		| ИЗ
		| 	Справочник.Номенклатура КАК Номенклатура
		| ГДЕ
		|	Номенклатура." + Соответствие + " = &amp;ПолеПоиска";
		
		Выборка = Запрос.Выполнить().Выбрать();
			
		Если Выборка.Следующий() Тогда
				
			СсылкаНаОбъект = Выборка.Ссылка;
			ПрекратитьПоиск = Истина;
			ОбъектНайден = Истина;
				
		Иначе 
				
			СсылкаНаОбъект = Неопределено;
				
		КонецЕсли;
	
	Иначе
		
		ПрекратитьПоиск = Истина;

	КонецЕсли;
 	
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>СправочникСсылка.Номенклатура</Источник>
				<Приемник>СправочникСсылка.Номенклатура</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Если НЕ ПустаяСтрока(Источник.ВнешнийКод) Тогда
	 
	Если (Источник.ЭтоГруппа И Параметры.НоменклатураГруппы = "Внешний код") 
		ИЛИ (НЕ Источник.ЭтоГруппа И Параметры.Номенклатура = "Внешний код") 
	Тогда
		 
		 Значение = СокрЛП(Источник.ВнешнийКод);
		 
	Иначе
		
		Значение = СокрЛП(Источник.Код);
		
	КонецЕсли;
	    
Иначе
	
	Значение = СокрЛП(Источник.Код);
	
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Номенклатура"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Номенклатура"/>
						<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>4</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ВидНоменклатуры --&gt; Услуга</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ВидНоменклатуры" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыНоменклатуры"/>
						<Приемник Имя="Услуга" Вид="Реквизит" Тип="Булево"/>
						<ПередВыгрузкой>Значение = (Источник.ВидНоменклатуры &lt;&gt; Перечисления.ВидыНоменклатуры.Материал);</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>БазоваяЕдиницаИзмерения --&gt; ЕдиницаИзмерения</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="БазоваяЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
						<Приемник Имя="ЕдиницаИзмерения" Вид="Реквизит" Тип="СправочникСсылка.КлассификаторЕдиницИзмерения"/>
						<КодПравилаКонвертации>КлассификаторЕдиницИзмерения                      </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>8</Код>
						<Наименование>Артикул --&gt; Артикул</Наименование>
						<Порядок>450</Порядок>
						<Источник Имя="Артикул" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Артикул" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>9</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>500</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>10</Код>
						<Наименование>ВидНоменклатуры --&gt; ВидНоменклатуры</Наименование>
						<Порядок>550</Порядок>
						<Источник Имя="ВидНоменклатуры" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыНоменклатуры"/>
						<Приемник Имя="ВидНоменклатуры" Вид="Реквизит" Тип="СправочникСсылка.ВидыНоменклатуры"/>
						<ПередВыгрузкой>Если Источник.ЭтоГруппа Тогда
	Отказ = Истина;
КонецЕсли;

БылВыгружен = Ложь;

Если ТипЗнч(Параметры.ВидыНоменклатуры) = Тип("ХранилищеЗначения") Тогда
	
	ВидыНоменклатуры = Параметры.ВидыНоменклатуры.Получить();
	Если ВидыНоменклатуры &lt;&gt; Неопределено Тогда
		
		ВидНоменклатуры = ВидыНоменклатуры.Получить(Источник);
		Если ВидНоменклатуры &lt;&gt; Неопределено
			И Не ПустаяСтрока(ВидНоменклатуры)
		Тогда
			ДанныеВида = Новый Структура;
			ДанныеВида.Вставить("Наименование", ВидНоменклатуры);
			ДанныеВида.Вставить("Услуга", Источник.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Услуга);
			
			БылВыгружен = Истина;
			
			ТекстСсылка = ВыгрузитьПоПравилу(ДанныеВида, , , , "ВидыНоменклатуры");
			
			пУзелСвойства = СоздатьУзел("Свойство");
			УстановитьАтрибут(пУзелСвойства, "Имя", "ВидНоменклатуры");
			УстановитьАтрибут(пУзелСвойства, "Тип", "СправочникСсылка.ВидыНоменклатуры");
			ДобавитьПодчиненный(пУзелСвойства, ТекстСсылка); // Узел &lt;Ссылка&gt;
			ДобавитьПодчиненный(Приемник, пУзелСвойства); 	 // Узел &lt;Свойство&gt; 

			Отказ = Истина;
			
		КонецЕсли;
	КонецЕсли;
КонецЕсли;</ПередВыгрузкой>
						<ПриВыгрузке>Если Отказ = Истина Тогда
	СтандартнаяОбработка = Ложь;
КонецЕсли;</ПриВыгрузке>
					</Свойство>
					<Свойство>
						<Код>11</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>600</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>13</Код>
						<Наименование>--&gt; ВидСтавкиНДС</Наименование>
						<Порядок>700</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ВидСтавкиНДС" Вид="Реквизит" Тип="ПеречислениеСсылка.ВидыСтавокНДС"/>
						<ПередВыгрузкой>// Если выгрузка делается из релиза, соответствующего версии УМЦ младше 2.0.36, то там еще нет в номенклатуре
// реквизита ВидСтавкиНДС и этого перечисления. В этом случае ставка НДС с номенклатурой не переносится в бухгалтерию 3.0.67+
Попытка
	ВидСтавкиНДС = Источник.ВидСтавкиНДС;
	
	// Значение в виде строки имени элемента перечисления.
	Значение = ОбщегоНазначения.ИмяЗначенияПеречисления(ВидСтавкиНДС);
Исключение
	Значение = Неопределено;
КонецПопытки;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Контрагенты</Код>
				<Наименование>СправочникСсылка.Контрагенты --&gt; СправочникСсылка.Контрагенты</Наименование>
				<Порядок>200</Порядок>
				<ПослеЗагрузки>ИмяНастройки = "битГруппаНовыхКонтрагентов";
ЗначениеНастройки = "";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.Родитель = ЗначениеНастройки;

Если (Объект.ЭтоГруппа = ЛОЖЬ) Тогда
	
	Объект.ГоловнойКонтрагент = Объект.Ссылка;
	
	Если Объект.Метаданные().Реквизиты.Найти("СтранаРегистрации") &lt;&gt; Неопределено Тогда
		Объект.СтранаРегистрации = ПредопределенноеЗначение("Справочник.СтраныМира.Россия");
	КонецЕсли;
	
	Если СтрДлина(СокрЛП(Объект.ИНН)) = 12 Тогда
		Объект.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо;
	Иначе
		Объект.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ЮридическоеЛицо;
	КонецЕсли;
	
КонецЕсли;</ПослеЗагрузки>
				<ПоследовательностьПолейПоиска>Если НомерВариантаПоиска = 1  Тогда
	
	Если СвойстваПоиска.Получить("ЭтоГруппа") Тогда
	
		Соответствие = СокрЛП(Параметры.КонтрагентыГруппы);
		
	Иначе
		
		Соответствие = СокрЛП(Параметры.Контрагенты);
		
	КонецЕсли;
	
	Если ЗначениеЗаполнено(Соответствие) Тогда
	
	Если Соответствие &lt;&gt; "Не сопоставлять" Тогда
			
		Запрос = Новый Запрос;

		Если Соответствие = "Внешний код" Тогда
		
			Соответствие = "Код";
			
		КонецЕсли;
		
		Запрос.УстановитьПараметр("ПолеПоиска", СвойстваПоиска.Получить(Соответствие));
	
		Запрос.Текст = "
		| ВЫБРАТЬ
		| 	Контрагенты.Ссылка
		| ИЗ
		| 	Справочник.Контрагенты КАК Контрагенты
		| ГДЕ
		|	Контрагенты." + Соответствие + " = &amp;ПолеПоиска";
		
		Выборка = Запрос.Выполнить().Выбрать();
			
		Если Выборка.Следующий() Тогда
				
			СсылкаНаОбъект = Выборка.Ссылка;
			ПрекратитьПоиск = Истина;
			ОбъектНайден = Истина;
				
		Иначе 
				
			СсылкаНаОбъект = Неопределено;
				
		КонецЕсли;
	
	Иначе
		
		ПрекратитьПоиск = Истина;

	КонецЕсли;
	КонецЕсли;
 	
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>СправочникСсылка.Контрагенты</Источник>
				<Приемник>СправочникСсылка.Контрагенты</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>
Если НЕ ПустаяСтрока(Источник.ВнешнийКод) Тогда
	 
	Если (Источник.ЭтоГруппа И Параметры.КонтрагентыГруппы = "Внешний код") 
		ИЛИ (НЕ Источник.ЭтоГруппа И Параметры.Контрагенты = "Внешний код") 
	Тогда
		 
		 Значение = СокрЛП(Источник.ВнешнийКод);
		 
	Иначе
		
		Значение = СокрЛП(Источник.Код);
		
	КонецЕсли;
	    
Иначе
	
	Значение = СокрЛП(Источник.Код);
	
КонецЕсли;

ДлинаКода = 9;

Пока СтрДлина(Значение) &lt; ДлинаКода Цикл
	Значение = "0" + Значение;
КонецЦикла;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>4</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>ИНН --&gt; ИНН</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>КлассификаторЕдиницИзмерения</Код>
				<Наименование>СправочникСсылка.КлассификаторЕдиницИзмерения --&gt; СправочникСсылка.КлассификаторЕдиницИзмерения</Наименование>
				<Порядок>300</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.КлассификаторЕдиницИзмерения</Источник>
				<Приемник>СправочникСсылка.КлассификаторЕдиницИзмерения</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>СтатьиДвиженияДенежныхСредств</Код>
				<Наименование>СправочникСсылка.СтатьиДвиженияДенежныхСредств --&gt; СправочникСсылка.СтатьиДвиженияДенежныхСредств</Наименование>
				<Порядок>350</Порядок>
				<ПоследовательностьПолейПоиска>Если НомерВариантаПоиска = 1  Тогда
	
	Соответствие = СокрЛП(Параметры.СтатьиДвиженияДенежныхСредств);
		
	Если ЗначениеЗаполнено(Соответствие) И (Соответствие &lt;&gt; "Не сопоставлять") Тогда
	
		Запрос = Новый Запрос;

		Если Соответствие = "Внешний код" Тогда
		
			Соответствие = "Код";
				
		КонецЕсли;
		
		Запрос.УстановитьПараметр("ПолеПоиска", СвойстваПоиска.Получить(Соответствие));
	
		Запрос.Текст = "
		| ВЫБРАТЬ
		| 	СтатьиДвиженияДенежныхСредств.Ссылка
		| ИЗ
		| 	Справочник.СтатьиДвиженияДенежныхСредств КАК СтатьиДвиженияДенежныхСредств
		| ГДЕ
		|	СтатьиДвиженияДенежныхСредств." + Соответствие + " = &amp;ПолеПоиска";
		
		Выборка = Запрос.Выполнить().Выбрать();
			
		Если Выборка.Следующий() Тогда
				
			СсылкаНаОбъект = Выборка.Ссылка;
			ПрекратитьПоиск = Истина;
			ОбъектНайден = Истина;
				
		Иначе 
				
			СсылкаНаОбъект = Неопределено;
				
		КонецЕсли;
	
	Иначе
		
		ПрекратитьПоиск = Истина;

	КонецЕсли;
 	
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.СтатьиДвиженияДенежныхСредств</Источник>
				<Приемник>СправочникСсылка.СтатьиДвиженияДенежныхСредств</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Если НЕ ПустаяСтрока(Источник.ВнешнийКод) Тогда
	 
	Если (Параметры.СтатьиДвиженияДенежныхСредств = "Внешний код") 
	Тогда
		 
		 Значение = СокрЛП(Источник.ВнешнийКод);
		 
	Иначе
		
		Значение = СокрЛП(Источник.Код);
		
	КонецЕсли;
	    
Иначе
	
	Значение = СокрЛП(Источник.Код);
	
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.СтатьиДвиженияДенежныхСредств"/>
						<КодПравилаКонвертации>СтатьиДвиженияДенежныхСредств                     </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>5</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Валюты</Код>
				<Наименование>СправочникСсылка.Валюты --&gt; СправочникСсылка.Валюты</Наименование>
				<Порядок>400</Порядок>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<Источник>СправочникСсылка.Валюты</Источник>
				<Приемник>СправочникСсылка.Валюты</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>ПараметрыПрописиНаРусском --&gt; ПараметрыПрописи</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="ПараметрыПрописиНаРусском" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ПараметрыПрописи" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ФизическиеЛица</Код>
				<Наименование>Справочник: Сотрудники</Наименование>
				<Порядок>450</Порядок>
				<ПослеЗагрузки>Если НЕ Объект.ЭтоГруппа Тогда
	
	Объект.Записать();	
	МассивПодстрок = СтроковыеФункцииКлиентСервер.РазложитьСтрокуВМассивПодстрок(Объект.Наименование, " ");
	
	КоличествоПодстрок = МассивПодстрок.Количество();
	
	Фамилия = ?(КоличествоПодстрок &gt; 0, МассивПодстрок[0], "");
	Имя		= ?(КоличествоПодстрок &gt; 1, МассивПодстрок[1], "");
	Отчество= ?(КоличествоПодстрок &gt; 2, МассивПодстрок[2], "");
	
	Запрос = Новый Запрос;
	
	ТекстЗапроса =  " ВЫБРАТЬ
	|	 ФИОФизическихЛиц.ФизическоеЛицо
	| ИЗ
	| 	РегистрСведений.ФИОФизическихЛиц КАК ФИОФизическихЛиц
	| ГДЕ
	|	ФИОФизическихЛиц.ФизическоеЛицо = &amp;ФизЛицо";
	
	Запрос.Текст = ТекстЗапроса;
	
	Запрос.УстановитьПараметр("ФизЛицо", Объект.Ссылка);
	
	Выборка = Запрос.Выполнить().Выбрать();
	Если Выборка.Количество() = 0 Тогда	
		НаборЗаписей = РегистрыСведений.ФИОФизическихЛиц.СоздатьНаборЗаписей();
		НаборЗаписей.Отбор.ФизическоеЛицо.Установить(Объект.Ссылка); 
		НаборЗаписей.Прочитать();
		НоваяЗапись = НаборЗаписей.Добавить();
		НоваяЗапись.Фамилия = Фамилия;	
		НоваяЗапись.Имя = Имя;
		НоваяЗапись.Отчество = Отчество;	
		НоваяЗапись.ФизическоеЛицо = Объект.Ссылка;
		НоваяЗапись.Период = '19000101';
		НаборЗаписей.Записать();
		
	КонецЕсли;
	
КонецЕсли;</ПослеЗагрузки>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>СправочникСсылка.Сотрудники</Источник>
				<Приемник>СправочникСсылка.ФизическиеЛица</Приемник>
				<Свойства>
					<Свойство Отключить="true">
						<Код>2</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>8</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>1</Код>
						<Наименование>ДатаРождения --&gt; ДатаРождения</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="ДатаРождения" Вид="Реквизит" Тип="Дата"/>
						<Приемник Имя="ДатаРождения" Вид="Реквизит" Тип="Дата"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Сотрудники"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.ФизическиеЛица"/>
						<КодПравилаКонвертации>ФизическиеЛица                                    </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>--&gt; Наименование</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Если НЕ Источник.ЭтоГруппа Тогда
	Значение = СокрЛП(Источник.Фамилия) + " " + СокрЛП(Источник.Имя) + " " + СокрЛП(Источник.Отчество);
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>9</Код>
						<Наименование>--&gt; ФИО</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ФИО" Вид="Реквизит" Тип="Строка"/>
						<ПередВыгрузкой>Если НЕ Источник.ЭтоГруппа Тогда
	Значение = СокрЛП(Источник.Фамилия) + " " + СокрЛП(Источник.Имя) + " " + СокрЛП(Источник.Отчество);
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>Пол --&gt; Пол</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Пол" Вид="Реквизит" Тип="ПеречислениеСсылка.ПолФизическихЛиц"/>
						<Приемник Имя="Пол" Вид="Реквизит" Тип="ПеречислениеСсылка.ПолФизическогоЛица"/>
						<КодПравилаКонвертации>ПолФизическихЛиц                                  </КодПравилаКонвертации>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ДоговорыКонтрагентов</Код>
				<Наименование>Справочник: Соглашения страхования</Наименование>
				<Порядок>500</Порядок>
				<ПередВыгрузкой>Отказ = Источник.ПометкаУдаления;</ПередВыгрузкой>
				<ПослеЗагрузки>//ИмяНастройки = "битОрганизация";
//ЗначениеНастройки = "";
//Выполнить(Алгоритмы.ПолучитьНастройку);
//Объект.Организация = ЗначениеНастройки;

Объект.ВалютаВзаиморасчетов = Константы.ВалютаРегламентированногоУчета.Получить();
Объект.ВидДоговора = Перечисления.ВидыДоговоровКонтрагентов.СПоставщиком;</ПослеЗагрузки>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<Источник>СправочникСсылка.СоглашенияСтрахования</Источник>
				<Приемник>СправочникСсылка.ДоговорыКонтрагентов</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>Владелец --&gt; Владелец</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="Владелец" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Владелец" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>3</Код>
						<Наименование>--&gt; ЭтоГруппа</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<ПередВыгрузкой>Значение = Ложь;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>4</Код>
						<Наименование>Организация --&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>ЭквайринговыеТерминалыВидыОплатОрганизаций</Код>
				<Наименование>Справочник: Эквайринговые терминалы</Наименование>
				<Порядок>550</Порядок>
				<ПриЗагрузке>Если Объект.ЭтоНовый() Тогда
	
	//заполнение счета расчетов и способа оплаты
	Объект.СчетУчетаРасчетов = ПланыСчетов.Хозрасчетный.ПродажиПоПлатежнымКартам;
	Объект.ТипОплаты = Перечисления.ТипыОплат.ПлатежнаяКарта;
	
	// Организация
	//ЗначениеНастройки = Неопределено;
	//ИмяНастройки = "битОрганизация";
	//Выполнить(Алгоритмы.ПолучитьНастройку);	
КонецЕсли</ПриЗагрузке>
				<Источник>СправочникСсылка.ЭквайринговыеТерминалы</Источник>
				<Приемник>СправочникСсылка.ВидыОплатОрганизаций</Приемник>
				<Свойства>
					<Свойство Поиск="true" Обязательное="true">
						<Код>2</Код>
						<Наименование>--&gt; ЭтоГруппа</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<ПередВыгрузкой>Значение = Ложь;</ПередВыгрузкой>
					</Свойство>
					<Свойство Поиск="true">
						<Код>3</Код>
						<Наименование>Контрагент --&gt; Контрагент</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<Приемник Имя="Контрагент" Вид="Реквизит" Тип="СправочникСсылка.Контрагенты"/>
						<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>4</Код>
						<Наименование>Договор --&gt; ДоговорКонтрагента</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Договор" Вид="Реквизит" Тип="СправочникСсылка.СоглашенияСтрахования"/>
						<Приемник Имя="ДоговорКонтрагента" Вид="Реквизит" Тип="СправочникСсылка.ДоговорыКонтрагентов"/>
						<КодПравилаКонвертации>ДоговорыКонтрагентов                              </КодПравилаКонвертации>
					</Свойство>
					<Свойство Поиск="true">
						<Код>6</Код>
						<Наименование>--&gt; Организация</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Организация" Вид="Реквизит" Тип="СправочникСсылка.Организации"/>
						<КодПравилаКонвертации>Организации                                       </КодПравилаКонвертации>
						<ПередВыгрузкой>Значение = Источник.Договор.Организация</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>5</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>КлиентыВКонтрагенты</Код>
				<Наименование>Справочник: Клиенты</Наименование>
				<Порядок>600</Порядок>
				<ПередВыгрузкой>ДетализироватьКлиентов = Параметры.ДетализироватьКлиентов;
Отказ = Не ДетализироватьКлиентов;</ПередВыгрузкой>
				<ПослеЗагрузки>ИмяНастройки = "битГруппаНовыхКонтрагентов";
ЗначениеНастройки = "";
Выполнить(Алгоритмы.ПолучитьНастройку);
Объект.Родитель = ЗначениеНастройки;

Если Объект.ЭтоГруппа = Ложь Тогда
	
	Объект.ГоловнойКонтрагент = Объект.Ссылка;
	
	Если Объект.Метаданные().Реквизиты.Найти("СтранаРегистрации") &lt;&gt; Неопределено Тогда
		Объект.СтранаРегистрации = ПредопределенноеЗначение("Справочник.СтраныМира.Россия");
	КонецЕсли;
	
	Объект.ЮридическоеФизическоеЛицо = Перечисления.ЮридическоеФизическоеЛицо.ФизическоеЛицо;
	
КонецЕсли;</ПослеЗагрузки>
				<НеЗамещать>true</НеЗамещать>
				<СинхронизироватьПоИдентификатору>true</СинхронизироватьПоИдентификатору>
				<ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>true</ПродолжитьПоискПоПолямПоискаЕслиПоИдентификаторуНеНашли>
				<ГенерироватьНовыйНомерИлиКодЕслиНеУказан>true</ГенерироватьНовыйНомерИлиКодЕслиНеУказан>
				<Источник>СправочникСсылка.Клиенты</Источник>
				<Приемник>СправочникСсылка.Контрагенты</Приемник>
				<Свойства>
					<Свойство>
						<Код>1</Код>
						<Наименование>ДатаСоздания --&gt; ДатаСоздания</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="ДатаСоздания" Вид="Реквизит" Тип="Дата"/>
						<Приемник Имя="ДатаСоздания" Вид="Реквизит" Тип="Дата"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>2</Код>
						<Наименование>ИНН --&gt; ИНН</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>Комментарий --&gt; Комментарий</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="Комментарий" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>5</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>6</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>300</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
					<Свойство>
						<Код>7</Код>
						<Наименование>Родитель --&gt; Родитель</Наименование>
						<Порядок>350</Порядок>
						<Источник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Клиенты"/>
						<Приемник Имя="Родитель" Вид="Свойство" Тип="СправочникСсылка.Контрагенты"/>
					</Свойство>
					<Свойство Поиск="true" Обязательное="true">
						<Код>8</Код>
						<Наименование>ЭтоГруппа --&gt; ЭтоГруппа</Наименование>
						<Порядок>400</Порядок>
						<Источник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ЭтоГруппа" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
			<Правило>
				<Код>Организации</Код>
				<Наименование>Справочник: Организации</Наименование>
				<Порядок>650</Порядок>
				<ПоследовательностьПолейПоиска>// Ищем сначала по паре "ИНН, ПометкаУдаления" (вдруг дубли), только потом по ИНН.

Если НомерВариантаПоиска = 1 тогда
	
	СтрокаИменСвойствПоиска = "ИНН, ПометкаУдаления";
	
ИначеЕсли НомерВариантаПоиска = 2 тогда
	
	СтрокаИменСвойствПоиска = "ИНН";
	
Иначе
	ПрекратитьПоиск = Истина;
КонецЕсли;</ПоследовательностьПолейПоиска>
				<НеЗамещать>true</НеЗамещать>
				<НеСоздаватьЕслиНеНайден>true</НеСоздаватьЕслиНеНайден>
				<Источник>СправочникСсылка.Организации</Источник>
				<Приемник>СправочникСсылка.Организации</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>ИНН --&gt; ИНН</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="ИНН" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>Код --&gt; Код</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="Код" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Код" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>3</Код>
						<Наименование>Наименование --&gt; Наименование</Наименование>
						<Порядок>150</Порядок>
						<Источник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
					</Свойство>
					<Свойство>
						<Код>4</Код>
						<Наименование>НаименованиеПолное --&gt; НаименованиеПолное</Наименование>
						<Порядок>200</Порядок>
						<Источник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
						<Приемник Имя="НаименованиеПолное" Вид="Реквизит" Тип="Строка"/>
					</Свойство>
					<Свойство Поиск="true">
						<Код>5</Код>
						<Наименование>ПометкаУдаления --&gt; ПометкаУдаления</Наименование>
						<Порядок>250</Порядок>
						<Источник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
						<Приемник Имя="ПометкаУдаления" Вид="Свойство" Тип="Булево"/>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
		<Группа>
			<Код>Регистры сведений</Код>
			<Наименование>Регистры сведений</Наименование>
			<Порядок>150</Порядок>
		</Группа>
		<Группа>
			<Код>Перечисления</Код>
			<Наименование>Перечисления</Наименование>
			<Порядок>200</Порядок>
			<Правило>
				<Код>ВидыОперацийПКО</Код>
				<Наименование>ПеречислениеСсылка.ВидыОперацийПКО --&gt; ПеречислениеСсылка.ВидыОперацийПКО</Наименование>
				<Порядок>100</Порядок>
				<Источник>ПеречислениеСсылка.ВидыОперацийПКО</Источник>
				<Приемник>ПеречислениеСсылка.ВидыОперацийПКО</Приемник>
				<Свойства/>
				<Значения>
					<Значение>
						<Код>1</Код>
						<Наименование>ОплатаОтКлиента --&gt; ОплатаПокупателя</Наименование>
						<Порядок>50</Порядок>
						<Источник>ОплатаОтКлиента</Источник>
						<Приемник>ОплатаПокупателя</Приемник>
					</Значение>
					<Значение>
						<Код>2</Код>
						<Наименование>ПолучениеДенежныхСредствОтСотрудника --&gt; ВозвратДе</Наименование>
						<Порядок>100</Порядок>
						<Источник>ПолучениеДенежныхСредствОтСотрудника</Источник>
						<Приемник>ВозвратОтПодотчетногоЛица</Приемник>
					</Значение>
					<Значение>
						<Код>3</Код>
						<Наименование>ПриходДенежныхСредствОтКонтрагента --&gt; ОплатаПокуп</Наименование>
						<Порядок>150</Порядок>
						<Источник>ПриходДенежныхСредствОтКонтрагента</Источник>
						<Приемник>ВозвратОтПоставщика</Приемник>
					</Значение>
					<Значение>
						<Код>4</Код>
						<Наименование>ПрочееПоступлениеДенежныхСредств --&gt; ПриходДенежны</Наименование>
						<Порядок>200</Порядок>
						<Источник>ПрочееПоступлениеДенежныхСредств</Источник>
						<Приемник>ПрочийПриход</Приемник>
					</Значение>
					<Значение>
						<Код>5</Код>
						<Наименование>ПолучениеНаличныхВБанке --&gt; ПриходДенежныхСредствП</Наименование>
						<Порядок>250</Порядок>
						<Источник>ПолучениеНаличныхВБанке</Источник>
						<Приемник>ПолучениеНаличныхВБанке</Приемник>
					</Значение>
				</Значения>
			</Правило>
			<Правило>
				<Код>ВидыОперацийРКО</Код>
				<Наименование>ПеречислениеСсылка.ВидыОперацийРКО --&gt; ПеречислениеСсылка.ВидыОперацийРКО</Наименование>
				<Порядок>150</Порядок>
				<Источник>ПеречислениеСсылка.ВидыОперацийРКО</Источник>
				<Приемник>ПеречислениеСсылка.ВидыОперацийРКО</Приемник>
				<Свойства/>
				<Значения>
					<Значение>
						<Код>1</Код>
						<Наименование>ВыдачаДенежныхСредствСотруднику --&gt; РасходДенежных</Наименование>
						<Порядок>50</Порядок>
						<Источник>ВыдачаДенежныхСредствСотруднику</Источник>
						<Приемник>ВыдачаПодотчетномуЛицу</Приемник>
					</Значение>
					<Значение>
						<Код>2</Код>
						<Наименование>ПрочийРасходДенежныхСредств --&gt; РасходДенежныхСред</Наименование>
						<Порядок>100</Порядок>
						<Источник>ПрочийРасходДенежныхСредств</Источник>
						<Приемник>ПрочийРасход</Приемник>
					</Значение>
					<Значение>
						<Код>3</Код>
						<Наименование>РасчетыСКлиентами --&gt; ВозвратДенежныхСредствПокупа</Наименование>
						<Порядок>150</Порядок>
						<Источник>РасчетыСКлиентами</Источник>
						<Приемник>ВозвратПокупателю</Приемник>
					</Значение>
					<Значение>
						<Код>4</Код>
						<Наименование>РасчетыСКонтрагентами --&gt; ОплатаПоставщику</Наименование>
						<Порядок>200</Порядок>
						<Источник>РасчетыСКонтрагентами</Источник>
						<Приемник>ОплатаПоставщику</Приемник>
					</Значение>
					<Значение>
						<Код>5</Код>
						<Наименование>ПеремещениеВКассу --&gt;</Наименование>
						<Порядок>250</Порядок>
						<Источник>ПеремещениеВКассу</Источник>
						<Приемник>ПрочийРасход</Приемник>
					</Значение>
					<Значение>
						<Код>6</Код>
						<Наименование>ВзносНаличнымиВБанк --&gt; ВзносНаличнымиВБанк</Наименование>
						<Порядок>300</Порядок>
						<Источник>ВзносНаличнымиВБанк</Источник>
						<Приемник>Инкассация</Приемник>
					</Значение>
				</Значения>
			</Правило>
			<Правило>
				<Код>ПолФизическихЛиц</Код>
				<Наименование>Перечисление: Пол физических лиц</Наименование>
				<Порядок>200</Порядок>
				<Источник>ПеречислениеСсылка.ПолФизическихЛиц</Источник>
				<Приемник>ПеречислениеСсылка.ПолФизическогоЛица</Приемник>
				<Свойства/>
				<Значения>
					<Значение>
						<Код>1</Код>
						<Наименование>Женский --&gt; Женский</Наименование>
						<Порядок>50</Порядок>
						<Источник>Женский</Источник>
						<Приемник>Женский</Приемник>
					</Значение>
					<Значение>
						<Код>2</Код>
						<Наименование>Мужской --&gt; Мужской</Наименование>
						<Порядок>100</Порядок>
						<Источник>Мужской</Источник>
						<Приемник>Мужской</Приемник>
					</Значение>
				</Значения>
			</Правило>
			<Правило>
				<Код>ВидыНоменклатуры</Код>
				<Наименование>Перечисление: Виды номенклатуры</Наименование>
				<Порядок>250</Порядок>
				<НеЗамещать>true</НеЗамещать>
				<Источник>ПеречислениеСсылка.ВидыНоменклатуры</Источник>
				<Приемник>СправочникСсылка.ВидыНоменклатуры</Приемник>
				<Свойства>
					<Свойство Поиск="true">
						<Код>1</Код>
						<Наименование>--&gt; Наименование</Наименование>
						<Порядок>50</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Наименование" Вид="Свойство" Тип="Строка"/>
						<ПередВыгрузкой>Если ТипЗнч(Источник) = Тип("ПеречислениеСсылка.ВидыНоменклатуры") Тогда
	
	Если Источник = Перечисления.ВидыНоменклатуры.Материал Тогда
		Значение = "Материалы";
	ИначеЕсли Источник = Перечисления.ВидыНоменклатуры.Услуга Тогда
		Значение = "Услуги";
	Иначе
		Попытка
			Значение = Строка(Источник.Наименование);
		Исключение
		КонецПопытки;
	КонецЕсли;
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
					<Свойство>
						<Код>2</Код>
						<Наименование>--&gt; Услуга</Наименование>
						<Порядок>100</Порядок>
						<Источник Имя="" Вид=""/>
						<Приемник Имя="Услуга" Вид="Реквизит" Тип="Булево"/>
						<ПередВыгрузкой>Если ТипЗнч(Источник) &lt;&gt; Тип("Структура") Тогда
	Значение = (Источник &lt;&gt; Перечисления.ВидыНоменклатуры.Материал);
КонецЕсли;</ПередВыгрузкой>
					</Свойство>
				</Свойства>
				<Значения/>
			</Правило>
		</Группа>
	</ПравилаКонвертацииОбъектов>
	<ПравилаВыгрузкиДанных>
		<Группа Отключить="false">
			<Код>Документы</Код>
			<Наименование>Документы</Наименование>
			<Порядок>50</Порядок>
			<Правило Отключить="false">
				<Код>ПоступлениеТоваровУслуг</Код>
				<Наименование>ПоступлениеТоваровУслуг</Наименование>
				<Порядок>50</Порядок>
				<КодПравилаКонвертации>ПоступлениеТоваровУслуг                           </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ПоступлениеТоваровУслуг</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>ВозвратТоваровПоставщику</Код>
				<Наименование>ВозвратТоваровПоставщику</Наименование>
				<Порядок>100</Порядок>
				<КодПравилаКонвертации>ВозвратТоваровПоставщику                          </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ВозвратТоваровПоставщику</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>ИнвентаризацияТоваровНаСкладе</Код>
				<Наименование>ИнвентаризацияТоваров</Наименование>
				<Порядок>150</Порядок>
				<КодПравилаКонвертации>ИнвентаризацияТоваровНаСкладе                     </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ИнвентаризацияТоваров</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>ОприходованиеТоваров</Код>
				<Наименование>ОприходованиеТоваров</Наименование>
				<Порядок>200</Порядок>
				<КодПравилаКонвертации>ОприходованиеТоваров                              </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОприходованиеТоваров</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>СписаниеТоваров</Код>
				<Наименование>СписаниеТоваров</Наименование>
				<Порядок>250</Порядок>
				<КодПравилаКонвертации>СписаниеТоваров                                   </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.СписаниеТоваров</ОбъектВыборки>
				<ПередВыгрузкойОбъекта>Если Объект.ОтнесеноНаЗатраты Тогда
	ИмяПКО = "СписаниеТоваровОтнесенныхНаЗатраты";
КонецЕсли;</ПередВыгрузкойОбъекта>
			</Правило>
			<Правило Отключить="false">
				<Код>ПеремещениеМатериалов</Код>
				<Наименование>ПеремещениеМатериалов</Наименование>
				<Порядок>300</Порядок>
				<КодПравилаКонвертации>ПеремещениеТоваров                                </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ПеремещениеМатериалов</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>РеализацияТоваровУслуг</Код>
				<Наименование>Оказание услуг (работы, товары, проданные материалы, абонементы)  -&gt; Реализация товаров и услуг</Наименование>
				<Порядок>350</Порядок>
				<КодПравилаКонвертации>РеализацияТоваровУслуг                            </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОказаниеУслуг</ОбъектВыборки>
				<ПередОбработкойПравила>Параметры.Доки = "";</ПередОбработкойПравила>
				<ПослеОбработкиПравила>Если Не ПустаяСтрока(Параметры.Доки) Тогда
	ТЗСписание = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	ТЗСписание.Свернуть("Дата, Склад, Клиент, Организация, Номенклатура, Цена, Коэффициент", "Количество, Сумма");
	ТЗСписание.Колонки.Добавить("Контрагент", Новый ОписаниеТипов("СправочникСсылка.Контрагенты"));
	
	ТабШапки = ТЗСписание.Скопировать(,"Дата, Склад, Клиент, Организация"); 
	ТабШапки.Свернуть("Дата, Склад, Клиент, Организация","");
	
	Отбор = Новый Структура("Дата, Склад, Клиент, Организация");
	мсСтрокиТовары = Новый Массив;
	мсСтрокиУслуги = Новый Массив;
	мсСтрокиАгентскиеУслуги = Новый Массив;
	
	НоменклатураАгентскихУслуг = Новый Массив;
	Выполнить(Алгоритмы.НоменклатураАгентскихУслуг);
	
	Для Каждого СтрШапка Из ТабШапки Цикл
		
		ЗаполнитьЗначенияСвойств(Отбор,СтрШапка);
		мсСтрокиПродажа = ТЗСписание.НайтиСтроки(Отбор); 
		мсСтрокиТовары.Очистить();	
		мсСтрокиУслуги.Очистить();
		мсСтрокиАгентскиеУслуги.Очистить();
		
		Для Каждого СтрокаПродажа Из мсСтрокиПродажа Цикл
			Если СтрокаПродажа.Номенклатура.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Материал Тогда
				// Товар
				мсСтрокиТовары.Добавить(СтрокаПродажа);
			ИначеЕсли НоменклатураАгентскихУслуг.Найти(СтрокаПродажа.Номенклатура) &lt;&gt; Неопределено Тогда
				// Агентская услуга
				Попытка СтрокаПродажа.Контрагент = СтрокаПродажа.Номенклатура.КонтрагентПринципал; Исключение Сообщить(описаниеошибки()); КонецПопытки; // Контрагент-принципал
				мсСтрокиАгентскиеУслуги.Добавить(СтрокаПродажа);
			Иначе
				// Услуга
				мсСтрокиУслуги.Добавить(СтрокаПродажа);	
			КонецЕсли;
		КонецЦикла;
		
		СтруктураДляВыгрузки = Новый Структура("Товары,Услуги,АгентскиеУслуги", мсСтрокиТовары, мсСтрокиУслуги, мсСтрокиАгентскиеУслуги); 
		ВыгрузитьПоПравилу(СтрШапка, , СтруктураДляВыгрузки, , "РеализацияТоваровУслугСводно"); 
		
	КонецЦикла;
Конецесли;</ПослеОбработкиПравила>
			</Правило>
			<Правило Отключить="false">
				<Код>ТребованиеНакладная</Код>
				<Наименование>Оказание услуг (списание материалов) -&gt; Требование накладная</Наименование>
				<Порядок>400</Порядок>
				<КодПравилаКонвертации>ТребованиеНакладная                               </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОказаниеУслуг</ОбъектВыборки>
				<ПередОбработкойПравила>Параметры.Доки = "";</ПередОбработкойПравила>
				<ПослеОбработкиПравила>Если Не ПустаяСтрока(Параметры.Доки) Тогда

	ТЗСписание = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	
	ТЗСписание.Свернуть("Дата, Склад, Номенклатура, Коэффициент, Организация", "Количество");
	
	ТабШапки = ТЗСписание.Скопировать(,"Дата, Склад, Организация"); 
	ТабШапки.Свернуть("Дата, Склад, Организация","");
	
	Отбор = Новый Структура("Дата, Склад, Организация");
	Для Каждого СтрШапка Из ТабШапки Цикл
		ЗаполнитьЗначенияСвойств(Отбор,СтрШапка);
		мсСтрокиСписание = ТЗСписание.НайтиСтроки(Отбор); 
		
		СтруктураДляВыгрузки = Новый Структура("Материалы", мсСтрокиСписание); 
		ВыгрузитьПоПравилу(СтрШапка, , СтруктураДляВыгрузки, , "ТребованиеНакладнаяСводно"); 
	КонецЦикла;
КонецЕсли;</ПослеОбработкиПравила>
			</Правило>
			<Правило Отключить="false">
				<Код>РозничнаяВыручкаНаличные</Код>
				<Наименование>Оказание услуг (розничная выручка - наличные) -&gt; ПКО</Наименование>
				<Порядок>450</Порядок>
				<КодПравилаКонвертации>РозничнаяВыручкаНаличные                          </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОказаниеУслуг</ОбъектВыборки>
				<ПередОбработкойПравила>Параметры.Доки = "";</ПередОбработкойПравила>
				<ПослеОбработкиПравила>Если Не ПустаяСтрока(Параметры.Доки) Тогда
	
	// Короче, выгружаю шапку Дата, Клиент, Сумма и табличную часть Сумма,СтатьяДДС. в Параметры.Доки уже есть таблица Дата,Клиент,Сумма,СтатьяДДС.
	ТабШапки = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	ТабШапки.Свернуть("Дата, Клиент, СтатьяДвиженияДенежныхСредств, Организация", "Сумма");
	ТабШапки.Колонки.Сумма.Имя = "СуммаПлатежа";

	ТабДаты = ТабШапки.Скопировать();
	ТабДаты.Свернуть("Дата, Клиент, Организация", "");
	
	СтрокиПКО = Новый Массив;
	СтрокиРКО = Новый Массив;
	Для Каждого СтрШапка Из ТабШапки Цикл
		Если СтрШапка.СуммаПлатежа &gt; 0 Тогда
			СтрокиПКО.Добавить(СтрШапка);
		ИначеЕсли СтрШапка.СуммаПлатежа &lt; 0 Тогда
			СтрШапка.СуммаПлатежа = -СтрШапка.СуммаПлатежа;
			СтрокиРКО.Добавить(СтрШапка);
		КонецЕсли;
	КонецЦикла;
		
	СтрокиПКОДок = Новый Массив;
	СтрокиРКОДок = Новый Массив;
	
	Для Каждого СтрокаДата Из ТабДаты Цикл
		
		СтрокиПКОДок.Очистить();
		СтрокиРКОДок.Очистить();
		
		Для Каждого СтрокаПКО Из СтрокиПКО Цикл
			Если СтрокаПКО.Дата = СтрокаДата.Дата
				И СтрокаПКО.Клиент = СтрокаДата.Клиент И СтрокаПКО.Организация = СтрокаДата.Организация Тогда
				
				СтрокиПКОДок.Добавить(СтрокаПКО);
			КонецЕсли;
		КонецЦикла;
		
		Для Каждого СтрокаРКО Из СтрокиРКО Цикл
			Если СтрокаРКО.Дата = СтрокаДата.Дата
				И СтрокаРКО.Клиент = СтрокаДата.Клиент И СтрокаРКО.Организация = СтрокаДата.Организация Тогда
				
				СтрокиРКОДок.Добавить(СтрокаРКО);
			КонецЕсли;
		КонецЦикла;
		
		// Выгрузка по правилу ПКО
		Если СтрокиПКОДок.Количество() &lt;&gt; 0 Тогда
			СтруктураШапки = Новый Структура("Дата, Клиент, Организация, Сумма",СтрокаДата.Дата, СтрокаДата.Клиент, СтрокаДата.Организация, 0);
			Для Каждого СтрокаПКО Из СтрокиПКОДок Цикл
				СтруктураШапки.Сумма = СтруктураШапки.Сумма + СтрокаПКО.СуммаПлатежа;
			КонецЦикла;
			ВыгрузитьПоПравилу(СтруктураШапки, , Новый Структура("РасшифровкаПлатежа", СтрокиПКОДок), , "РозничнаяВыручкаНаличныеСводно");
		КонецЕсли;
		// Выгрузка по правилу РКО
		Если СтрокиРКОДок.Количество() &lt;&gt; 0 Тогда
			СтруктураШапки = Новый Структура("Дата, Клиент, Организация, Сумма",СтрокаДата.Дата, СтрокаДата.Клиент, СтрокаДата.Организация, 0);
			Для Каждого СтрокаРКО Из СтрокиРКОДок Цикл
				СтруктураШапки.Сумма = СтруктураШапки.Сумма + СтрокаРКО.СуммаПлатежа;
			КонецЦикла;
			ВыгрузитьПоПравилу(СтруктураШапки, , Новый Структура("РасшифровкаПлатежа", СтрокиРКОДок), , "РозничнаяВыручкаНаличныеСводноРасход");
		КонецЕсли;
		
	КонецЦикла;
КонецЕсли;</ПослеОбработкиПравила>
			</Правило>
			<Правило Отключить="false">
				<Код>ВозвратТоваровОтПокупателя</Код>
				<Наименование>Оказание услуг (работы, товары, проданные материалы, абонементы)  -&gt; Возврат товаров</Наименование>
				<Порядок>500</Порядок>
				<КодПравилаКонвертации>ВозвратТоваровОтПокупателя                        </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОказаниеУслуг</ОбъектВыборки>
				<ПередОбработкойПравила>Параметры.Доки = "";</ПередОбработкойПравила>
				<ПослеОбработкиПравила>Если Не ПустаяСтрока(Параметры.Доки) Тогда
	ТЗСписание = ЗначениеИзСтрокиВнутр (Параметры.Доки);
	ТЗСписание.Свернуть("Дата, Склад, Клиент, Номенклатура, Цена, Коэффициент, Организация", "Количество, Сумма");
	
	ТабШапки = ТЗСписание.Скопировать(,"Дата, Склад, Клиент, Организация");
	ТабШапки.Свернуть("Дата, Склад, Клиент, Организация","");
	
	Отбор = Новый Структура("Дата, Склад, Клиент, Организация");
	мсСтрокиТовары = Новый Массив;
	
	Для Каждого СтрШапка Из ТабШапки Цикл
		
		ЗаполнитьЗначенияСвойств(Отбор,СтрШапка);
		мсСтрокиПродажа = ТЗСписание.НайтиСтроки(Отбор); 
		мсСтрокиТовары.Очистить();	
		
		Для Каждого СтрокаПродажа Из мсСтрокиПродажа Цикл
			Если СтрокаПродажа.Номенклатура.ВидНоменклатуры = Перечисления.ВидыНоменклатуры.Материал Тогда
				мсСтрокиТовары.Добавить(СтрокаПродажа);	
			КонецЕсли;
		КонецЦикла;
		
		СтруктураДляВыгрузки = Новый Структура("Товары", мсСтрокиТовары); 
		ВыгрузитьПоПравилу(СтрШапка, , СтруктураДляВыгрузки, , "ВозвратТоваровОтПокупателяСводно"); 
		
	КонецЦикла;
Конецесли;</ПослеОбработкиПравила>
			</Правило>
			<Правило Отключить="false">
				<Код>РозничнаяВыручкаБезналичные</Код>
				<Наименование>Оказание услуг (розничная выручка - безналичные) -&gt; Оплата платежной картой</Наименование>
				<Порядок>550</Порядок>
				<КодПравилаКонвертации>РозничнаяВыручкаБезналичные                       </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОказаниеУслуг</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>ОплатаПлатежнойКартой</Код>
				<Наименование>ОплатаПлатежнойКартой -&gt; Оплата платежной картой</Наименование>
				<Порядок>600</Порядок>
				<КодПравилаКонвертации>ОплатаПлатежнойКартой                             </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ОплатаПлатежнойКартой</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>ВозвратПоПлатежнойКарте</Код>
				<Наименование>ВозвратПоПлатежнойКарте -&gt; Оплата платежной картой</Наименование>
				<Порядок>650</Порядок>
				<КодПравилаКонвертации>ВозвратПоПлатежнойКарте                           </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ВозвратПоПлатежнойКарте</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>ПриходныйКассовыйОрдер</Код>
				<Наименование>ПриходныйКассовыйОрдер</Наименование>
				<Порядок>700</Порядок>
				<КодПравилаКонвертации>ПриходныйКассовыйОрдер                            </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.ПриходныйКассовыйОрдер</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>РасходныйКассовыйОрдер</Код>
				<Наименование>РасходныйКассовыйОрдер</Наименование>
				<Порядок>750</Порядок>
				<КодПравилаКонвертации>РасходныйКассовыйОрдер                            </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.РасходныйКассовыйОрдер</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>НачислениеЗарплаты</Код>
				<Наименование>НачислениеЗарплаты</Наименование>
				<Порядок>800</Порядок>
				<КодПравилаКонвертации>ЗарплатаКВыплатеОрганизаций                       </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.НачислениеЗарплаты</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>АвансовыйОтчет</Код>
				<Наименование>АвансовыйОтчет</Наименование>
				<Порядок>850</Порядок>
				<КодПравилаКонвертации>АвансовыйОтчет                                    </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.АвансовыйОтчет</ОбъектВыборки>
			</Правило>
			<Правило Отключить="false">
				<Код>РеестрОказанныхУслугПоСоглашениям</Код>
				<Наименование>РеестрОказанныхУслугПоСоглашениям</Наименование>
				<Порядок>900</Порядок>
				<КодПравилаКонвертации>РеестрОказанныхУслуг                              </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>ДокументСсылка.РеестрОказанныхУслугПоСоглашениям</ОбъектВыборки>
			</Правило>
		</Группа>
		<Группа Отключить="false">
			<Код>Справочники</Код>
			<Наименование>Справочники</Наименование>
			<Порядок>100</Порядок>
			<Правило Отключить="true">
				<Код>Пользователи</Код>
				<Наименование>Пользователи</Наименование>
				<Порядок>50</Порядок>
				<КодПравилаКонвертации>Пользователи                                      </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Пользователи</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>Склады</Код>
				<Наименование>Склады</Наименование>
				<Порядок>100</Порядок>
				<КодПравилаКонвертации>Склады                                            </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Склады</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>Номенклатура</Код>
				<Наименование>Номенклатура</Наименование>
				<Порядок>150</Порядок>
				<КодПравилаКонвертации>Номенклатура                                      </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Номенклатура</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>Контрагенты</Код>
				<Наименование>Контрагенты</Наименование>
				<Порядок>200</Порядок>
				<КодПравилаКонвертации>Контрагенты                                       </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Контрагенты</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>СтатьиДвиженияДенежныхСредств</Код>
				<Наименование>СтатьиДвиженияДенежныхСредств</Наименование>
				<Порядок>500</Порядок>
				<КодПравилаКонвертации>СтатьиДвиженияДенежныхСредств                     </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.СтатьиДвиженияДенежныхСредств</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>Сотрудники</Код>
				<Наименование>Сотрудники</Наименование>
				<Порядок>550</Порядок>
				<КодПравилаКонвертации>ФизическиеЛица                                    </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Сотрудники</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>Валюты</Код>
				<Наименование>Валюты</Наименование>
				<Порядок>600</Порядок>
				<КодПравилаКонвертации>Валюты                                            </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Валюты</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>КлассификаторЕдиницИзмерения</Код>
				<Наименование>КлассификаторЕдиницИзмерения</Наименование>
				<Порядок>650</Порядок>
				<КодПравилаКонвертации>КлассификаторЕдиницИзмерения                      </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.КлассификаторЕдиницИзмерения</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>СоглашенияСтрахования</Код>
				<Наименование>СоглашенияСтрахования</Наименование>
				<Порядок>700</Порядок>
				<КодПравилаКонвертации>ДоговорыКонтрагентов                              </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.СоглашенияСтрахования</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>ЭквайринговыеТерминалы</Код>
				<Наименование>ЭквайринговыеТерминалы -&gt; Виды оплат организаций</Наименование>
				<Порядок>750</Порядок>
				<КодПравилаКонвертации>ЭквайринговыеТерминалыВидыОплатОрганизаций        </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.ЭквайринговыеТерминалы</ОбъектВыборки>
			</Правило>
			<Правило Отключить="true">
				<Код>Клиенты</Код>
				<Наименование>Клиенты</Наименование>
				<Порядок>800</Порядок>
				<КодПравилаКонвертации>КлиентыВКонтрагенты                               </КодПравилаКонвертации>
				<СпособОтбораДанных>СтандартнаяВыборка</СпособОтбораДанных>
				<ОбъектВыборки>СправочникСсылка.Клиенты</ОбъектВыборки>
			</Правило>
		</Группа>
	</ПравилаВыгрузкиДанных>
	<ПравилаОчисткиДанных/>
	<Алгоритмы>
		<Алгоритм Имя="АгентскиеУслуги_РТУ_ДополнитьТабЧасть" ИспользуетсяПриЗагрузке="true">
			<Текст>// Вынесено в алгоритм только ради читаемости основного обработчика ПКО

// Агентские услуги
СтрокаТаблицы = Новый Структура;
МетаданныеТЧ = Метаданные.Документы.РеализацияТоваровУслуг.ТабличныеЧасти.АгентскиеУслуги.Реквизиты;
Для Каждого Колонка Из МетаданныеТЧ Цикл
	СтрокаТаблицы.Вставить(Колонка.Имя);
КонецЦикла;

Для Каждого Строка из Объект.АгентскиеУслуги Цикл
	Строка.Содержание = РаботаСНоменклатуройКлиентСерверБП.СодержаниеУслуги(?(Строка.Номенклатура.НаименованиеПолное = "", Строка.Номенклатура.Наименование, Строка.Номенклатура.НаименованиеПолное), Строка.Номенклатура.ПериодичностьУслуги, Объект.Дата);
	
	//СтрокаТаблицы = Элементы.АгентскиеУслуги.ТекущиеДанные;
	ЗаполнитьЗначенияСвойств(СтрокаТаблицы, Строка);
	
	
	// Подготовим данные для передачи на сервер
	ДанныеОбъекта = Новый Структура("Организация, Дата, ДокументБезНДС");
	ЗаполнитьЗначенияСвойств(ДанныеОбъекта, Объект);
	
	ДанныеСтроки = Новый Структура("Контрагент, ДоговорКонтрагента");
	ЗаполнитьЗначенияСвойств(ДанныеСтроки, СтрокаТаблицы);
	
	ПричиныИзменения = Новый Массив;
	ПричиныИзменения.Добавить("АгентскиеУслуги.Контрагент");
	ПричиныИзменения.Добавить("АгентскиеУслуги.ДоговорКонтрагента"); // Договор может измениться в ходе серверного вызова
	
	ПараметрыЗаполненияСчетовУчета = РеализацияТоваровУслугФормыКлиентСервер.НачатьЗаполнениеСчетовУчета(
	ПричиныИзменения,
	Объект,
	СтрокаТаблицы,
	ДанныеОбъекта,
	ДанныеСтроки);
	
	// Заполним
	//Изменения = АгентскиеУслугиКонтрагентПриИзмененииНаСервере(ДанныеОбъекта, ДанныеСтроки, ПараметрыЗаполненияСчетовУчета.КЗаполнению);
	//ЗаполнитьЗначенияСвойств(СтрокаТаблицы, Изменения);
	
	//+
	СчетаУчетаКЗаполнению = ПараметрыЗаполненияСчетовУчета.КЗаполнению;
	
	Изменения = Новый Структура;
	
	ВидыДоговоров = Новый Массив;
	ВидыДоговоров.Добавить(Перечисления.ВидыДоговоровКонтрагентов.СКомитентом);
	
	ДоговорКонтрагента = ДанныеСтроки.ДоговорКонтрагента;
	Если РаботаСДоговорамиКонтрагентовБП.УстановитьДоговорКонтрагента(
		ДоговорКонтрагента, 
		ДанныеСтроки.Контрагент, 
		ДанныеОбъекта.Организация, 
		ВидыДоговоров) Тогда
		
		Изменения.Вставить("ДоговорКонтрагента", ДоговорКонтрагента);
		
	Иначе
		
		СчетаУчетаКЗаполнению.Удалить("ДоговорКонтрагента");
		
	КонецЕсли;
	
	//ИзмененияСчетовУчета = СчетаУчетаВДокументах.ЗаполнитьРеквизитыПриИзменении(
	//	Документы.РеализацияТоваровУслуг,
	//	СчетаУчетаКЗаполнению,
	//	ДанныеОбъекта,
	//	"АгентскиеУслуги",
	//	ДанныеСтроки);
	//	
	//ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(Изменения, ИзмененияСчетовУчета, Истина);
	
	//+
	ЗаполнитьЗначенияСвойств(Строка, Изменения);
	
КонецЦикла;
</Текст>
		</Алгоритм>
		<Алгоритм Имя="ДобавлениеДоговора" ИспользуетсяПриЗагрузке="true">
			<Текст>ОбДоговор = Справочники.ДоговорыКонтрагентов.СоздатьЭлемент();
ОбДоговор.Наименование = "Основной договор "+Строка(мВидДоговора);
ОбДоговор.ВидДоговора  = мВидДоговора;
ОбДоговор.Организация  = Объект.Организация;
ОбДоговор.Владелец     = Объект.Контрагент;
ОбДоговор.ВалютаВзаиморасчетов  = Константы.ВалютаРегламентированногоУчета.Получить();
//ОбДоговор.ВедениеВзаиморасчетов = Перечисления.ВедениеВзаиморасчетовПоДоговорам.ПоДоговоруВЦелом;
ОбДоговор.Записать();
мДоговор = ОбДоговор.Ссылка;</Текст>
		</Алгоритм>
		<Алгоритм Имя="ЗаполнитьПустуюОрганизацию" ИспользуетсяПриЗагрузке="true">
			<Текст>// какая нафиг дефолтная, всё по инн

//// Дефолтная организация, если в документе пустая после загрузки
//Если МетаданныеЗагруженногоОбъекта.Реквизиты.Найти("Организация") &lt;&gt; Неопределено
//	И Не ЗначениезЗаполнено(Объект.Организация)
//Тогда
//	ИмяНастройки = "битОрганизация";
//	Выполнить(Алгоритмы.ПолучитьНастройку);
//	Объект.Контрагент = ЗначениеНастройки;
//КонецЕсли;
</Текст>
		</Алгоритм>
		<Алгоритм Имя="НоменклатураАгентскихУслуг" ИспользуетсяПриЗагрузке="false">
			<Текст>НоменклатураАгентскихУслуг = Новый Массив;

Попытка
	Запрос = Новый Запрос;
	Запрос.Текст = 	"Выбрать Ссылка Из Справочник.Номенклатура
					|ГДЕ КонтрагентПринципал &lt;&gt; ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка)";
	НоменклатураАгентскихУслуг = Запрос.Выполнить().Выгрузить().ВыгрузитьКолонку("Ссылка");
Исключение КонецПопытки;</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПоискДоговора" ИспользуетсяПриЗагрузке="true">
			<Текст>мДоговор = Неопределено;
ВыбДоговоры = Справочники.ДоговорыКонтрагентов.Выбрать(,Объект.Контрагент);
Пока ВыбДоговоры.Следующий() Цикл
	
	Если ВыбДоговоры.Организация = Объект.Организация и 
		 ВыбДоговоры.ВидДоговора = мВидДоговора
	Тогда
		мДоговор = ВыбДоговоры.Ссылка;
		Прервать;
	КонецЕсли;
	
КонецЦикла;</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПолучитьНастройку" ИспользуетсяПриЗагрузке="true">
			<Текст>бит_Настройки = ХранилищеСистемныхНастроек.Загрузить("УниверсальныйОбменданнымиXML", "Параметры_БИТ");
Если ТипЗнч(бит_Настройки) = Тип("Структура")
	И бит_Настройки.Свойство(ИмяНастройки)
Тогда
	ЗначениеНастройки = бит_Настройки[ИмяНастройки];
Иначе
	ЗначениеНастройки = Неопределено;
КонецЕсли;</Текст>
		</Алгоритм>
		<Алгоритм Имя="ПолучитьСтавкуНДС" ИспользуетсяПриЗагрузке="true">
			<Текст>Если ПредставлениеНастройки = "18%" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.НДС18;
ИначеЕсли ПредставлениеНастройки = "18/118" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.НДС18_118;
ИначеЕсли ПредставлениеНастройки = "10%" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.НДС10;
ИначеЕсли ПредставлениеНастройки = "10/110" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.НДС10_110;
ИначеЕсли ПредставлениеНастройки = "0%" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.НДС0;
ИначеЕсли ПредставлениеНастройки = "Без НДС" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.БезНДС;
ИначеЕсли ПредставлениеНастройки = "20%" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.НДС20;
ИначеЕсли ПредставлениеНастройки = "20/120" Тогда 
	ЗначениеНастройки = Перечисления.СтавкиНДС.НДС20_120;
КонецЕсли;</Текст>
		</Алгоритм>
		<Алгоритм Имя="РасшифроватьНастройку" ИспользуетсяПриЗагрузке="true">
			<Текст>Если ЗначениеЗаполнено(ЗначениеНастройки) Тогда 
	ПредставлениеНастройки = ЗначениеНастройки.НастраиваемыйОбъект;
	Если ТипЗнч(ПредставлениеНастройки) &lt;&gt; Тип("Строка") Тогда
		ЗначениеНастройки = ПредставлениеНастройки;
	ИначеЕсли Значениенастройки.ТипНастройки = "" Тогда 
		ЗначениеНастройки = ПланыСчетов.Хозрасчетный.НайтиПоКоду(ПредставлениеНастройки);
	ИначеЕсли Значениенастройки.ТипНастройки = "Булево" Тогда 
		ЗначениеНастройки = ?(ПредставлениеНастройки = "Да", Истина, Ложь);
	ИначеЕсли Значениенастройки.ТипНастройки = "СтавкиНДС" Тогда 
		Выполнить(Алгоритмы.ПолучитьСтавкуНДС);
	КонецЕсли;
КонецЕсли;</Текст>
		</Алгоритм>
		<Алгоритм Имя="СверткаТаблицыПоКоличествуИСумме" ИспользуетсяПриЗагрузке="true">
			<Текст>ИмяТЧ = ИмяТЧ; //
МетаданныеТЧ = Объект.Метаданные().ТабличныеЧасти[ИмяТЧ];
СтрГруппировки = "";
СтрПоказатели = "Количество";
Если МетаданныеТЧ.Реквизиты.Найти("Сумма")&lt;&gt;Неопределено Тогда
	СтрПоказатели = СтрПоказатели + ", Сумма";
КонецЕсли;

Для Каждого Колонка Из МетаданныеТЧ.Реквизиты Цикл
	
	Если Колонка.Имя&lt;&gt;"Количество" и 
		 Колонка.Имя&lt;&gt;"Сумма" 
	Тогда
		СтрГруппировки = СтрГруппировки + ?(ПустаяСтрока(СтрГруппировки),"",",")+ Колонка.Имя;
	Конецесли;
	
КонецЦикла;

Объект[ИмяТЧ].Свернуть(СтрГруппировки,СтрПоказатели);</Текст>
		</Алгоритм>
		<Алгоритм Имя="ФормированиеКомментарияСводногоДокумента" ИспользуетсяПриЗагрузке="false">
			<Текст>стрФилиалыВыгрузки = "";
Попытка
	ФилиалыВыгрузки = ЭтотОбъект.бит_ФилиалыВыгрузки;
	Если ФилиалыВыгрузки.Количество() &lt;&gt; 0 Тогда
		стрФилиалыВыгрузки = ?(ФилиалыВыгрузки.Количество() = 1, " Филиал:", " Филиалы:");
		стрФилиалыВыгрузкиНачало = стрФилиалыВыгрузки;
		Для Каждого Филиал Из ФилиалыВыгрузки Цикл
			стрФилиалыВыгрузки = стрФилиалыВыгрузки + ?(стрФилиалыВыгрузки &lt;&gt; стрФилиалыВыгрузкиНачало, ", ", " ") + Строка(Филиал.Значение);	
		КонецЦикла;
	КонецЕсли;
Исключение
КонецПопытки;
Значение = "Загружен из " + Метаданные.Синоним + стрВидДокумента + ?(Не ПустаяСтрока(стрФилиалыВыгрузки), стрФилиалыВыгрузки + ".", "");</Текст>
		</Алгоритм>
	</Алгоритмы>
	<Запросы/>
</ПравилаОбмена>