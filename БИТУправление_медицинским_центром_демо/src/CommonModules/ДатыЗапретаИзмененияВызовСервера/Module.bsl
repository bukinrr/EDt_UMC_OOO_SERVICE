#Область ПрограммныйИнтерфейс

#Область ОбщегоНазначения

// Функция НайденЗапретИзмененияДанных выполняет
//  поиск дат запрета по проверяемым данным
//  для авторизованного пользователя и/или узла плана обмена.
//
// Параметры:
//  ДанныеДляПроверки	 - ТаблицаЗначений	 - таблица, возвращаемая функцией ДатыЗапретаИзмененияПовтИсп.ШаблонДанныхДляПроверки()
//  СообщитьОЗапрете	 - Булево			 - выводит сообщение о найденных запретах при проверке данных.
//  ИдентификаторДанных	 - Строка			 - Ссылка на объект данных для получения представления,
//  					используемого в сообщении о запрете.
//  СтандартнаяОбработка - Булево			 - , если Ложь, проверка запрета изменения (для пользователей)
//  			будет пропущена.
//  УзелПланаОбмена		 - ПланОбменаСсылка	 - если задать узел будет выполнена проверка запрета загрузки.
//  НайденныеЗапреты	 - Структура		 - Если найден запрет изменения данных, значит есть
//  		свойство НайденЗапретИзмененияДанных, если найден запрет
//  		загрузки данных, значит есть свойство НайденЗапретЗагрузкиДанных.
// 
// Возвращаемое значение:
//  Булево.
//
Функция НайденЗапретИзмененияДанных(Знач ДанныеДляПроверки, Знач СообщитьОЗапрете, Знач ИдентификаторДанных = Неопределено, Знач СтандартнаяОбработка = Истина, Знач УзелПланаОбмена = Неопределено, НайденныеЗапреты = Неопределено) Экспорт
	
	НайденныеЗапреты = Новый Структура;
	
	Возврат НайденныеЗапреты.Количество() > 0;
	
КонецФункции

// Процедура ПересчитатьТекущиеЗначенияОтносительныхДатЗапрета выполняет
//  пересчет и обновление текущий значений относительных дат
//  запрета по состоянию на текущую дату.
//
// Параметры:
//  ЗаписатьОписаниеРезультатаВЖурналРегистрации - Булево	 - записать ли в журнал регистрации событие.
//  ОписаниеРезультата							 - Строка	 - результат выполнения.
//
Процедура ПересчитатьТекущиеЗначенияОтносительныхДатЗапрета(ЗаписатьОписаниеРезультатаВЖурналРегистрации = Истина, ОписаниеРезультата = "") Экспорт
	
	Возврат;
	
КонецПроцедуры
#КонецОбласти
#Область ОбработчикРегламентногоЗадания

// Обработчик регламентного задания ПересчетТекущихЗначенийОтносительныхДатЗапретаИзменения.
Процедура ПересчетТекущихЗначенийОтносительныхДатЗапретаИзменения() Экспорт
	
	ПересчитатьТекущиеЗначенияОтносительныхДатЗапрета();
	
КонецПроцедуры
#КонецОбласти
#Область Вспомогательные

// Функция проверяет наличие установленных запретов
// изменения данных.
//
// Возвращаемое значение:
//  Неопределено.
//
Функция ЗапретИзмененияДанныхНеИспользуется() Экспорт
	
	УстановитьПривилегированныйРежим(Истина);
	
	Если ОбновлениеИнформационнойБазы.НеобходимоОбновлениеИнформационнойБазы() Тогда
		Возврат Истина;
	КонецЕсли;
	
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	ИСТИНА КАК ЗначениеИстина
	|ИЗ
	|	РегистрСведений.ДатыЗапретаИзменения КАК ДатыЗапретаИзменения";
	
	Возврат Запрос.Выполнить().Пустой();
	
КонецФункции

#КонецОбласти

#КонецОбласти