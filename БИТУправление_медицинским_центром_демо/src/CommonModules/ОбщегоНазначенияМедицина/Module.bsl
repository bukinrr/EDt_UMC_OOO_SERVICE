#Область ПрограммныйИнтерфейс

// Осуществляет проверку заполненности проверяемых реквизитов.
//
// Параметры:
//  Документ			 - ДокументСсылка	 - Документ, на основании которого осуществляется ввод.
//  ЕстьОшибкиПроведен	 - Булево			 - Если Истина - документ, на основании которого осуществляется ввод, не проведен.
//  Статус				 - Неопределено		 - Статус документ, на основании которого осуществляется ввод.
//  ЕстьОшибкиСтатус	 - Булево			 - Если Истина - документ, на основании которого осуществляется ввод, имеет некорректный
//  ДопустимыеСтатусы	 - Массив			 - статус.
//
Процедура ПроверитьВозможностьВводаНаОсновании(Документ,
                                               ЕстьОшибкиПроведен = Ложь,
                                               Статус = Неопределено,
                                               ЕстьОшибкиСтатус = Ложь,
                                               ДопустимыеСтатусы = Неопределено) Экспорт
	
	Если ЕстьОшибкиПроведен Тогда
		
		ТекстОшибки = НСтр("ru='Документ %Документ% не проведен. Ввод на основании непроведенного документа невозможен.'");
		ТекстОшибки = СтрЗаменить(ТекстОшибки, "%Документ%", Документ);
		
		ВызватьИсключение ТекстОшибки;
		
	ИначеЕсли ЕстьОшибкиСтатус Тогда
		
		Если ДопустимыеСтатусы = Неопределено Тогда
			ТекстОшибки = НСтр("ru='Документ %Документ% находится в статусе ""%Статус%"". Ввод на основании невозможен.'");
		ИначеЕсли ТипЗнч(ДопустимыеСтатусы) = Тип("Массив") Тогда
			
			СтрокаДопустимыхСтатусов = "";
			
			Для Каждого ДопустимыйСтатус Из ДопустимыеСтатусы Цикл
				СтрокаДопустимыхСтатусов = СтрокаДопустимыхСтатусов + """"+ ДопустимыйСтатус + """, ";
			КонецЦикла;
			
			СтрокаДопустимыхСтатусов = Лев(СтрокаДопустимыхСтатусов, СтрДлина(СтрокаДопустимыхСтатусов) - 2);
			
			Если ДопустимыеСтатусы.Количество() = 0 Тогда
				ТекстОшибки = НСтр("ru='Документ %Документ% находится в статусе ""%Статус%"". Ввод на основании невозможен.'");
			ИначеЕсли ДопустимыеСтатусы.Количество() = 1 Тогда
				ТекстОшибки = НСтр("ru='Документ %Документ% находится в статусе ""%Статус%"". Ввод на основании возможен только в статусе %СтрокаДопустимыхСтатусов%.'");
				ТекстОшибки = СтрЗаменить(ТекстОшибки, "%СтрокаДопустимыхСтатусов%", СтрокаДопустимыхСтатусов);
			Иначе
				ТекстОшибки = НСтр("ru='Документ %Документ% находится в статусе ""%Статус%"". Ввод на основании возможен только в статусах %СтрокаДопустимыхСтатусов%.'");
				ТекстОшибки = СтрЗаменить(ТекстОшибки, "%СтрокаДопустимыхСтатусов%", СтрокаДопустимыхСтатусов);
			КонецЕсли;
		Иначе
			ТекстОшибки = НСтр("ru='Документ %Документ% находится в статусе ""%Статус%"". Ввод на основании возможен только в статусе ""%СтрокаДопустимыхСтатусов%"".'");
			ТекстОшибки = СтрЗаменить(ТекстОшибки, "%СтрокаДопустимыхСтатусов%", ДопустимыеСтатусы);
		КонецЕсли;
		
		ТекстОшибки = СтрЗаменить(ТекстОшибки, "%Документ%", Документ);
		ТекстОшибки = СтрЗаменить(ТекстОшибки, "%Статус%", Статус);
		
		ВызватьИсключение ТекстОшибки;
		
	КонецЕсли;
	
КонецПроцедуры
#КонецОбласти